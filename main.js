/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CineVaultPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/constants.ts
var VIEW_TYPE = "CineVaultView";
var OMDB_TYPES = ["movie", "series", "episode"];

// src/views/pluginView.ts
var import_obsidian5 = require("obsidian");

// src/ui/onboarding.ts
function renderOnboarding(container, onCreate, onLink) {
  const onboarding = container.createDiv({
    cls: "cinevault-onboarding"
  });
  const actions = onboarding.createDiv({ cls: "cinevault-onboarding-actions" });
  const createButton = actions.createEl("button", { text: "Create new library" });
  createButton.addEventListener("click", onCreate);
  if (onLink) {
    actions.createEl("p", { text: "or" });
    const linkButton = actions.createEl("button", { text: "Link existing library" });
    linkButton.addEventListener("click", onLink);
  }
}

// src/ui/modals/actionModal.ts
var import_obsidian = require("obsidian");
var CineVaultMovieActionModal = class extends import_obsidian.Modal {
  constructor(app, movie, onSave) {
    super(app);
    this.movie = movie;
    this.onSave = onSave;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.movie.title });
    contentEl.createEl("p", { text: `${this.movie.year} \u2022 ${this.movie.type}` });
    if (this.movie.poster) {
      contentEl.createEl("img", { cls: "cinevault-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    contentEl.createEl("p", { text: this.movie.plot });
    const actions = contentEl.createDiv({ cls: "cinevault-modal-detail-actions" });
    const watchedButton = actions.createEl("button", { text: "Mark as watched" });
    const toWatchButton = actions.createEl("button", { text: "To watch" });
    watchedButton.addEventListener("click", () => {
      this.onSave(true);
      this.close();
    });
    toWatchButton.addEventListener("click", () => {
      this.onSave(false);
      this.close();
    });
  }
};

// src/ui/modals/detailModal.ts
var import_obsidian2 = require("obsidian");

// src/ui/starRating.ts
function createStarRating(container, rating, readOnly, onChange) {
  const stars = container.createDiv({ cls: "cinevault-stars" });
  const starElements = [];
  let currentRating = rating;
  for (let i = 1; i <= 5; i += 1) {
    const star = stars.createEl("span", { text: "\u2605", cls: "cinevault-star" });
    if (i <= rating)
      star.classList.add("active");
    starElements.push(star);
    if (!readOnly) {
      star.addEventListener("click", () => {
        if (currentRating === i) {
          currentRating = 0;
          starElements.forEach((element) => {
            element.classList.remove("active");
          });
        } else {
          currentRating = i;
          starElements.forEach((element, index) => {
            element.classList.toggle("active", index < i);
          });
        }
        onChange == null ? void 0 : onChange(currentRating);
      });
    } else {
      star.classList.add("readonly");
    }
  }
  return stars;
}

// src/utils/globalMethods.ts
function nullSafe(func, fallbackValue = null) {
  try {
    const value = func();
    return value === null || value === void 0 ? fallbackValue : value;
  } catch (e) {
    console.error("Error: ", e);
    return fallbackValue;
  }
}
function formatRating(rating) {
  let value = rating;
  const isPerTen = rating.includes("/10");
  const isPerCent = rating.includes("/100");
  if (isPerTen && !isPerCent) {
    const normalized = value.replace(",", ".");
    const num = parseFloat(normalized);
    if (!isNaN(num) && isFinite(num)) {
      const multiplied = num * 10;
      value = multiplied % 1 === 0 ? String(Math.trunc(multiplied)) : String(multiplied);
    }
  } else if (rating.includes("/") && isPerCent) {
    value = rating.split("/")[0].trim();
  } else if (rating.includes("%")) {
    value = rating.replace("%", "").trim();
  }
  return value;
}
function averageRating(ratings) {
  const normalizedRatings = ratings.map(formatRating).map((r) => parseFloat(r)).filter((r) => !isNaN(r) && isFinite(r));
  if (normalizedRatings.length === 0)
    return "N/A";
  const sum = normalizedRatings.reduce((acc, val) => acc + val, 0);
  const average = sum / normalizedRatings.length;
  return average % 1 === 0 ? String(Math.trunc(average)) : String(average.toFixed(1));
}
function renderExternalRatingBar(parent, ratings, options) {
  var _a, _b, _c, _d, _e, _f, _g, _h;
  if (!ratings || ratings.length === 0)
    return null;
  const cls = {
    barContainer: (_b = (_a = options == null ? void 0 : options.classes) == null ? void 0 : _a.barContainer) != null ? _b : "cinevault-modal-detail-ratings-bar-container",
    bar: (_d = (_c = options == null ? void 0 : options.classes) == null ? void 0 : _c.bar) != null ? _d : "cinevault-modal-detail-ratings-bar",
    fill: (_f = (_e = options == null ? void 0 : options.classes) == null ? void 0 : _e.fill) != null ? _f : "cinevault-modal-detail-ratings-fill",
    average: (_h = (_g = options == null ? void 0 : options.classes) == null ? void 0 : _g.average) != null ? _h : "cinevault-modal-detail-ratings-average"
  };
  const ratingBarContainer = parent.createDiv({ cls: cls.barContainer });
  const ratingBar = ratingBarContainer.createDiv({ cls: cls.bar });
  const ratingFill = ratingBar.createDiv({ cls: cls.fill });
  const values = ratings.map((r) => formatRating(r.Value));
  const average = averageRating(values);
  const percentage = parseFloat(average);
  ratingFill.style.width = `${isNaN(percentage) ? 0 : percentage}%`;
  ratingBarContainer.createEl("span", {
    text: `${average}%`,
    cls: cls.average
  });
  return {
    container: ratingBarContainer,
    average,
    percentage: isNaN(percentage) ? 0 : percentage
  };
}

// src/ui/modals/detailModal.ts
var CineVaultMovieDetailModal = class extends import_obsidian2.Modal {
  constructor(app, movie, onRate, onRemove, onToggleWatched) {
    super(app);
    this.movie = movie;
    this.onRate = onRate;
    this.onRemove = onRemove;
    this.onToggleWatched = onToggleWatched;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const modalContainer = contentEl.createDiv({
      cls: "cinevault-modal-detail-container"
    });
    const modalHeader = modalContainer.createDiv({
      cls: "cinevault-modal-detail-header"
    });
    const modalTitleContainer = modalHeader.createDiv({
      cls: "cinevault-modal-detail-title-container"
    });
    modalTitleContainer.createEl("h1", {
      text: this.movie.title,
      cls: "cinevault-modal-detail-title"
    });
    const type = nullSafe(() => this.movie.type[0].toUpperCase() + this.movie.type.slice(1), null);
    const year = nullSafe(() => this.movie.year, null);
    modalTitleContainer.createEl("p", {
      text: `${year} - ${type}`
    });
    modalTitleContainer.createEl("p", {
      text: "Directed by " + nullSafe(() => this.movie.director, "N/A")
    });
    modalTitleContainer.createEl("p", {
      text: "Duration " + nullSafe(() => this.movie.runtime, "N/A")
    });
    if (this.movie.poster) {
      modalHeader.createEl("img", { cls: "cinevault-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    if (this.movie.plot) {
      const plotContainer = modalContainer.createEl("div", { cls: "cinevault-modal-detail-plot-container" });
      const plotEl = plotContainer.createEl("p", {
        text: this.movie.plot,
        cls: "cinevault-modal-detail-plot"
      });
      const showMoreButton = plotContainer.createEl("button", {
        text: "Show more",
        cls: "cinevault-modal-detail-show-more cinevault-modal-detail-show-more-hidden"
      });
      showMoreButton.addEventListener("click", () => {
        const isExpanded = plotEl.classList.toggle("expanded-plot");
        showMoreButton.setText(isExpanded ? "Show less" : "Show more");
      });
      requestAnimationFrame(() => {
        if (plotEl.scrollHeight > plotEl.clientHeight + 1) {
          showMoreButton.removeClass("cinevault-modal-detail-show-more-hidden");
        }
      });
    }
    function rederDetailSection(type2, value) {
      const detailElement = modalContainer.createEl("div", { cls: "cinevault-modal-detail-detail-container" });
      detailElement.createEl("p", {
        text: `${type2}:`,
        cls: "cinevault-modal-detail-detail-label"
      });
      detailElement.createEl("p", {
        text: value,
        cls: "cinevault-modal-detail-detail-value"
      });
    }
    modalContainer.createEl("hr");
    if (this.movie.genre) {
      rederDetailSection("Genre", this.movie.genre);
    }
    if (this.movie.actors) {
      rederDetailSection("Actors", this.movie.actors);
    }
    modalContainer.createEl("hr");
    const ratingWrapper = modalContainer.createDiv({ cls: "cinevault-modal-detail-rating-wrapper" });
    const ratingContainer = ratingWrapper.createDiv({
      cls: "cinevault-modal-detail-rating-container"
    });
    ratingContainer.createEl("div", { text: "Rating", cls: "cinevault-modal-detail-rating-label" });
    createStarRating(ratingContainer, this.movie.starRating, false, (rating) => {
      this.onRate(rating);
    });
    if (this.movie.ratings) {
      const externalRatingsContainer = ratingWrapper.createDiv({ cls: "cinevault-modal-detail-rating-container" });
      externalRatingsContainer.createEl("div", {
        text: "External rating",
        cls: "cinevault-modal-detail-rating-label"
      });
      renderExternalRatingBar(externalRatingsContainer, this.movie.ratings);
      modalContainer.createEl("p", {
        text: "The external rating is an average based on votes from Internet Movie Database, Rotten Tomatoes and Metacritic",
        cls: "cinevault-modal-detail-rating-disclaimer"
      });
    }
    const actions = modalContainer.createDiv({ cls: "cinevault-modal-detail-actions" });
    const toggleWatchedLabel = this.movie.watched ? "Mark as to watch" : "Mark as watched";
    const toggleWatchedButton = actions.createEl("button", { text: toggleWatchedLabel });
    const removeButton = actions.createEl("button", { text: "Remove", cls: "cinevault-danger" });
    toggleWatchedButton.addEventListener("click", () => {
      this.onToggleWatched();
      this.close();
    });
    removeButton.addEventListener("click", () => {
      this.onRemove();
      this.close();
    });
  }
};

// src/ui/JsonFileSuggestModal.ts
var import_obsidian3 = require("obsidian");
var JsonFileSuggestModal = class extends import_obsidian3.SuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
    this.jsonFiles = this.app.vault.getFiles().filter((f) => f.extension === "json");
    this.setPlaceholder("Select a JSON file from your vault...");
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    return this.jsonFiles.filter(
      (file) => file.path.toLowerCase().includes(lowerQuery)
    );
  }
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.path });
  }
  onChooseSuggestion(file, evt) {
    this.onSelect(file);
  }
};

// src/services/libraryStorage.ts
var FOLDER = "BoxOffice";
var DEFAULT_NAME = "libraryStorage.json";
function getDefaultPath(folder) {
  const folderPath = folder != null ? folder : FOLDER;
  return `${folderPath}/${DEFAULT_NAME}`;
}
function getFolder(folder) {
  return folder != null ? folder : FOLDER;
}
function createEmptyMovie() {
  return {
    id: crypto.randomUUID(),
    imdbId: "",
    title: "",
    year: "",
    rated: "",
    released: "",
    runtime: "",
    genre: "",
    director: "",
    writer: "",
    actors: "",
    plot: "",
    language: "",
    country: "",
    awards: "",
    poster: "",
    posterLocal: "",
    ratings: [],
    metascore: "",
    imdbRating: "",
    imdbVotes: "",
    type: "",
    dvd: "",
    boxOffice: "",
    production: "",
    website: "",
    totalSeasons: "",
    tomatoURL: "",
    tomatoMeter: "",
    tomatoImage: "",
    tomatoRating: "",
    tomatoReviews: "",
    tomatoFresh: "",
    tomatoRotten: "",
    tomatoConsensus: "",
    tomatoUserMeter: "",
    tomatoUserRating: "",
    tomatoUserReviews: "",
    starRating: 0,
    watched: false,
    notes: ""
  };
}
function createDefaultData() {
  const now = new Date().toISOString();
  return {
    schemaVersion: 1,
    createdAt: now,
    updatedAt: now,
    libraryName: "CineVault",
    owner: "",
    source: "CineVault",
    movies: []
  };
}
function normalizeData(data) {
  return {
    ...data,
    movies: data.movies.map((movie) => ({
      ...createEmptyMovie(),
      ...movie,
      year: movie.year ? String(movie.year) : "",
      starRating: typeof movie.starRating === "number" ? movie.starRating : 0
    }))
  };
}
async function ensureFolder(app, folder) {
  const folderPath = getFolder(folder);
  if (!app.vault.getAbstractFileByPath(folderPath)) {
    await app.vault.createFolder(folderPath);
  }
}
async function createJsonFile(app, folder) {
  const folderPath = getFolder(folder);
  await ensureFolder(app, folder);
  const existing = app.vault.getAbstractFileByPath(getDefaultPath(folder));
  const filename = existing ? `boxoffice-${Date.now()}.json` : DEFAULT_NAME;
  const path = `${folderPath}/${filename}`;
  return app.vault.create(path, JSON.stringify(createDefaultData(), null, 2));
}
async function loadLocalFile(app, file) {
  const raw = await app.vault.read(file);
  const parsed = JSON.parse(raw);
  if (!parsed || !Array.isArray(parsed.movies)) {
    throw new Error("Formato JSON non valido");
  }
  return normalizeData(parsed);
}
async function saveLocalData(app, file, data) {
  await app.vault.modify(file, JSON.stringify(data, null, 2));
}

// src/services/omdbService.ts
var import_obsidian4 = require("obsidian");
async function searchOmdb(query, apiKey, type, year) {
  if (!apiKey) {
    return [];
  }
  try {
    let url = `https://www.omdbapi.com/?apikey=${apiKey}&s=${encodeURIComponent(query)}`;
    if (type) {
      url += `&type=${encodeURIComponent(type)}`;
    }
    if (year) {
      url += `&y=${encodeURIComponent(year)}`;
    }
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data == null ? void 0 : data.Search) {
      return data.Search.map((item) => ({
        imdbId: item.imdbID,
        title: item.Title,
        year: item.Year,
        type: item.Type,
        poster: item.Poster && item.Poster !== "N/A" ? item.Poster : "",
        plot: ""
      }));
    }
    return [];
  } catch (error) {
    console.error("Error searching OMDb:", error);
    return [];
  }
}
async function getOmdbDetails(imdbId, apiKey, depth = 0) {
  if (depth >= 3) {
    console.error(`Failed to fetch movie details after ${depth} attempts`);
    return null;
  }
  if (!apiKey) {
    return null;
  }
  try {
    const url = `https://www.omdbapi.com/?apikey=${apiKey}&i=${imdbId}&plot=full&tomatoes=true`;
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data.Response !== "True") {
      console.error("OMDb API returned error response", data);
      return null;
    }
    return data;
  } catch (error) {
    console.error("Error fetching movie details, retrying...", error);
    return getOmdbDetails(imdbId, apiKey, depth + 1);
  }
}

// src/views/pluginView.ts
var CineVaultView = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.file = null;
    this.data = null;
    this.activeTab = "toWatch";
    this.moviesContainer = null;
    this.viewMode = "grid";
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE;
  }
  getDisplayText() {
    return "BoxOffice";
  }
  // Provide a custom icon for the view's tab
  getIcon() {
    return "clapperboard";
  }
  async onOpen() {
    var _a;
    this.viewMode = (_a = this.plugin.viewMode) != null ? _a : "grid";
    await this.initializeData();
    await this.render();
  }
  async render() {
    const container = this.containerEl.children[1];
    container.empty();
    const header = container.createDiv({ cls: "cinevault-header" });
    header.createEl("h1", {
      text: "BoxOffice",
      cls: "cinevault-title"
    });
    header.createEl("p", {
      text: "This plugin allow you to manage your favorites movie and tv library into your vault.\nSearch OMDb, rate titles, and store your collection in a json file within your vault or in a separate vault.",
      cls: "cinevault-header-text"
    });
    if (!this.data) {
      renderOnboarding(container, async () => {
        this.file = await createJsonFile(this.plugin.app, this.plugin.libraryFolder);
        if (this.file) {
          await this.plugin.setLocalJsonPath(this.file.path);
        }
        await this.loadFile(this.file);
        await this.render();
      }, () => {
        new JsonFileSuggestModal(this.plugin.app, async (file) => {
          await this.loadFile(file);
          await this.render();
        }).open();
      });
      return;
    }
    const searchBox = container.createDiv({ cls: "cinevault-search" });
    const searchInputContainer = searchBox.createDiv({ cls: "cinevault-search-input-container" });
    const searchInput = searchInputContainer.createEl("input", {
      cls: "cinevault-search-input",
      attr: {
        placeholder: "Search"
      }
    });
    const filterSwitch = searchInputContainer.createEl("button", {
      cls: "cinevault-search-clear",
      attr: {
        "aria-label": "More filter",
        title: "More filter"
      }
    });
    (0, import_obsidian5.setIcon)(filterSwitch, "sliders-horizontal");
    const moreFilterContainer = searchBox.createDiv({ cls: "cinevault-more-filter" });
    moreFilterContainer.style.display = "none";
    filterSwitch.addEventListener("click", () => {
      if (moreFilterContainer.style.display === "none") {
        moreFilterContainer.style.display = "flex";
      } else {
        moreFilterContainer.style.display = "none";
      }
    });
    const yearInput = moreFilterContainer.createEl("input", {
      cls: "cinevault-search-input",
      attr: { placeholder: "Year" }
    });
    const typeSelect = moreFilterContainer.createEl("select", { cls: "cinevault-search-select" });
    typeSelect.createEl("option", {
      text: "All",
      attr: {
        value: "",
        placeholder: "Type"
      }
    });
    OMDB_TYPES.forEach((t) => {
      typeSelect.createEl("option", {
        text: t[0].toUpperCase() + t.slice(1),
        attr: { value: t }
      });
    });
    let resultsList = null;
    const content = container.createDiv({ cls: "cinevault-content" });
    this.moviesContainer = content;
    this.renderMovies(content);
    let searchTimeout = null;
    const runSearch = async () => {
      const query = searchInput.value.trim();
      if (!query)
        return;
      const type = typeSelect.value || void 0;
      const year = yearInput.value.trim() || void 0;
      const results = await searchOmdb(query, this.plugin.omdbApiKey, type, year);
      if (!results || results.length === 0) {
        if (!resultsList)
          resultsList = searchBox.createDiv({ cls: "cinevault-search-results" });
        resultsList.empty();
        resultsList.createEl("div", { text: "No results found.", cls: "cinevault-search-empty" });
        return;
      }
      if (!resultsList)
        resultsList = searchBox.createDiv({ cls: "cinevault-search-results" });
      await this.renderSearchResults(resultsList, results);
    };
    searchInput.addEventListener("input", () => {
      if (!searchInput.value.trim()) {
        if (resultsList) {
          resultsList.empty();
          resultsList.remove();
          resultsList = null;
        }
        if (searchTimeout) {
          window.clearTimeout(searchTimeout);
          searchTimeout = null;
        }
        return;
      }
      if (searchTimeout)
        window.clearTimeout(searchTimeout);
      searchTimeout = window.setTimeout(runSearch, 350);
    });
    yearInput.addEventListener("input", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
    typeSelect.addEventListener("change", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
  }
  renderMovies(container) {
    container.empty();
    if (!this.data) {
      container.createEl("p", { text: "No library loaded." });
      return;
    }
    const watched = this.data.movies.filter((movie) => movie.watched);
    const toWatch = this.data.movies.filter((movie) => !movie.watched);
    const tabsContainer = container.createDiv({ cls: "cinevault-tabs-container" });
    const tabHeader = tabsContainer.createDiv({ cls: "cinevault-tab-header" });
    const tabButtons = tabHeader.createDiv({ cls: "cinevault-tab-buttons" });
    const viewToggle = tabHeader.createDiv({ cls: "cinevault-view-toggle" });
    const toWatchButton = tabButtons.createEl("button", {
      cls: "cinevault-tab-button",
      text: `To Watch (${toWatch.length})`
    });
    const watchedButton = tabButtons.createEl("button", {
      cls: "cinevault-tab-button",
      text: `Watched (${watched.length})`
    });
    const gridButton = viewToggle.createEl("button", {
      cls: "cinevault-view-button",
      attr: { "aria-label": "Grid view", title: "Grid view" }
    });
    const listButton = viewToggle.createEl("button", {
      cls: "cinevault-view-button",
      attr: { "aria-label": "List view", title: "List view" }
    });
    (0, import_obsidian5.setIcon)(gridButton, "layout-grid");
    (0, import_obsidian5.setIcon)(listButton, "list");
    if (this.activeTab === "toWatch") {
      toWatchButton.classList.add("cinevault-tab-button-active");
    } else {
      watchedButton.classList.add("cinevault-tab-button-active");
    }
    if (this.viewMode === "grid") {
      gridButton.classList.add("cinevault-view-button-active");
    } else {
      listButton.classList.add("cinevault-view-button-active");
    }
    const tabContent = tabsContainer.createDiv({ cls: "cinevault-tab-content" });
    const activeMovies = this.activeTab === "toWatch" ? toWatch : watched;
    const activeTitle = this.activeTab === "toWatch" ? "To Watch" : "Watched";
    this.renderMovieSection(tabContent, activeTitle, activeMovies);
    toWatchButton.addEventListener("click", () => {
      if (this.activeTab === "toWatch")
        return;
      this.activeTab = "toWatch";
      this.renderMovies(container);
    });
    watchedButton.addEventListener("click", () => {
      if (this.activeTab === "watched")
        return;
      this.activeTab = "watched";
      this.renderMovies(container);
    });
    gridButton.addEventListener("click", async () => {
      if (this.viewMode === "grid")
        return;
      this.viewMode = "grid";
      await this.plugin.setViewMode("grid");
      this.renderMovies(container);
    });
    listButton.addEventListener("click", async () => {
      if (this.viewMode === "list")
        return;
      this.viewMode = "list";
      await this.plugin.setViewMode("list");
      this.renderMovies(container);
    });
  }
  renderMovieSection(container, title, movies) {
    const section = container.createDiv({ cls: "cinevault-section" });
    if (movies.length === 0) {
      section.createEl("p", { text: "No movies in this list." });
      return;
    }
    const list = section.createDiv({
      cls: this.viewMode === "grid" ? "cinevault-movie-grid" : "cinevault-movie-list"
    });
    if (this.viewMode === "grid") {
      this.renderMovieGrid(list, movies);
    } else {
      this.renderMovieList(list, movies);
    }
  }
  renderMovieGrid(container, movies) {
    movies.forEach((movie) => {
      const card = container.createDiv({ cls: "cinevault-movie-card" });
      card.createEl("img", { cls: "cinevault-movie-poster" }).setAttribute("src", movie.poster);
      card.createEl("div", { text: movie.title, cls: "cinevault-movie-title" });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year)
        detailsParts.push(year);
      if (type)
        detailsParts.push(type);
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        card.createEl("div", { text: detailsText, cls: "cinevault-movie-year" });
      }
      if (movie.watched) {
        createStarRating(card, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(card, movie.ratings);
        }
      }
      card.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  renderMovieList(container, movies) {
    movies.forEach((movie) => {
      const row = container.createDiv({
        cls: "cinevault-movie-row"
      });
      const poster = row.createEl("img", {
        cls: "cinevault-movie-thumbnail"
      });
      poster.setAttribute("src", movie.poster || "");
      const info = row.createDiv({
        cls: "cinevault-movie-info"
      });
      info.createEl("div", {
        text: movie.title,
        cls: "cinevault-movie-title"
      });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year) {
        detailsParts.push(year);
      }
      ;
      if (type) {
        detailsParts.push(type);
      }
      ;
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        info.createEl("div", {
          text: detailsText,
          cls: "cinevault-movie-year"
        });
      }
      if (movie.watched) {
        createStarRating(info, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(info, movie.ratings);
        }
      }
      row.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  openMovieDetails(movie) {
    new CineVaultMovieDetailModal(this.plugin.app, movie, async (rating) => {
      if (!this.data)
        return;
      movie.starRating = rating;
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      this.data.movies = this.data.movies.filter((item) => item.id !== movie.id);
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      movie.watched = !movie.watched;
      await this.saveData();
      this.refreshMovies();
    }).open();
  }
  refreshMovies() {
    if (!this.moviesContainer)
      return;
    this.renderMovies(this.moviesContainer);
  }
  getJsonFiles() {
    return this.plugin.app.vault.getFiles().filter((file) => file.extension === "json");
  }
  async initializeData() {
    const localPath = this.plugin.localJsonPath;
    if (localPath) {
      const localFile = this.plugin.app.vault.getAbstractFileByPath(localPath);
      if (localFile instanceof import_obsidian5.TFile) {
        await this.loadFile(localFile);
        return;
      }
    }
    this.file = null;
    this.data = null;
  }
  async loadFile(file) {
    try {
      const parsed = await loadLocalFile(this.plugin.app, file);
      this.file = file;
      this.data = parsed;
      await this.plugin.setLocalJsonPath(file.path);
    } catch (error) {
      this.data = null;
      this.file = null;
      new import_obsidian5.Notice("Unable to read the JSON file.");
    }
  }
  async saveData() {
    if (!this.data)
      return;
    this.data.updatedAt = new Date().toISOString();
    if (this.file) {
      await saveLocalData(this.plugin.app, this.file, this.data);
    }
  }
  async renderSearchResults(container, results) {
    container.empty();
    results.forEach((result) => {
      const item = container.createDiv({ cls: "cinevault-search-item" });
      if (result.poster) {
        item.createEl("img", { cls: "cinevault-search-poster" }).setAttribute("src", result.poster);
      }
      const info = item.createDiv({ cls: "cinevault-search-info" });
      info.createEl("div", { text: result.title, cls: "cinevault-search-title" });
      info.createEl("div", { text: result.year, cls: "cinevault-search-year" });
      item.addEventListener("click", () => {
        new CineVaultMovieActionModal(this.plugin.app, result, async (watched) => {
          if (!this.data)
            return;
          const existing = this.data.movies.find((movie) => movie.imdbId === result.imdbId);
          if (existing) {
            existing.watched = watched;
          } else {
            new import_obsidian5.Notice(`Loading details for ${result.title}...`);
            const details = await getOmdbDetails(result.imdbId, this.plugin.omdbApiKey);
            if (!details) {
              new import_obsidian5.Notice("Unable to load movie details.");
              return;
            }
            const newMovie = createEmptyMovie();
            newMovie.imdbId = details.imdbID || result.imdbId;
            newMovie.title = details.Title || result.title;
            newMovie.year = details.Year || result.year;
            newMovie.rated = details.Rated || "";
            newMovie.released = details.Released || "";
            newMovie.runtime = details.Runtime || "";
            newMovie.genre = details.Genre || "";
            newMovie.director = details.Director || "";
            newMovie.writer = details.Writer || "";
            newMovie.actors = details.Actors || "";
            newMovie.plot = details.Plot || result.plot;
            newMovie.language = details.Language || "";
            newMovie.country = details.Country || "";
            newMovie.awards = details.Awards || "";
            newMovie.poster = details.Poster && details.Poster !== "N/A" ? details.Poster : result.poster;
            newMovie.posterLocal = "";
            newMovie.ratings = details.Ratings || [];
            newMovie.metascore = details.Metascore || "";
            newMovie.imdbRating = details.imdbRating || "";
            newMovie.imdbVotes = details.imdbVotes || "";
            newMovie.type = details.Type || result.type;
            newMovie.dvd = details.DVD || "";
            newMovie.boxOffice = details.BoxOffice || "";
            newMovie.production = details.Production || "";
            newMovie.website = details.Website || "";
            newMovie.totalSeasons = details.totalSeasons || "";
            newMovie.watched = watched;
            this.data.movies.push(newMovie);
          }
          await this.saveData();
          this.render();
        }).open();
      });
    });
  }
};

// src/settings/settingsTab.ts
var import_obsidian6 = require("obsidian");
var CineVaultSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian6.Setting(containerEl).setName("Configuration").setHeading();
    new import_obsidian6.Setting(containerEl).setName("OMDb API key").setDesc("Enter your OMDb API key. You can get one for free at omdbapi.com").addText((text) => text.setPlaceholder("Enter your API key").setValue(this.plugin.omdbApiKey).onChange(async (value) => {
      await this.plugin.setOmdbApiKey(value);
    }));
    new import_obsidian6.Setting(containerEl).setName("Library folder").setDesc("The folder where the plugin will store library files").addText((text) => text.setPlaceholder("Folder name").setValue(this.plugin.libraryFolder).onChange(async (value) => {
      const folder = value.trim() || "BoxOffice";
      await this.plugin.setLibraryFolder(folder);
    }));
    new import_obsidian6.Setting(containerEl).setName("Linked local library").setDesc(
      this.plugin.localJsonPath ? `Local file: ${this.plugin.localJsonPath}` : "No local library linked"
    ).addDropdown((drop) => {
      var _a;
      const files = this.app.vault.getFiles().filter((f) => f.extension === "json");
      const options = { "": "-- None --" };
      files.forEach((f) => options[f.path] = f.path);
      drop.addOptions(options).setValue((_a = this.plugin.localJsonPath) != null ? _a : "").onChange(async (value) => {
        const path = value || null;
        await this.plugin.setLocalJsonPath(path);
        await this.refreshOpenViews();
        this.display();
      });
    }).addButton((button) => button.setButtonText("Unlink local").setDisabled(!this.plugin.localJsonPath).onClick(async () => {
      await this.plugin.setLocalJsonPath(null);
      await this.refreshOpenViews();
      this.display();
    }));
    new import_obsidian6.Setting(containerEl).setName("Create new library").setDesc("Create a new empty local library from scratch. This will unlink any external library.").addButton((button) => button.setButtonText("Create library").onClick(async () => {
      await this.createNewLibrary();
    }));
    new import_obsidian6.Setting(containerEl).setName("Export library").setDesc("Save a copy of your library JSON to a file.").addButton((button) => button.setButtonText("Export JSON").onClick(async () => {
      await this.exportLibraryJson();
    }));
    new import_obsidian6.Setting(containerEl).setName("Bugfix").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Report issues").setDesc("If you encounter any issues with the plugin, please report them. Your feedback is invaluable for improving BoxOffice!").addButton((button) => button.setButtonText("GitHub").onClick(() => {
      window.open("https://github.com/vscaperrotta/obsidian-cinevault/issues", "_blank");
    }));
    new import_obsidian6.Setting(containerEl).setName("Support").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Donate").setDesc(
      "If you like this plugin, consider donating to support continued development."
    ).addButton((bt) => {
      bt.buttonEl.outerHTML = "<a href='https://ko-fi.com/T6T01TX807' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi6.png?v=6' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a>";
    });
  }
  async exportLibraryJson() {
    try {
      const content = await this.getLibraryJsonContent();
      if (!content) {
        new import_obsidian6.Notice("No library file found to export.");
        return;
      }
      const timestamp = new Date().toISOString().replace(/[:.]/g, "-").slice(0, 19);
      const exportPath = `boxoffice-export-${timestamp}.json`;
      let finalPath = exportPath;
      let counter = 1;
      while (this.app.vault.getAbstractFileByPath(finalPath)) {
        finalPath = `boxoffice-export-${timestamp}-${counter}.json`;
        counter++;
      }
      await this.app.vault.create(finalPath, content);
      new import_obsidian6.Notice(`Library exported to ${finalPath}`);
    } catch (error) {
      console.error("[BoxOffice] Export library error", error);
      new import_obsidian6.Notice("Unable to export the library.");
    }
  }
  async createNewLibrary() {
    const confirmed = window.confirm(
      "Create a new empty BoxOffice library? This will unlink any external library and reset your local library data."
    );
    if (!confirmed)
      return;
    try {
      const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
      let createdFile;
      if (defaultFile instanceof import_obsidian6.TFile) {
        await saveLocalData(this.app, defaultFile, createDefaultData());
        createdFile = defaultFile;
      } else {
        createdFile = await createJsonFile(this.app, this.plugin.libraryFolder);
      }
      if (createdFile) {
        await this.plugin.setLocalJsonPath(createdFile.path);
      }
      await this.refreshOpenViews();
      this.display();
      new import_obsidian6.Notice("New library created.");
    } catch (error) {
      console.error("[BoxOffice] Create new library error", error);
      new import_obsidian6.Notice("Unable to create a new library.");
    }
  }
  async getLibraryJsonContent() {
    if (this.plugin.localJsonPath) {
      const localPath = this.plugin.localJsonPath;
      const file = this.app.vault.getAbstractFileByPath(localPath);
      if (file instanceof import_obsidian6.TFile) {
        return this.app.vault.read(file);
      }
    }
    const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
    if (defaultFile instanceof import_obsidian6.TFile) {
      return this.app.vault.read(defaultFile);
    }
    const folder = getFolder(this.plugin.libraryFolder);
    const fallback = this.app.vault.getFiles().find((file) => file.extension === "json" && file.path.startsWith(`${folder}/`));
    if (fallback) {
      return this.app.vault.read(fallback);
    }
    return null;
  }
  async refreshOpenViews() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    for (const leaf of leaves) {
      if (leaf.view instanceof CineVaultView) {
        await leaf.view.onOpen();
      }
    }
  }
};

// src/main.ts
var CineVaultPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.localJsonPath = null;
    this.omdbApiKey = "";
    this.viewMode = "grid";
    this.libraryFolder = "BoxOffice";
  }
  // Initialize the plugin and set up event listeners
  async onload() {
    await this.loadPluginData();
    this.addSettingTab(new CineVaultSettingTab(this.app, this));
    this.registerView(
      VIEW_TYPE,
      (leaf) => new CineVaultView(leaf, this)
    );
    this.addRibbonIcon("clapperboard", "BoxOffice", async () => {
      await this.openNewTab();
    });
  }
  // Unmount the status bar element when the plugin is disabled
  onunload() {
  }
  async loadPluginData() {
    var _a, _b, _c, _d;
    const data = await this.loadData();
    this.localJsonPath = (_a = data == null ? void 0 : data.localJsonPath) != null ? _a : null;
    this.omdbApiKey = (_b = data == null ? void 0 : data.omdbApiKey) != null ? _b : "";
    this.viewMode = (_c = data == null ? void 0 : data.viewMode) != null ? _c : "grid";
    this.libraryFolder = (_d = data == null ? void 0 : data.libraryFolder) != null ? _d : "BoxOffice";
  }
  // externalJsonPath removed; no-op placeholder removed
  async setOmdbApiKey(apiKey) {
    this.omdbApiKey = apiKey;
    await this.savePluginData();
  }
  async setViewMode(viewMode) {
    this.viewMode = viewMode;
    await this.savePluginData();
  }
  async savePluginData() {
    const data = {
      omdbApiKey: this.omdbApiKey,
      viewMode: this.viewMode,
      libraryFolder: this.libraryFolder
    };
    if (this.localJsonPath) {
      data.localJsonPath = this.localJsonPath;
    }
    await this.saveData(data);
  }
  async setLocalJsonPath(path) {
    this.localJsonPath = path;
    await this.savePluginData();
  }
  async setLibraryFolder(folder) {
    this.libraryFolder = folder;
    await this.savePluginData();
  }
  // Open a new tab with the "BoxOffice" view type
  async openNewTab() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: VIEW_TYPE,
      active: true
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbnN0YW50cy50cyIsICJzcmMvdmlld3MvcGx1Z2luVmlldy50cyIsICJzcmMvdWkvb25ib2FyZGluZy50cyIsICJzcmMvdWkvbW9kYWxzL2FjdGlvbk1vZGFsLnRzIiwgInNyYy91aS9tb2RhbHMvZGV0YWlsTW9kYWwudHMiLCAic3JjL3VpL3N0YXJSYXRpbmcudHMiLCAic3JjL3V0aWxzL2dsb2JhbE1ldGhvZHMudHMiLCAic3JjL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9zZXJ2aWNlcy9saWJyYXJ5U3RvcmFnZS50cyIsICJzcmMvc2VydmljZXMvb21kYlNlcnZpY2UudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZJRVdfVFlQRSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHBsdWdpblZpZXcgZnJvbSBcIi4vdmlld3MvcGx1Z2luVmlld1wiO1xuaW1wb3J0IENpbmVWYXVsdFNldHRpbmdUYWIgZnJvbSBcIi4vc2V0dGluZ3Mvc2V0dGluZ3NUYWJcIjtcblxudHlwZSBDaW5lVmF1bHRQbHVnaW5EYXRhID0ge1xuXHRsb2NhbEpzb25QYXRoPzogc3RyaW5nO1xuXHRvbWRiQXBpS2V5Pzogc3RyaW5nO1xuXHR2aWV3TW9kZT86IFwiZ3JpZFwiIHwgXCJsaXN0XCI7XG5cdGxpYnJhcnlGb2xkZXI/OiBzdHJpbmc7XG5cdG9wZW4/OiBib29sZWFuO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2luZVZhdWx0UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0bG9jYWxKc29uUGF0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdG9tZGJBcGlLZXk6IHN0cmluZyA9IFwiXCI7XG5cdHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiID0gXCJncmlkXCI7XG5cdGxpYnJhcnlGb2xkZXI6IHN0cmluZyA9IFwiQm94T2ZmaWNlXCI7XG5cblx0Ly8gSW5pdGlhbGl6ZSB0aGUgcGx1Z2luIGFuZCBzZXQgdXAgZXZlbnQgbGlzdGVuZXJzXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRQbHVnaW5EYXRhKCk7XG5cblx0XHQvLyBBZGQgc2V0dGluZ3MgdGFiXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBDaW5lVmF1bHRTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHQvLyBSZWdpc3RlciBuZXcgdmlld1xuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0VklFV19UWVBFLFxuXHRcdFx0KGxlYWYpID0+IG5ldyBwbHVnaW5WaWV3KGxlYWYsIHRoaXMpXG5cdFx0KTtcblxuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcImNsYXBwZXJib2FyZFwiLCBcIkJveE9mZmljZVwiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRhd2FpdCB0aGlzLm9wZW5OZXdUYWIoKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIFVubW91bnQgdGhlIHN0YXR1cyBiYXIgZWxlbWVudCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWRcblx0b251bmxvYWQoKSB7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRQbHVnaW5EYXRhKCkge1xuXHRcdGNvbnN0IGRhdGEgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyBDaW5lVmF1bHRQbHVnaW5EYXRhIHwgbnVsbDtcblx0XHR0aGlzLmxvY2FsSnNvblBhdGggPSBkYXRhPy5sb2NhbEpzb25QYXRoID8/IG51bGw7XG5cdFx0dGhpcy5vbWRiQXBpS2V5ID0gZGF0YT8ub21kYkFwaUtleSA/PyBcIlwiO1xuXHRcdHRoaXMudmlld01vZGUgPSBkYXRhPy52aWV3TW9kZSA/PyBcImdyaWRcIjtcblx0XHR0aGlzLmxpYnJhcnlGb2xkZXIgPSBkYXRhPy5saWJyYXJ5Rm9sZGVyID8/IFwiQm94T2ZmaWNlXCI7XG5cdH1cblxuXHQvLyBleHRlcm5hbEpzb25QYXRoIHJlbW92ZWQ7IG5vLW9wIHBsYWNlaG9sZGVyIHJlbW92ZWRcblxuXHRhc3luYyBzZXRPbWRiQXBpS2V5KGFwaUtleTogc3RyaW5nKSB7XG5cdFx0dGhpcy5vbWRiQXBpS2V5ID0gYXBpS2V5O1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdGFzeW5jIHNldFZpZXdNb2RlKHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiKSB7XG5cdFx0dGhpcy52aWV3TW9kZSA9IHZpZXdNb2RlO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgc2F2ZVBsdWdpbkRhdGEoKSB7XG5cdFx0Y29uc3QgZGF0YTogQ2luZVZhdWx0UGx1Z2luRGF0YSA9IHtcblx0XHRcdG9tZGJBcGlLZXk6IHRoaXMub21kYkFwaUtleSxcblx0XHRcdHZpZXdNb2RlOiB0aGlzLnZpZXdNb2RlLFxuXHRcdFx0bGlicmFyeUZvbGRlcjogdGhpcy5saWJyYXJ5Rm9sZGVyXG5cdFx0fTtcblx0XHRpZiAodGhpcy5sb2NhbEpzb25QYXRoKSB7XG5cdFx0XHRkYXRhLmxvY2FsSnNvblBhdGggPSB0aGlzLmxvY2FsSnNvblBhdGg7XG5cdFx0fVxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEoZGF0YSk7XG5cdH1cblxuXHRhc3luYyBzZXRMb2NhbEpzb25QYXRoKHBhdGg6IHN0cmluZyB8IG51bGwpIHtcblx0XHR0aGlzLmxvY2FsSnNvblBhdGggPSBwYXRoO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdGFzeW5jIHNldExpYnJhcnlGb2xkZXIoZm9sZGVyOiBzdHJpbmcpIHtcblx0XHR0aGlzLmxpYnJhcnlGb2xkZXIgPSBmb2xkZXI7XG5cdFx0YXdhaXQgdGhpcy5zYXZlUGx1Z2luRGF0YSgpO1xuXHR9XG5cblx0Ly8gT3BlbiBhIG5ldyB0YWIgd2l0aCB0aGUgXCJCb3hPZmZpY2VcIiB2aWV3IHR5cGVcblx0cHJpdmF0ZSBhc3luYyBvcGVuTmV3VGFiKCkge1xuXHRcdGNvbnN0IGV4aXN0aW5nTGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpO1xuXHRcdGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihleGlzdGluZ0xlYXZlc1swXSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuXHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcblx0XHRcdHR5cGU6IFZJRVdfVFlQRSxcblx0XHRcdGFjdGl2ZTogdHJ1ZVxuXHRcdH0pO1xuXHR9XG59IiwgImV4cG9ydCBjb25zdCBWSUVXX1RZUEUgPSBcIkNpbmVWYXVsdFZpZXdcIjtcblxuZXhwb3J0IGNvbnN0IE9NREJfVFlQRVMgPSBbXCJtb3ZpZVwiLCBcInNlcmllc1wiLCBcImVwaXNvZGVcIl0gYXMgY29uc3Q7IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBURmlsZSwgTm90aWNlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUsIE9NREJfVFlQRVMgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdERhdGEsIENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgcmVuZGVyT25ib2FyZGluZyB9IGZyb20gXCIuLi91aS9vbmJvYXJkaW5nXCI7XG5pbXBvcnQgeyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIH0gZnJvbSBcIi4uL3VpL21vZGFscy9hY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IHsgQ2luZVZhdWx0TW92aWVEZXRhaWxNb2RhbCB9IGZyb20gXCIuLi91aS9tb2RhbHMvZGV0YWlsTW9kYWxcIjtcbmltcG9ydCB7IEpzb25GaWxlU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIi4uL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQge1xuICBjcmVhdGVFbXB0eU1vdmllLFxuICBjcmVhdGVKc29uRmlsZSxcbiAgZ2V0RGVmYXVsdFBhdGgsXG4gIGdldEZvbGRlcixcbiAgbG9hZExvY2FsRmlsZSxcbiAgc2F2ZUxvY2FsRGF0YVxufSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcbmltcG9ydCB7IHNlYXJjaE9tZGIsIGdldE9tZGJEZXRhaWxzIH0gZnJvbSBcIi4uL3NlcnZpY2VzL29tZGJTZXJ2aWNlXCI7XG5pbXBvcnQgeyBjcmVhdGVTdGFyUmF0aW5nIH0gZnJvbSBcIi4uL3VpL3N0YXJSYXRpbmdcIjtcbmltcG9ydCB7IG51bGxTYWZlLCByZW5kZXJFeHRlcm5hbFJhdGluZ0JhciB9IGZyb20gXCJzcmMvdXRpbHMvZ2xvYmFsTWV0aG9kc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXG4gIHBsdWdpbjogQ2luZVZhdWx0UGx1Z2luO1xuICBmaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuICBkYXRhOiBDaW5lVmF1bHREYXRhIHwgbnVsbCA9IG51bGw7XG4gIGFjdGl2ZVRhYjogXCJ0b1dhdGNoXCIgfCBcIndhdGNoZWRcIiA9IFwidG9XYXRjaFwiO1xuICBtb3ZpZXNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gIHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiID0gXCJncmlkXCI7XG5cbiAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihsZWFmKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGdldFZpZXdUeXBlKCkge1xuICAgIHJldHVybiBWSUVXX1RZUEU7XG4gIH1cblxuICBnZXREaXNwbGF5VGV4dCgpIHtcbiAgICByZXR1cm4gXCJCb3hPZmZpY2VcIjtcbiAgfVxuXG4gIC8vIFByb3ZpZGUgYSBjdXN0b20gaWNvbiBmb3IgdGhlIHZpZXcncyB0YWJcbiAgZ2V0SWNvbigpOiBzdHJpbmcge1xuICAgIHJldHVybiBcImNsYXBwZXJib2FyZFwiO1xuICB9XG5cbiAgYXN5bmMgb25PcGVuKCkge1xuICAgIHRoaXMudmlld01vZGUgPSB0aGlzLnBsdWdpbi52aWV3TW9kZSA/PyBcImdyaWRcIjtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1oZWFkZXJcIiB9KTtcbiAgICBoZWFkZXIuY3JlYXRlRWwoXCJoMVwiLCB7XG4gICAgICB0ZXh0OiBcIkJveE9mZmljZVwiLFxuICAgICAgY2xzOiBcImNpbmV2YXVsdC10aXRsZVwiXG4gICAgfSk7XG5cbiAgICBoZWFkZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiVGhpcyBwbHVnaW4gYWxsb3cgeW91IHRvIG1hbmFnZSB5b3VyIGZhdm9yaXRlcyBtb3ZpZSBhbmQgdHYgbGlicmFyeSBpbnRvIHlvdXIgdmF1bHQuXFxuU2VhcmNoIE9NRGIsIHJhdGUgdGl0bGVzLCBhbmQgc3RvcmUgeW91ciBjb2xsZWN0aW9uIGluIGEganNvbiBmaWxlIHdpdGhpbiB5b3VyIHZhdWx0IG9yIGluIGEgc2VwYXJhdGUgdmF1bHQuXCIsXG4gICAgICBjbHM6IFwiY2luZXZhdWx0LWhlYWRlci10ZXh0XCJcbiAgICB9KTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICByZW5kZXJPbmJvYXJkaW5nKGNvbnRhaW5lciwgYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aGlzLmZpbGUgPSBhd2FpdCBjcmVhdGVKc29uRmlsZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgICBpZiAodGhpcy5maWxlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aCh0aGlzLmZpbGUucGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkRmlsZSh0aGlzLmZpbGUpO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAvLyBPcGVuIG1vZGFsIHRvIHNlbGVjdCBKU09OIGZpbGUgZnJvbSB2YXVsdFxuICAgICAgICBuZXcgSnNvbkZpbGVTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4uYXBwLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUoZmlsZSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSkub3BlbigpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoIGFyZWFcbiAgICBjb25zdCBzZWFyY2hCb3ggPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2hcIiB9KTtcblxuICAgIC8vIFNlYXJjaCB0aXRsZVxuICAgIGNvbnN0IHNlYXJjaElucHV0Q29udGFpbmVyID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWlucHV0LWNvbnRhaW5lclwiIH0pO1xuICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoSW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1pbnB1dFwiLFxuICAgICAgYXR0cjoge1xuICAgICAgICBwbGFjZWhvbGRlcjogXCJTZWFyY2hcIlxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgZmlsdGVyU3dpdGNoID0gc2VhcmNoSW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtY2xlYXJcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgXCJhcmlhLWxhYmVsXCI6IFwiTW9yZSBmaWx0ZXJcIixcbiAgICAgICAgdGl0bGU6IFwiTW9yZSBmaWx0ZXJcIlxuICAgICAgfVxuICAgIH0pXG5cbiAgICBzZXRJY29uKGZpbHRlclN3aXRjaCwgXCJzbGlkZXJzLWhvcml6b250YWxcIik7XG5cbiAgICBjb25zdCBtb3JlRmlsdGVyQ29udGFpbmVyID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9yZS1maWx0ZXJcIiB9KTtcblxuICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgZmlsdGVyU3dpdGNoLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAobW9yZUZpbHRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIikge1xuICAgICAgICBtb3JlRmlsdGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gWWVhciBmaWx0ZXJcbiAgICBjb25zdCB5ZWFySW5wdXQgPSBtb3JlRmlsdGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtaW5wdXRcIixcbiAgICAgIGF0dHI6IHsgcGxhY2Vob2xkZXI6IFwiWWVhclwiIH1cbiAgICB9KTtcblxuICAgIC8vIFR5cGUgZmlsdGVyXG4gICAgY29uc3QgdHlwZVNlbGVjdCA9IG1vcmVGaWx0ZXJDb250YWluZXIuY3JlYXRlRWwoXCJzZWxlY3RcIiwgeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1zZWxlY3RcIiB9KTtcbiAgICB0eXBlU2VsZWN0LmNyZWF0ZUVsKFwib3B0aW9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQWxsXCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJUeXBlXCJcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIE9NREJfVFlQRVMuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgdHlwZVNlbGVjdC5jcmVhdGVFbChcIm9wdGlvblwiLCB7XG4gICAgICAgIHRleHQ6IHRbMF0udG9VcHBlckNhc2UoKSArIHQuc2xpY2UoMSksXG4gICAgICAgIGF0dHI6IHsgdmFsdWU6IHQgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDb250YWluZXIgZm9yIHNlYXJjaCByZXN1bHRzLCBjcmVhdGVkIG9uIGRlbWFuZFxuICAgIGxldCByZXN1bHRzTGlzdDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1jb250ZW50XCIgfSk7XG4gICAgdGhpcy5tb3ZpZXNDb250YWluZXIgPSBjb250ZW50O1xuXG4gICAgdGhpcy5yZW5kZXJNb3ZpZXMoY29udGVudCk7XG5cbiAgICBsZXQgc2VhcmNoVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgcnVuU2VhcmNoID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICBpZiAoIXF1ZXJ5KSByZXR1cm47XG4gICAgICBjb25zdCB0eXBlID0gdHlwZVNlbGVjdC52YWx1ZSB8fCB1bmRlZmluZWQ7XG4gICAgICBjb25zdCB5ZWFyID0geWVhcklucHV0LnZhbHVlLnRyaW0oKSB8fCB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBzZWFyY2hPbWRiKHF1ZXJ5LCB0aGlzLnBsdWdpbi5vbWRiQXBpS2V5LCB0eXBlLCB5ZWFyKTtcblxuICAgICAgaWYgKCFyZXN1bHRzIHx8IHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmICghcmVzdWx0c0xpc3QpIHJlc3VsdHNMaXN0ID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLXJlc3VsdHNcIiB9KTtcbiAgICAgICAgcmVzdWx0c0xpc3QuZW1wdHkoKTtcbiAgICAgICAgcmVzdWx0c0xpc3QuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIk5vIHJlc3VsdHMgZm91bmQuXCIsIGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWVtcHR5XCIgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXN1bHRzTGlzdCkgcmVzdWx0c0xpc3QgPSBzZWFyY2hCb3guY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtcmVzdWx0c1wiIH0pO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTZWFyY2hSZXN1bHRzKHJlc3VsdHNMaXN0LCByZXN1bHRzKTtcbiAgICB9O1xuXG4gICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSB7XG4gICAgICAgIGlmIChyZXN1bHRzTGlzdCkge1xuICAgICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QucmVtb3ZlKCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB7XG4gICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTtcbiAgICAgICAgICBzZWFyY2hUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB3aW5kb3cuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpO1xuICAgICAgc2VhcmNoVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHJ1blNlYXJjaCwgMzUwKTtcbiAgICB9KTtcblxuICAgIHllYXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkpIHJldHVybjtcbiAgICAgIGF3YWl0IHJ1blNlYXJjaCgpO1xuICAgIH0pO1xuXG4gICAgdHlwZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSByZXR1cm47XG4gICAgICBhd2FpdCBydW5TZWFyY2goKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyTW92aWVzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICBjb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBsaWJyYXJ5IGxvYWRlZC5cIiB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB3YXRjaGVkID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiBtb3ZpZS53YXRjaGVkKTtcbiAgICBjb25zdCB0b1dhdGNoID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiAhbW92aWUud2F0Y2hlZCk7XG5cbiAgICBjb25zdCB0YWJzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtdGFicy1jb250YWluZXJcIiB9KTtcbiAgICBjb25zdCB0YWJIZWFkZXIgPSB0YWJzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtdGFiLWhlYWRlclwiIH0pO1xuXG4gICAgY29uc3QgdGFiQnV0dG9ucyA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXRhYi1idXR0b25zXCIgfSk7XG4gICAgY29uc3Qgdmlld1RvZ2dsZSA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXZpZXctdG9nZ2xlXCIgfSk7XG5cbiAgICBjb25zdCB0b1dhdGNoQnV0dG9uID0gdGFiQnV0dG9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LXRhYi1idXR0b25cIixcbiAgICAgIHRleHQ6IGBUbyBXYXRjaCAoJHt0b1dhdGNoLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3Qgd2F0Y2hlZEJ1dHRvbiA9IHRhYkJ1dHRvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC10YWItYnV0dG9uXCIsXG4gICAgICB0ZXh0OiBgV2F0Y2hlZCAoJHt3YXRjaGVkLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3QgZ3JpZEJ1dHRvbiA9IHZpZXdUb2dnbGUuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC12aWV3LWJ1dHRvblwiLFxuICAgICAgYXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJHcmlkIHZpZXdcIiwgdGl0bGU6IFwiR3JpZCB2aWV3XCIgfVxuICAgIH0pO1xuICAgIGNvbnN0IGxpc3RCdXR0b24gPSB2aWV3VG9nZ2xlLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtdmlldy1idXR0b25cIixcbiAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTGlzdCB2aWV3XCIsIHRpdGxlOiBcIkxpc3Qgdmlld1wiIH1cbiAgICB9KTtcblxuICAgIHNldEljb24oZ3JpZEJ1dHRvbiwgXCJsYXlvdXQtZ3JpZFwiKTtcbiAgICBzZXRJY29uKGxpc3RCdXR0b24sIFwibGlzdFwiKTtcblxuICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHtcbiAgICAgIHRvV2F0Y2hCdXR0b24uY2xhc3NMaXN0LmFkZChcImNpbmV2YXVsdC10YWItYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2F0Y2hlZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXRhYi1idXR0b24tYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnZpZXdNb2RlID09PSBcImdyaWRcIikge1xuICAgICAgZ3JpZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YWJDb250ZW50ID0gdGFic0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXRhYi1jb250ZW50XCIgfSk7XG4gICAgY29uc3QgYWN0aXZlTW92aWVzID0gdGhpcy5hY3RpdmVUYWIgPT09IFwidG9XYXRjaFwiID8gdG9XYXRjaCA6IHdhdGNoZWQ7XG4gICAgY29uc3QgYWN0aXZlVGl0bGUgPSB0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIgPyBcIlRvIFdhdGNoXCIgOiBcIldhdGNoZWRcIjtcbiAgICB0aGlzLnJlbmRlck1vdmllU2VjdGlvbih0YWJDb250ZW50LCBhY3RpdmVUaXRsZSwgYWN0aXZlTW92aWVzKTtcblxuICAgIHRvV2F0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHJldHVybjtcbiAgICAgIHRoaXMuYWN0aXZlVGFiID0gXCJ0b1dhdGNoXCI7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuXG4gICAgd2F0Y2hlZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcIndhdGNoZWRcIikgcmV0dXJuO1xuICAgICAgdGhpcy5hY3RpdmVUYWIgPSBcIndhdGNoZWRcIjtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBncmlkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImdyaWRcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwiZ3JpZFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBsaXN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJsaXN0XCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImxpc3RcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwibGlzdFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vdmllU2VjdGlvbihjb250YWluZXI6IEhUTUxFbGVtZW50LCB0aXRsZTogc3RyaW5nLCBtb3ZpZXM6IENpbmVWYXVsdE1vdmllW10pIHtcbiAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VjdGlvblwiIH0pO1xuICAgIC8vIHNlY3Rpb24uY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IHRpdGxlIH0pO1xuXG4gICAgaWYgKG1vdmllcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHNlY3Rpb24uY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBtb3ZpZXMgaW4gdGhpcyBsaXN0LlwiIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3QgPSBzZWN0aW9uLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IHRoaXMudmlld01vZGUgPT09IFwiZ3JpZFwiID8gXCJjaW5ldmF1bHQtbW92aWUtZ3JpZFwiIDogXCJjaW5ldmF1bHQtbW92aWUtbGlzdFwiXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVHcmlkKGxpc3QsIG1vdmllcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVMaXN0KGxpc3QsIG1vdmllcyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZUdyaWQoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgbW92aWVzLmZvckVhY2goKG1vdmllKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW92aWUtY2FyZFwiIH0pO1xuICAgICAgY2FyZC5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJjaW5ldmF1bHQtbW92aWUtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIG1vdmllLnBvc3Rlcik7XG4gICAgICBjYXJkLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogbW92aWUudGl0bGUsIGNsczogXCJjaW5ldmF1bHQtbW92aWUtdGl0bGVcIiB9KTtcblxuICAgICAgLy8gQnVpbGQgdGhlIGRldGFpbHMgc3RyaW5nIGNvbmRpdGlvbmFsbHksIG9ubHkgaW5jbHVkaW5nIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcbiAgICAgIGNvbnN0IGRldGFpbHNQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS55ZWFyLCBudWxsKTtcbiAgICAgIGNvbnN0IHR5cGUgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyBtb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcblxuICAgICAgaWYgKHllYXIpIGRldGFpbHNQYXJ0cy5wdXNoKHllYXIpO1xuICAgICAgaWYgKHR5cGUpIGRldGFpbHNQYXJ0cy5wdXNoKHR5cGUpO1xuXG4gICAgICBjb25zdCBkZXRhaWxzVGV4dCA9IGRldGFpbHNQYXJ0cy5qb2luKFwiIC0gXCIpO1xuICAgICAgaWYgKGRldGFpbHNUZXh0KSB7XG4gICAgICAgIGNhcmQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBkZXRhaWxzVGV4dCwgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS15ZWFyXCIgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgIGNyZWF0ZVN0YXJSYXRpbmcoY2FyZCwgbW92aWUuc3RhclJhdGluZywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobW92aWUucmF0aW5ncyAmJiBtb3ZpZS5yYXRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGNhcmQsIG1vdmllLnJhdGluZ3MpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMub3Blbk1vdmllRGV0YWlscyhtb3ZpZSkpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZUxpc3QoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgbW92aWVzLmZvckVhY2goKG1vdmllKSA9PiB7XG4gICAgICBjb25zdCByb3cgPSBjb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS1yb3dcIlxuICAgICAgfSk7XG4gICAgICBjb25zdCBwb3N0ZXIgPSByb3cuY3JlYXRlRWwoXCJpbWdcIiwge1xuICAgICAgICBjbHM6IFwiY2luZXZhdWx0LW1vdmllLXRodW1ibmFpbFwiXG4gICAgICB9KTtcbiAgICAgIHBvc3Rlci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbW92aWUucG9zdGVyIHx8IFwiXCIpO1xuXG4gICAgICBjb25zdCBpbmZvID0gcm93LmNyZWF0ZURpdih7XG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW92aWUtaW5mb1wiXG4gICAgICB9KTtcblxuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgIHRleHQ6IG1vdmllLnRpdGxlLFxuICAgICAgICBjbHM6IFwiY2luZXZhdWx0LW1vdmllLXRpdGxlXCJcbiAgICAgIH0pO1xuXG4gICAgICAvLyBCdWlsZCB0aGUgZGV0YWlscyBzdHJpbmcgY29uZGl0aW9uYWxseSwgb25seSBpbmNsdWRpbmcgbm9uLW51bGwvdW5kZWZpbmVkIHZhbHVlc1xuICAgICAgY29uc3QgZGV0YWlsc1BhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgY29uc3QgeWVhciA9IG51bGxTYWZlKCgpID0+IG1vdmllLnllYXIsIG51bGwpO1xuICAgICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IG1vdmllLnR5cGVbMF0udG9VcHBlckNhc2UoKSArIG1vdmllLnR5cGUuc2xpY2UoMSksIG51bGwpO1xuXG4gICAgICBpZiAoeWVhcikge1xuICAgICAgICBkZXRhaWxzUGFydHMucHVzaCh5ZWFyKVxuICAgICAgfTtcblxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgZGV0YWlsc1BhcnRzLnB1c2godHlwZSlcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRldGFpbHNUZXh0ID0gZGV0YWlsc1BhcnRzLmpvaW4oXCIgLSBcIik7XG4gICAgICBpZiAoZGV0YWlsc1RleHQpIHtcbiAgICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgdGV4dDogZGV0YWlsc1RleHQsXG4gICAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS15ZWFyXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgIGNyZWF0ZVN0YXJSYXRpbmcoaW5mbywgbW92aWUuc3RhclJhdGluZywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobW92aWUucmF0aW5ncyAmJiBtb3ZpZS5yYXRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGluZm8sIG1vdmllLnJhdGluZ3MpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTW92aWVEZXRhaWxzKG1vdmllKSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9wZW5Nb3ZpZURldGFpbHMobW92aWU6IENpbmVWYXVsdE1vdmllKSB7XG4gICAgbmV3IENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwodGhpcy5wbHVnaW4uYXBwLCBtb3ZpZSwgYXN5bmMgKHJhdGluZykgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICAgIG1vdmllLnN0YXJSYXRpbmcgPSByYXRpbmc7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgdGhpcy5kYXRhLm1vdmllcyA9IHRoaXMuZGF0YS5tb3ZpZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmlkICE9PSBtb3ZpZS5pZCk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgbW92aWUud2F0Y2hlZCA9ICFtb3ZpZS53YXRjaGVkO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgdGhpcy5yZWZyZXNoTW92aWVzKCk7XG4gICAgfSkub3BlbigpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWZyZXNoTW92aWVzKCkge1xuICAgIGlmICghdGhpcy5tb3ZpZXNDb250YWluZXIpIHJldHVybjtcbiAgICB0aGlzLnJlbmRlck1vdmllcyh0aGlzLm1vdmllc0NvbnRhaW5lcik7XG4gIH1cblxuICBwcml2YXRlIGdldEpzb25GaWxlcygpOiBURmlsZVtdIHtcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplRGF0YSgpIHtcbiAgICAvLyBQcmVmZXIgYSBsb2NhbGx5IGxpbmtlZCBmaWxlIGluc2lkZSB0aGUgdmF1bHQgaWYgY29uZmlndXJlZFxuICAgIGNvbnN0IGxvY2FsUGF0aCA9IHRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGg7XG4gICAgaWYgKGxvY2FsUGF0aCkge1xuICAgICAgY29uc3QgbG9jYWxGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGxvY2FsRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUobG9jYWxGaWxlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vIGxpbmtlZCBmaWxlcyBmb3VuZCBcdTIwMTQgZG9uJ3QgY3JlYXRlIGZvbGRlcnMvZmlsZXMgYXV0b21hdGljYWxseS4gU2hvdyBvbmJvYXJkaW5nLlxuICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZEZpbGUoZmlsZTogVEZpbGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gYXdhaXQgbG9hZExvY2FsRmlsZSh0aGlzLnBsdWdpbi5hcHAsIGZpbGUpO1xuICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgIHRoaXMuZGF0YSA9IHBhcnNlZDtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldExvY2FsSnNvblBhdGgoZmlsZS5wYXRoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgICBuZXcgTm90aWNlKFwiVW5hYmxlIHRvIHJlYWQgdGhlIEpTT04gZmlsZS5cIik7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgYXN5bmMgc2F2ZURhdGEoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICB0aGlzLmRhdGEudXBkYXRlZEF0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGlmICh0aGlzLmZpbGUpIHtcbiAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIHRoaXMuZGF0YSk7XG4gICAgfVxuICB9XG5cblxuICBwcml2YXRlIGFzeW5jIHJlbmRlclNlYXJjaFJlc3VsdHMoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcmVzdWx0czogYW55W10pIHtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWl0ZW1cIiB9KTtcbiAgICAgIGlmIChyZXN1bHQucG9zdGVyKSB7XG4gICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1wb3N0ZXJcIiB9KS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgcmVzdWx0LnBvc3Rlcik7XG4gICAgICB9XG4gICAgICBjb25zdCBpbmZvID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1pbmZvXCIgfSk7XG4gICAgICBpbmZvLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogcmVzdWx0LnRpdGxlLCBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC10aXRsZVwiIH0pO1xuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHJlc3VsdC55ZWFyLCBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC15ZWFyXCIgfSk7XG5cbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgbmV3IENpbmVWYXVsdE1vdmllQWN0aW9uTW9kYWwodGhpcy5wbHVnaW4uYXBwLCByZXN1bHQsIGFzeW5jICh3YXRjaGVkKSA9PiB7XG4gICAgICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcblxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5kYXRhLm1vdmllcy5maW5kKChtb3ZpZSkgPT4gbW92aWUuaW1kYklkID09PSByZXN1bHQuaW1kYklkKTtcbiAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLndhdGNoZWQgPSB3YXRjaGVkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBMb2FkaW5nIGRldGFpbHMgZm9yICR7cmVzdWx0LnRpdGxlfS4uLmApO1xuICAgICAgICAgICAgY29uc3QgZGV0YWlscyA9IGF3YWl0IGdldE9tZGJEZXRhaWxzKHJlc3VsdC5pbWRiSWQsIHRoaXMucGx1Z2luLm9tZGJBcGlLZXkpO1xuXG4gICAgICAgICAgICBpZiAoIWRldGFpbHMpIHtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBsb2FkIG1vdmllIGRldGFpbHMuXCIpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG5ld01vdmllID0gY3JlYXRlRW1wdHlNb3ZpZSgpO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYklkID0gZGV0YWlscy5pbWRiSUQgfHwgcmVzdWx0LmltZGJJZDtcbiAgICAgICAgICAgIG5ld01vdmllLnRpdGxlID0gZGV0YWlscy5UaXRsZSB8fCByZXN1bHQudGl0bGU7XG4gICAgICAgICAgICBuZXdNb3ZpZS55ZWFyID0gZGV0YWlscy5ZZWFyIHx8IHJlc3VsdC55ZWFyO1xuICAgICAgICAgICAgbmV3TW92aWUucmF0ZWQgPSBkZXRhaWxzLlJhdGVkIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5yZWxlYXNlZCA9IGRldGFpbHMuUmVsZWFzZWQgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnJ1bnRpbWUgPSBkZXRhaWxzLlJ1bnRpbWUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmdlbnJlID0gZGV0YWlscy5HZW5yZSB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuZGlyZWN0b3IgPSBkZXRhaWxzLkRpcmVjdG9yIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS53cml0ZXIgPSBkZXRhaWxzLldyaXRlciB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuYWN0b3JzID0gZGV0YWlscy5BY3RvcnMgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnBsb3QgPSBkZXRhaWxzLlBsb3QgfHwgcmVzdWx0LnBsb3Q7XG4gICAgICAgICAgICBuZXdNb3ZpZS5sYW5ndWFnZSA9IGRldGFpbHMuTGFuZ3VhZ2UgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmNvdW50cnkgPSBkZXRhaWxzLkNvdW50cnkgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmF3YXJkcyA9IGRldGFpbHMuQXdhcmRzIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5wb3N0ZXIgPSBkZXRhaWxzLlBvc3RlciAmJiBkZXRhaWxzLlBvc3RlciAhPT0gXCJOL0FcIiA/IGRldGFpbHMuUG9zdGVyIDogcmVzdWx0LnBvc3RlcjtcbiAgICAgICAgICAgIG5ld01vdmllLnBvc3RlckxvY2FsID0gXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnJhdGluZ3MgPSBkZXRhaWxzLlJhdGluZ3MgfHwgW107XG4gICAgICAgICAgICBuZXdNb3ZpZS5tZXRhc2NvcmUgPSBkZXRhaWxzLk1ldGFzY29yZSB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYlJhdGluZyA9IGRldGFpbHMuaW1kYlJhdGluZyB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYlZvdGVzID0gZGV0YWlscy5pbWRiVm90ZXMgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnR5cGUgPSBkZXRhaWxzLlR5cGUgfHwgcmVzdWx0LnR5cGU7XG4gICAgICAgICAgICBuZXdNb3ZpZS5kdmQgPSBkZXRhaWxzLkRWRCB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuYm94T2ZmaWNlID0gZGV0YWlscy5Cb3hPZmZpY2UgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnByb2R1Y3Rpb24gPSBkZXRhaWxzLlByb2R1Y3Rpb24gfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLndlYnNpdGUgPSBkZXRhaWxzLldlYnNpdGUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnRvdGFsU2Vhc29ucyA9IGRldGFpbHMudG90YWxTZWFzb25zIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS53YXRjaGVkID0gd2F0Y2hlZDtcblxuICAgICAgICAgICAgdGhpcy5kYXRhLm1vdmllcy5wdXNoKG5ld01vdmllKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0pLm9wZW4oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59IiwgImV4cG9ydCBmdW5jdGlvbiByZW5kZXJPbmJvYXJkaW5nKFxuICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICBvbkNyZWF0ZTogKCkgPT4gdm9pZCxcbiAgb25MaW5rPzogKCkgPT4gdm9pZFxuKSB7XG4gIGNvbnN0IG9uYm9hcmRpbmcgPSBjb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICBjbHM6IFwiY2luZXZhdWx0LW9uYm9hcmRpbmdcIlxuICB9KTtcblxuICBjb25zdCBhY3Rpb25zID0gb25ib2FyZGluZy5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LW9uYm9hcmRpbmctYWN0aW9uc1wiIH0pO1xuICBjb25zdCBjcmVhdGVCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJDcmVhdGUgbmV3IGxpYnJhcnlcIiB9KTtcbiAgY3JlYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkNyZWF0ZSk7XG5cbiAgaWYgKG9uTGluaykge1xuICAgIGFjdGlvbnMuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJvclwiIH0pO1xuICAgIGNvbnN0IGxpbmtCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJMaW5rIGV4aXN0aW5nIGxpYnJhcnlcIiB9KTtcbiAgICBsaW5rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkxpbmspO1xuICB9XG59IiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdFNlYXJjaEl0ZW0gfSBmcm9tIFwiLi4vLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBjbGFzcyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBwcml2YXRlIG1vdmllOiBDaW5lVmF1bHRTZWFyY2hJdGVtO1xuICBwcml2YXRlIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBNb2RhbFtcImFwcFwiXSwgbW92aWU6IENpbmVWYXVsdFNlYXJjaEl0ZW0sIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMubW92aWUgPSBtb3ZpZTtcbiAgICB0aGlzLm9uU2F2ZSA9IG9uU2F2ZTtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogdGhpcy5tb3ZpZS50aXRsZSB9KTtcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYCR7dGhpcy5tb3ZpZS55ZWFyfSBcdTIwMjIgJHt0aGlzLm1vdmllLnR5cGV9YCB9KTtcbiAgICBpZiAodGhpcy5tb3ZpZS5wb3N0ZXIpIHtcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXBvc3RlclwiIH0pLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLm1vdmllLnBvc3Rlcik7XG4gICAgfVxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiB0aGlzLm1vdmllLnBsb3QgfSk7XG5cbiAgICBjb25zdCBhY3Rpb25zID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWFjdGlvbnNcIiB9KTtcbiAgICBjb25zdCB3YXRjaGVkQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiTWFyayBhcyB3YXRjaGVkXCIgfSk7XG4gICAgY29uc3QgdG9XYXRjaEJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlRvIHdhdGNoXCIgfSk7XG5cbiAgICB3YXRjaGVkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLm9uU2F2ZSh0cnVlKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHRvV2F0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25TYXZlKGZhbHNlKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uLy4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgY3JlYXRlU3RhclJhdGluZyB9IGZyb20gXCIuLi9zdGFyUmF0aW5nXCI7XG5pbXBvcnQgeyBudWxsU2FmZSwgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIgfSBmcm9tIFwic3JjL3V0aWxzL2dsb2JhbE1ldGhvZHNcIjtcblxuZXhwb3J0IGNsYXNzIENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHByaXZhdGUgbW92aWU6IENpbmVWYXVsdE1vdmllO1xuICBwcml2YXRlIG9uUmF0ZTogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uUmVtb3ZlOiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uVG9nZ2xlV2F0Y2hlZDogKCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBhcHA6IE1vZGFsW1wiYXBwXCJdLFxuICAgIG1vdmllOiBDaW5lVmF1bHRNb3ZpZSxcbiAgICBvblJhdGU6IChyYXRpbmc6IG51bWJlcikgPT4gdm9pZCxcbiAgICBvblJlbW92ZTogKCkgPT4gdm9pZCxcbiAgICBvblRvZ2dsZVdhdGNoZWQ6ICgpID0+IHZvaWRcbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm1vdmllID0gbW92aWU7XG4gICAgdGhpcy5vblJhdGUgPSBvblJhdGU7XG4gICAgdGhpcy5vblJlbW92ZSA9IG9uUmVtb3ZlO1xuICAgIHRoaXMub25Ub2dnbGVXYXRjaGVkID0gb25Ub2dnbGVXYXRjaGVkO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWNvbnRhaW5lclwiXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2RhbEhlYWRlciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1oZWFkZXJcIlxuICAgIH0pO1xuXG4gICAgY29uc3QgbW9kYWxUaXRsZUNvbnRhaW5lciA9IG1vZGFsSGVhZGVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC10aXRsZS1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcImgxXCIsIHtcbiAgICAgIHRleHQ6IHRoaXMubW92aWUudGl0bGUsXG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC10aXRsZVwiXG4gICAgfSk7XG5cbiAgICAvLyBZZWFyIGFuZCBUeXBlXG4gICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IHRoaXMubW92aWUudHlwZVswXS50b1VwcGVyQ2FzZSgpICsgdGhpcy5tb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcbiAgICBjb25zdCB5ZWFyID0gbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS55ZWFyLCBudWxsKTtcblxuICAgIG1vZGFsVGl0bGVDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IGAke3llYXJ9IC0gJHt0eXBlfWAsXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkRpcmVjdGVkIGJ5IFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5kaXJlY3RvciwgXCJOL0FcIiksXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkR1cmF0aW9uIFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5ydW50aW1lLCBcIk4vQVwiKSxcbiAgICB9KTtcblxuICAgIC8vIFBvc3RlclxuICAgIGlmICh0aGlzLm1vdmllLnBvc3Rlcikge1xuICAgICAgbW9kYWxIZWFkZXIuY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1wb3N0ZXJcIiB9KS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5tb3ZpZS5wb3N0ZXIpO1xuICAgIH1cblxuICAgIC8vIFBsb3RcbiAgICBpZiAodGhpcy5tb3ZpZS5wbG90KSB7XG4gICAgICBjb25zdCBwbG90Q29udGFpbmVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1wbG90LWNvbnRhaW5lclwiIH0pO1xuXG4gICAgICBjb25zdCBwbG90RWwgPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IHRoaXMubW92aWUucGxvdCxcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcGxvdFwiXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc2hvd01vcmVCdXR0b24gPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgdGV4dDogXCJTaG93IG1vcmVcIixcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlIGNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiXG4gICAgICB9KVxuXG4gICAgICBzaG93TW9yZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gcGxvdEVsLmNsYXNzTGlzdC50b2dnbGUoXCJleHBhbmRlZC1wbG90XCIpO1xuICAgICAgICBzaG93TW9yZUJ1dHRvbi5zZXRUZXh0KGlzRXhwYW5kZWQgPyBcIlNob3cgbGVzc1wiIDogXCJTaG93IG1vcmVcIik7XG4gICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3IgbGF5b3V0IHNvIHdlIGNhbiBtZWFzdXJlIG92ZXJmbG93XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAvLyBJZiBjb250ZW50IGhlaWdodCBleGNlZWRzIGNvbnRhaW5lciBoZWlnaHQsIGl0J3MgdHJ1bmNhdGVkXG4gICAgICAgIGlmIChwbG90RWwuc2Nyb2xsSGVpZ2h0ID4gcGxvdEVsLmNsaWVudEhlaWdodCArIDEpIHtcbiAgICAgICAgICBzaG93TW9yZUJ1dHRvbi5yZW1vdmVDbGFzcyhcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgZGV0YWlscyBzZWN0aW9uIG9ubHkgaWYgYXQgbGVhc3Qgb25lIGRldGFpbCBpcyBhdmFpbGFibGVcbiAgICBmdW5jdGlvbiByZWRlckRldGFpbFNlY3Rpb24odHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICBjb25zdCBkZXRhaWxFbGVtZW50ID0gbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1kZXRhaWwtY29udGFpbmVyXCIgfSk7XG4gICAgICBkZXRhaWxFbGVtZW50LmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IGAke3R5cGV9OmAsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWRldGFpbC1sYWJlbFwiXG4gICAgICB9KTtcbiAgICAgIGRldGFpbEVsZW1lbnQuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogdmFsdWUsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWRldGFpbC12YWx1ZVwiXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBtb2RhbENvbnRhaW5lci5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgLy8gR2VucmVcbiAgICBpZiAodGhpcy5tb3ZpZS5nZW5yZSkge1xuICAgICAgcmVkZXJEZXRhaWxTZWN0aW9uKFwiR2VucmVcIiwgdGhpcy5tb3ZpZS5nZW5yZSk7XG4gICAgfVxuXG4gICAgLy8gQWN0b3JzXG4gICAgaWYgKHRoaXMubW92aWUuYWN0b3JzKSB7XG4gICAgICByZWRlckRldGFpbFNlY3Rpb24oXCJBY3RvcnNcIiwgdGhpcy5tb3ZpZS5hY3RvcnMpO1xuICAgIH1cblxuICAgIG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICBjb25zdCByYXRpbmdXcmFwcGVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLXdyYXBwZXJcIiB9KTtcblxuICAgIC8vIFBlcnNvbmFsIFJhdGluZ1xuICAgIGNvbnN0IHJhdGluZ0NvbnRhaW5lciA9IHJhdGluZ1dyYXBwZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgcmF0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJSYXRpbmdcIiwgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLWxhYmVsXCIgfSk7XG4gICAgY3JlYXRlU3RhclJhdGluZyhyYXRpbmdDb250YWluZXIsIHRoaXMubW92aWUuc3RhclJhdGluZywgZmFsc2UsIChyYXRpbmcpID0+IHtcbiAgICAgIHRoaXMub25SYXRlKHJhdGluZyk7XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5tb3ZpZS5yYXRpbmdzKSB7XG4gICAgICBjb25zdCBleHRlcm5hbFJhdGluZ3NDb250YWluZXIgPSByYXRpbmdXcmFwcGVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIiB9KTtcblxuICAgICAgZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogXCJFeHRlcm5hbCByYXRpbmdcIixcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLWxhYmVsXCJcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXJFeHRlcm5hbFJhdGluZ0JhcihleHRlcm5hbFJhdGluZ3NDb250YWluZXIsIHRoaXMubW92aWUucmF0aW5ncyk7XG5cbiAgICAgIC8vIEV4dGVybmFsIHJhdGluZyBkaXNjbGFpbWVyIHN0YXlzIGluIHRoZSBtb2RhbFxuICAgICAgbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogXCJUaGUgZXh0ZXJuYWwgcmF0aW5nIGlzIGFuIGF2ZXJhZ2UgYmFzZWQgb24gdm90ZXMgZnJvbSBJbnRlcm5ldCBNb3ZpZSBEYXRhYmFzZSwgUm90dGVuIFRvbWF0b2VzIGFuZCBNZXRhY3JpdGljXCIsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1kaXNjbGFpbWVyXCJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGlvbnMgPSBtb2RhbENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1hY3Rpb25zXCIgfSk7XG4gICAgY29uc3QgdG9nZ2xlV2F0Y2hlZExhYmVsID0gdGhpcy5tb3ZpZS53YXRjaGVkID8gXCJNYXJrIGFzIHRvIHdhdGNoXCIgOiBcIk1hcmsgYXMgd2F0Y2hlZFwiO1xuICAgIGNvbnN0IHRvZ2dsZVdhdGNoZWRCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogdG9nZ2xlV2F0Y2hlZExhYmVsIH0pO1xuICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlJlbW92ZVwiLCBjbHM6IFwiY2luZXZhdWx0LWRhbmdlclwiIH0pO1xuXG4gICAgdG9nZ2xlV2F0Y2hlZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblRvZ2dsZVdhdGNoZWQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHJlbW92ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblJlbW92ZSgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59IiwgImV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdGFyUmF0aW5nKFxuICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICByYXRpbmc6IG51bWJlcixcbiAgcmVhZE9ubHk6IGJvb2xlYW4sXG4gIG9uQ2hhbmdlPzogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkXG4pIHtcbiAgY29uc3Qgc3RhcnMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zdGFyc1wiIH0pO1xuICBjb25zdCBzdGFyRWxlbWVudHM6IEhUTUxTcGFuRWxlbWVudFtdID0gW107XG4gIGxldCBjdXJyZW50UmF0aW5nID0gcmF0aW5nO1xuXG4gIGZvciAobGV0IGkgPSAxOyBpIDw9IDU7IGkgKz0gMSkge1xuICAgIGNvbnN0IHN0YXIgPSBzdGFycy5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlx1MjYwNVwiLCBjbHM6IFwiY2luZXZhdWx0LXN0YXJcIiB9KTtcbiAgICBpZiAoaSA8PSByYXRpbmcpIHN0YXIuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICBzdGFyRWxlbWVudHMucHVzaChzdGFyKTtcbiAgICBpZiAoIXJlYWRPbmx5KSB7XG4gICAgICBzdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIElmIGNsaWNraW5nIHRoZSBzYW1lIHN0YXIgdGhhdCdzIGFscmVhZHkgc2VsZWN0ZWQsIHJlc2V0IHRvIDBcbiAgICAgICAgaWYgKGN1cnJlbnRSYXRpbmcgPT09IGkpIHtcbiAgICAgICAgICBjdXJyZW50UmF0aW5nID0gMDtcbiAgICAgICAgICBzdGFyRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRSYXRpbmcgPSBpO1xuICAgICAgICAgIHN0YXJFbGVtZW50cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIsIGluZGV4IDwgaSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgb25DaGFuZ2U/LihjdXJyZW50UmF0aW5nKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoXCJyZWFkb25seVwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0YXJzO1xufVxuIiwgImltcG9ydCB0eXBlIHsgTW92aWVSYXRpbmcgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBudWxsU2FmZTxUPihmdW5jOiAoKSA9PiBULCBmYWxsYmFja1ZhbHVlOiBUIHwgbnVsbCA9IG51bGwpOiBUIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsdWUgPSBmdW5jKCk7XG4gICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyBmYWxsYmFja1ZhbHVlIDogdmFsdWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvcjogJywgZSk7XG4gICAgcmV0dXJuIGZhbGxiYWNrVmFsdWU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFJhdGluZyhyYXRpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gIGxldCB2YWx1ZSA9IHJhdGluZztcbiAgY29uc3QgaXNQZXJUZW4gPSByYXRpbmcuaW5jbHVkZXMoXCIvMTBcIik7XG4gIGNvbnN0IGlzUGVyQ2VudCA9IHJhdGluZy5pbmNsdWRlcyhcIi8xMDBcIik7XG5cbiAgaWYgKGlzUGVyVGVuICYmICFpc1BlckNlbnQpIHtcbiAgICBjb25zdCBub3JtYWxpemVkID0gdmFsdWUucmVwbGFjZSgnLCcsICcuJyk7XG4gICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdChub3JtYWxpemVkKTtcbiAgICBpZiAoIWlzTmFOKG51bSkgJiYgaXNGaW5pdGUobnVtKSkge1xuICAgICAgY29uc3QgbXVsdGlwbGllZCA9IG51bSAqIDEwO1xuICAgICAgdmFsdWUgPSBtdWx0aXBsaWVkICUgMSA9PT0gMCA/IFN0cmluZyhNYXRoLnRydW5jKG11bHRpcGxpZWQpKSA6IFN0cmluZyhtdWx0aXBsaWVkKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAocmF0aW5nLmluY2x1ZGVzKFwiL1wiKSAmJiBpc1BlckNlbnQpIHtcbiAgICB2YWx1ZSA9IHJhdGluZy5zcGxpdChcIi9cIilbMF0udHJpbSgpO1xuICB9IGVsc2UgaWYgKHJhdGluZy5pbmNsdWRlcyhcIiVcIikpIHtcbiAgICB2YWx1ZSA9IHJhdGluZy5yZXBsYWNlKFwiJVwiLCBcIlwiKS50cmltKCk7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGF2ZXJhZ2VSYXRpbmcocmF0aW5nczogc3RyaW5nW10pOiBzdHJpbmcge1xuICBjb25zdCBub3JtYWxpemVkUmF0aW5ncyA9IHJhdGluZ3MubWFwKGZvcm1hdFJhdGluZykubWFwKHIgPT4gcGFyc2VGbG9hdChyKSkuZmlsdGVyKHIgPT4gIWlzTmFOKHIpICYmIGlzRmluaXRlKHIpKTtcbiAgaWYgKG5vcm1hbGl6ZWRSYXRpbmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFwiTi9BXCI7XG4gIGNvbnN0IHN1bSA9IG5vcm1hbGl6ZWRSYXRpbmdzLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYyArIHZhbCwgMCk7XG4gIGNvbnN0IGF2ZXJhZ2UgPSBzdW0gLyBub3JtYWxpemVkUmF0aW5ncy5sZW5ndGg7XG4gIHJldHVybiBhdmVyYWdlICUgMSA9PT0gMCA/IFN0cmluZyhNYXRoLnRydW5jKGF2ZXJhZ2UpKSA6IFN0cmluZyhhdmVyYWdlLnRvRml4ZWQoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIocGFyZW50OiBIVE1MRWxlbWVudCwgcmF0aW5nczogTW92aWVSYXRpbmdbXSB8IHVuZGVmaW5lZCB8IG51bGwsIG9wdGlvbnM/OiB7XG4gIGNsYXNzZXM/OiB7XG4gICAgYmFyQ29udGFpbmVyPzogc3RyaW5nO1xuICAgIGJhcj86IHN0cmluZztcbiAgICBmaWxsPzogc3RyaW5nO1xuICAgIGF2ZXJhZ2U/OiBzdHJpbmc7XG4gIH07XG59KSB7XG4gIGlmICghcmF0aW5ncyB8fCByYXRpbmdzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG5cbiAgY29uc3QgY2xzID0ge1xuICAgIGJhckNvbnRhaW5lcjogb3B0aW9ucz8uY2xhc3Nlcz8uYmFyQ29udGFpbmVyID8/IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1yYXRpbmdzLWJhci1jb250YWluZXJcIixcbiAgICBiYXI6IG9wdGlvbnM/LmNsYXNzZXM/LmJhciA/PyBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5ncy1iYXJcIixcbiAgICBmaWxsOiBvcHRpb25zPy5jbGFzc2VzPy5maWxsID8/IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1yYXRpbmdzLWZpbGxcIixcbiAgICBhdmVyYWdlOiBvcHRpb25zPy5jbGFzc2VzPy5hdmVyYWdlID8/IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1yYXRpbmdzLWF2ZXJhZ2VcIlxuICB9O1xuXG4gIGNvbnN0IHJhdGluZ0JhckNvbnRhaW5lciA9IHBhcmVudC5jcmVhdGVEaXYoeyBjbHM6IGNscy5iYXJDb250YWluZXIgfSk7XG4gIGNvbnN0IHJhdGluZ0JhciA9IHJhdGluZ0JhckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IGNscy5iYXIgfSk7XG4gIGNvbnN0IHJhdGluZ0ZpbGwgPSByYXRpbmdCYXIuY3JlYXRlRGl2KHsgY2xzOiBjbHMuZmlsbCB9KTtcblxuICBjb25zdCB2YWx1ZXMgPSByYXRpbmdzLm1hcCgocikgPT4gZm9ybWF0UmF0aW5nKHIuVmFsdWUpKTtcbiAgY29uc3QgYXZlcmFnZSA9IGF2ZXJhZ2VSYXRpbmcodmFsdWVzKTtcbiAgY29uc3QgcGVyY2VudGFnZSA9IHBhcnNlRmxvYXQoYXZlcmFnZSk7XG5cbiAgcmF0aW5nRmlsbC5zdHlsZS53aWR0aCA9IGAke2lzTmFOKHBlcmNlbnRhZ2UpID8gMCA6IHBlcmNlbnRhZ2V9JWA7XG5cbiAgcmF0aW5nQmFyQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7XG4gICAgdGV4dDogYCR7YXZlcmFnZX0lYCxcbiAgICBjbHM6IGNscy5hdmVyYWdlXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgY29udGFpbmVyOiByYXRpbmdCYXJDb250YWluZXIsXG4gICAgYXZlcmFnZSxcbiAgICBwZXJjZW50YWdlOiBpc05hTihwZXJjZW50YWdlKSA/IDAgOiBwZXJjZW50YWdlXG4gIH07XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBKc29uRmlsZVN1Z2dlc3RNb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuICBwcml2YXRlIGpzb25GaWxlczogVEZpbGVbXTtcbiAgcHJpdmF0ZSBvblNlbGVjdDogKGZpbGU6IFRGaWxlKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBvblNlbGVjdDogKGZpbGU6IFRGaWxlKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XG4gICAgdGhpcy5qc29uRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZikgPT4gZi5leHRlbnNpb24gPT09IFwianNvblwiKTtcbiAgICB0aGlzLnNldFBsYWNlaG9sZGVyKFwiU2VsZWN0IGEgSlNPTiBmaWxlIGZyb20geW91ciB2YXVsdC4uLlwiKTtcbiAgfVxuXG4gIGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBURmlsZVtdIHtcbiAgICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gdGhpcy5qc29uRmlsZXMuZmlsdGVyKChmaWxlKSA9PlxuICAgICAgZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobG93ZXJRdWVyeSlcbiAgICApO1xuICB9XG5cbiAgcmVuZGVyU3VnZ2VzdGlvbihmaWxlOiBURmlsZSwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBmaWxlLnBhdGggfSk7XG4gIH1cblxuICBvbkNob29zZVN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICB0aGlzLm9uU2VsZWN0KGZpbGUpO1xuICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgeyBDaW5lVmF1bHREYXRhLCBDaW5lVmF1bHRNb3ZpZSB9IGZyb20gXCIuLi90eXBlcy9jaW5ldmF1bHRcIjtcblxuY29uc3QgRk9MREVSID0gXCJCb3hPZmZpY2VcIjtcbmNvbnN0IERFRkFVTFRfTkFNRSA9IFwibGlicmFyeVN0b3JhZ2UuanNvblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFBhdGgoZm9sZGVyPzogc3RyaW5nKSB7XG4gIGNvbnN0IGZvbGRlclBhdGggPSBmb2xkZXIgPz8gRk9MREVSO1xuICByZXR1cm4gYCR7Zm9sZGVyUGF0aH0vJHtERUZBVUxUX05BTUV9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZvbGRlcihmb2xkZXI/OiBzdHJpbmcpIHtcbiAgcmV0dXJuIGZvbGRlciA/PyBGT0xERVI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbXB0eU1vdmllKCk6IENpbmVWYXVsdE1vdmllIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKSxcbiAgICBpbWRiSWQ6IFwiXCIsXG4gICAgdGl0bGU6IFwiXCIsXG4gICAgeWVhcjogXCJcIixcbiAgICByYXRlZDogXCJcIixcbiAgICByZWxlYXNlZDogXCJcIixcbiAgICBydW50aW1lOiBcIlwiLFxuICAgIGdlbnJlOiBcIlwiLFxuICAgIGRpcmVjdG9yOiBcIlwiLFxuICAgIHdyaXRlcjogXCJcIixcbiAgICBhY3RvcnM6IFwiXCIsXG4gICAgcGxvdDogXCJcIixcbiAgICBsYW5ndWFnZTogXCJcIixcbiAgICBjb3VudHJ5OiBcIlwiLFxuICAgIGF3YXJkczogXCJcIixcbiAgICBwb3N0ZXI6IFwiXCIsXG4gICAgcG9zdGVyTG9jYWw6IFwiXCIsXG4gICAgcmF0aW5nczogW10sXG4gICAgbWV0YXNjb3JlOiBcIlwiLFxuICAgIGltZGJSYXRpbmc6IFwiXCIsXG4gICAgaW1kYlZvdGVzOiBcIlwiLFxuICAgIHR5cGU6IFwiXCIsXG4gICAgZHZkOiBcIlwiLFxuICAgIGJveE9mZmljZTogXCJcIixcbiAgICBwcm9kdWN0aW9uOiBcIlwiLFxuICAgIHdlYnNpdGU6IFwiXCIsXG4gICAgdG90YWxTZWFzb25zOiBcIlwiLFxuICAgIHRvbWF0b1VSTDogXCJcIixcbiAgICB0b21hdG9NZXRlcjogXCJcIixcbiAgICB0b21hdG9JbWFnZTogXCJcIixcbiAgICB0b21hdG9SYXRpbmc6IFwiXCIsXG4gICAgdG9tYXRvUmV2aWV3czogXCJcIixcbiAgICB0b21hdG9GcmVzaDogXCJcIixcbiAgICB0b21hdG9Sb3R0ZW46IFwiXCIsXG4gICAgdG9tYXRvQ29uc2Vuc3VzOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJNZXRlcjogXCJcIixcbiAgICB0b21hdG9Vc2VyUmF0aW5nOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJSZXZpZXdzOiBcIlwiLFxuICAgIHN0YXJSYXRpbmc6IDAsXG4gICAgd2F0Y2hlZDogZmFsc2UsXG4gICAgbm90ZXM6IFwiXCJcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHREYXRhKCk6IENpbmVWYXVsdERhdGEge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIHJldHVybiB7XG4gICAgc2NoZW1hVmVyc2lvbjogMSxcbiAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICB1cGRhdGVkQXQ6IG5vdyxcbiAgICBsaWJyYXJ5TmFtZTogXCJDaW5lVmF1bHRcIixcbiAgICBvd25lcjogXCJcIixcbiAgICBzb3VyY2U6IFwiQ2luZVZhdWx0XCIsXG4gICAgbW92aWVzOiBbXVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplRGF0YShkYXRhOiBDaW5lVmF1bHREYXRhKTogQ2luZVZhdWx0RGF0YSB7XG4gIHJldHVybiB7XG4gICAgLi4uZGF0YSxcbiAgICBtb3ZpZXM6IGRhdGEubW92aWVzLm1hcCgobW92aWUpID0+ICh7XG4gICAgICAuLi5jcmVhdGVFbXB0eU1vdmllKCksXG4gICAgICAuLi5tb3ZpZSxcbiAgICAgIHllYXI6IG1vdmllLnllYXIgPyBTdHJpbmcobW92aWUueWVhcikgOiBcIlwiLFxuICAgICAgc3RhclJhdGluZzogdHlwZW9mIG1vdmllLnN0YXJSYXRpbmcgPT09IFwibnVtYmVyXCIgPyBtb3ZpZS5zdGFyUmF0aW5nIDogMFxuICAgIH0pKVxuICB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRm9sZGVyKGFwcDogQXBwLCBmb2xkZXI/OiBzdHJpbmcpIHtcbiAgY29uc3QgZm9sZGVyUGF0aCA9IGdldEZvbGRlcihmb2xkZXIpO1xuICBpZiAoIWFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCkpIHtcbiAgICBhd2FpdCBhcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVKc29uRmlsZShhcHA6IEFwcCwgZm9sZGVyPzogc3RyaW5nKTogUHJvbWlzZTxURmlsZT4ge1xuICBjb25zdCBmb2xkZXJQYXRoID0gZ2V0Rm9sZGVyKGZvbGRlcik7XG4gIGF3YWl0IGVuc3VyZUZvbGRlcihhcHAsIGZvbGRlcik7XG4gIGNvbnN0IGV4aXN0aW5nID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aChmb2xkZXIpKTtcbiAgY29uc3QgZmlsZW5hbWUgPSBleGlzdGluZyA/IGBib3hvZmZpY2UtJHtEYXRlLm5vdygpfS5qc29uYCA6IERFRkFVTFRfTkFNRTtcbiAgY29uc3QgcGF0aCA9IGAke2ZvbGRlclBhdGh9LyR7ZmlsZW5hbWV9YDtcblxuICByZXR1cm4gYXBwLnZhdWx0LmNyZWF0ZShwYXRoLCBKU09OLnN0cmluZ2lmeShjcmVhdGVEZWZhdWx0RGF0YSgpLCBudWxsLCAyKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkTG9jYWxGaWxlKGFwcDogQXBwLCBmaWxlOiBURmlsZSk6IFByb21pc2U8Q2luZVZhdWx0RGF0YT4ge1xuICBjb25zdCByYXcgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcbiAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShyYXcpIGFzIENpbmVWYXVsdERhdGE7XG4gIGlmICghcGFyc2VkIHx8ICFBcnJheS5pc0FycmF5KHBhcnNlZC5tb3ZpZXMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiRm9ybWF0byBKU09OIG5vbiB2YWxpZG9cIik7XG4gIH1cbiAgcmV0dXJuIG5vcm1hbGl6ZURhdGEocGFyc2VkKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNhdmVMb2NhbERhdGEoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBkYXRhOiBDaW5lVmF1bHREYXRhKSB7XG4gIGF3YWl0IGFwcC52YXVsdC5tb2RpZnkoZmlsZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xufVxuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIHsgQ2luZVZhdWx0U2VhcmNoSXRlbSwgT21kYkRldGFpbGVkUmVzcG9uc2UgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hPbWRiKHF1ZXJ5OiBzdHJpbmcsIGFwaUtleTogc3RyaW5nLCB0eXBlPzogc3RyaW5nLCB5ZWFyPzogc3RyaW5nKTogUHJvbWlzZTxDaW5lVmF1bHRTZWFyY2hJdGVtW10+IHtcbiAgaWYgKCFhcGlLZXkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB0cnkge1xuICAgIGxldCB1cmwgPSBgaHR0cHM6Ly93d3cub21kYmFwaS5jb20vP2FwaWtleT0ke2FwaUtleX0mcz0ke2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSl9YDtcbiAgICBpZiAodHlwZSkge1xuICAgICAgdXJsICs9IGAmdHlwZT0ke2VuY29kZVVSSUNvbXBvbmVudCh0eXBlKX1gO1xuICAgIH1cbiAgICBpZiAoeWVhcikge1xuICAgICAgdXJsICs9IGAmeT0ke2VuY29kZVVSSUNvbXBvbmVudCh5ZWFyKX1gO1xuICAgIH1cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwodXJsKTtcbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbiBhcyB7XG4gICAgICBTZWFyY2g/OiBBcnJheTx7IFRpdGxlOiBzdHJpbmc7IFllYXI6IHN0cmluZzsgaW1kYklEOiBzdHJpbmc7IFR5cGU6IHN0cmluZzsgUG9zdGVyOiBzdHJpbmcgfT47XG4gICAgfTtcblxuICAgIGlmIChkYXRhPy5TZWFyY2gpIHtcbiAgICAgIHJldHVybiBkYXRhLlNlYXJjaC5tYXAoKGl0ZW0pID0+ICh7XG4gICAgICAgIGltZGJJZDogaXRlbS5pbWRiSUQsXG4gICAgICAgIHRpdGxlOiBpdGVtLlRpdGxlLFxuICAgICAgICB5ZWFyOiBpdGVtLlllYXIsXG4gICAgICAgIHR5cGU6IGl0ZW0uVHlwZSxcbiAgICAgICAgcG9zdGVyOiBpdGVtLlBvc3RlciAmJiBpdGVtLlBvc3RlciAhPT0gXCJOL0FcIiA/IGl0ZW0uUG9zdGVyIDogXCJcIixcbiAgICAgICAgcGxvdDogXCJcIlxuICAgICAgfSkpO1xuICAgIH1cblxuICAgIHJldHVybiBbXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIE9NRGI6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9tZGJEZXRhaWxzKGltZGJJZDogc3RyaW5nLCBhcGlLZXk6IHN0cmluZywgZGVwdGg6IG51bWJlciA9IDApOiBQcm9taXNlPE9tZGJEZXRhaWxlZFJlc3BvbnNlIHwgbnVsbD4ge1xuICAvLyBSZXRyeSBsaW1pdFxuICBpZiAoZGVwdGggPj0gMykge1xuICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBmZXRjaCBtb3ZpZSBkZXRhaWxzIGFmdGVyICR7ZGVwdGh9IGF0dGVtcHRzYCk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoIWFwaUtleSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cub21kYmFwaS5jb20vP2FwaWtleT0ke2FwaUtleX0maT0ke2ltZGJJZH0mcGxvdD1mdWxsJnRvbWF0b2VzPXRydWVgO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh1cmwpO1xuXG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb24gYXMgT21kYkRldGFpbGVkUmVzcG9uc2UgJiB7IFJlc3BvbnNlOiBzdHJpbmcgfTtcblxuICAgIGlmIChkYXRhLlJlc3BvbnNlICE9PSBcIlRydWVcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIk9NRGIgQVBJIHJldHVybmVkIGVycm9yIHJlc3BvbnNlXCIsIGRhdGEpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIG1vdmllIGRldGFpbHMsIHJldHJ5aW5nLi4uXCIsIGVycm9yKTtcbiAgICByZXR1cm4gZ2V0T21kYkRldGFpbHMoaW1kYklkLCBhcGlLZXksIGRlcHRoICsgMSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBwbHVnaW5WaWV3IGZyb20gXCIuLi92aWV3cy9wbHVnaW5WaWV3XCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0RGF0YSwgY3JlYXRlSnNvbkZpbGUsIGdldERlZmF1bHRQYXRoLCBnZXRGb2xkZXIsIHNhdmVMb2NhbERhdGEgfSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2luZVZhdWx0U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IENpbmVWYXVsdFBsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgLy8gQ29uZmlndXJhdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQ29uZmlndXJhdGlvblwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIk9NRGIgQVBJIGtleVwiKVxuICAgICAgLnNldERlc2MoXCJFbnRlciB5b3VyIE9NRGIgQVBJIGtleS4gWW91IGNhbiBnZXQgb25lIGZvciBmcmVlIGF0IG9tZGJhcGkuY29tXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgeW91ciBBUEkga2V5XCIpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5vbWRiQXBpS2V5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0T21kYkFwaUtleSh2YWx1ZSk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJMaWJyYXJ5IGZvbGRlclwiKVxuICAgICAgLnNldERlc2MoXCJUaGUgZm9sZGVyIHdoZXJlIHRoZSBwbHVnaW4gd2lsbCBzdG9yZSBsaWJyYXJ5IGZpbGVzXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRm9sZGVyIG5hbWVcIilcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBmb2xkZXIgPSB2YWx1ZS50cmltKCkgfHwgXCJCb3hPZmZpY2VcIjtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMaWJyYXJ5Rm9sZGVyKGZvbGRlcik7XG4gICAgICAgIH0pKTtcblxuICAgIC8vIEV4dGVybmFsIGxpYnJhcnkgc3VwcG9ydCByZW1vdmVkLlxuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkxpbmtlZCBsb2NhbCBsaWJyYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcbiAgICAgICAgdGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aFxuICAgICAgICAgID8gYExvY2FsIGZpbGU6ICR7dGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aH1gXG4gICAgICAgICAgOiBcIk5vIGxvY2FsIGxpYnJhcnkgbGlua2VkXCJcbiAgICAgIClcbiAgICAgIC5hZGREcm9wZG93bihkcm9wID0+IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZikgPT4gZi5leHRlbnNpb24gPT09IFwianNvblwiKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgXCJcIjogXCItLSBOb25lIC0tXCIgfTtcbiAgICAgICAgZmlsZXMuZm9yRWFjaCgoZikgPT4gKG9wdGlvbnNbZi5wYXRoXSA9IGYucGF0aCkpO1xuICAgICAgICBkcm9wLmFkZE9wdGlvbnMob3B0aW9ucykuc2V0VmFsdWUodGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aCA/PyBcIlwiKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBwYXRoID0gdmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKHBhdGgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJVbmxpbmsgbG9jYWxcIilcbiAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChudWxsKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hPcGVuVmlld3MoKTtcbiAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkNyZWF0ZSBuZXcgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJDcmVhdGUgYSBuZXcgZW1wdHkgbG9jYWwgbGlicmFyeSBmcm9tIHNjcmF0Y2guIFRoaXMgd2lsbCB1bmxpbmsgYW55IGV4dGVybmFsIGxpYnJhcnkuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDcmVhdGUgbGlicmFyeVwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVOZXdMaWJyYXJ5KCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJFeHBvcnQgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJTYXZlIGEgY29weSBvZiB5b3VyIGxpYnJhcnkgSlNPTiB0byBhIGZpbGUuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJFeHBvcnQgSlNPTlwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5leHBvcnRMaWJyYXJ5SnNvbigpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBCdWdmaXhcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkJ1Z2ZpeFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlcG9ydCBpc3N1ZXNcIilcbiAgICAgIC5zZXREZXNjKFwiSWYgeW91IGVuY291bnRlciBhbnkgaXNzdWVzIHdpdGggdGhlIHBsdWdpbiwgcGxlYXNlIHJlcG9ydCB0aGVtLiBZb3VyIGZlZWRiYWNrIGlzIGludmFsdWFibGUgZm9yIGltcHJvdmluZyBCb3hPZmZpY2UhXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHaXRIdWJcIilcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHdpbmRvdy5vcGVuKFwiaHR0cHM6Ly9naXRodWIuY29tL3ZzY2FwZXJyb3R0YS9vYnNpZGlhbi1jaW5ldmF1bHQvaXNzdWVzXCIsIFwiX2JsYW5rXCIpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBTdXBwb3J0IGFuZCBkb25hdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiU3VwcG9ydFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkRvbmF0ZVwiKVxuICAgICAgLnNldERlc2MoXG4gICAgICAgIFwiSWYgeW91IGxpa2UgdGhpcyBwbHVnaW4sIGNvbnNpZGVyIGRvbmF0aW5nIHRvIHN1cHBvcnQgY29udGludWVkIGRldmVsb3BtZW50LlwiXG4gICAgICApXG4gICAgICAuYWRkQnV0dG9uKChidCkgPT4ge1xuICAgICAgICBidC5idXR0b25FbC5vdXRlckhUTUwgPVxuICAgICAgICAgIFwiPGEgaHJlZj0naHR0cHM6Ly9rby1maS5jb20vVDZUMDFUWDgwNycgdGFyZ2V0PSdfYmxhbmsnPjxpbWcgaGVpZ2h0PSczNicgc3R5bGU9J2JvcmRlcjowcHg7aGVpZ2h0OjM2cHg7JyBzcmM9J2h0dHBzOi8vc3RvcmFnZS5rby1maS5jb20vY2RuL2tvZmk2LnBuZz92PTYnIGJvcmRlcj0nMCcgYWx0PSdCdXkgTWUgYSBDb2ZmZWUgYXQga28tZmkuY29tJyAvPjwvYT5cIjtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRMaWJyYXJ5SnNvbigpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZ2V0TGlicmFyeUpzb25Db250ZW50KCk7XG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgbmV3IE5vdGljZShcIk5vIGxpYnJhcnkgZmlsZSBmb3VuZCB0byBleHBvcnQuXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBleHBvcnQgZmlsZSBpbnNpZGUgdmF1bHQgZm9yIG1vYmlsZSBjb21wYXRpYmlsaXR5XG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCBcIi1cIikuc2xpY2UoMCwgMTkpO1xuICAgICAgY29uc3QgZXhwb3J0UGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS5qc29uYDtcblxuICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMsIGlmIHNvIGFkZCBhIGNvdW50ZXJcbiAgICAgIGxldCBmaW5hbFBhdGggPSBleHBvcnRQYXRoO1xuICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgd2hpbGUgKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaW5hbFBhdGgpKSB7XG4gICAgICAgIGZpbmFsUGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS0ke2NvdW50ZXJ9Lmpzb25gO1xuICAgICAgICBjb3VudGVyKys7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaW5hbFBhdGgsIGNvbnRlbnQpO1xuICAgICAgbmV3IE5vdGljZShgTGlicmFyeSBleHBvcnRlZCB0byAke2ZpbmFsUGF0aH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIltCb3hPZmZpY2VdIEV4cG9ydCBsaWJyYXJ5IGVycm9yXCIsIGVycm9yKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJVbmFibGUgdG8gZXhwb3J0IHRoZSBsaWJyYXJ5LlwiKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0xpYnJhcnkoKSB7XG4gICAgY29uc3QgY29uZmlybWVkID0gd2luZG93LmNvbmZpcm0oXG4gICAgICBcIkNyZWF0ZSBhIG5ldyBlbXB0eSBCb3hPZmZpY2UgbGlicmFyeT8gVGhpcyB3aWxsIHVubGluayBhbnkgZXh0ZXJuYWwgbGlicmFyeSBhbmQgcmVzZXQgeW91ciBsb2NhbCBsaWJyYXJ5IGRhdGEuXCJcbiAgICApO1xuICAgIGlmICghY29uZmlybWVkKSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVmYXVsdEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZ2V0RGVmYXVsdFBhdGgodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcikpO1xuICAgICAgbGV0IGNyZWF0ZWRGaWxlOiBURmlsZSB8IHVuZGVmaW5lZDtcbiAgICAgIGlmIChkZWZhdWx0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5hcHAsIGRlZmF1bHRGaWxlLCBjcmVhdGVEZWZhdWx0RGF0YSgpKTtcbiAgICAgICAgY3JlYXRlZEZpbGUgPSBkZWZhdWx0RmlsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNyZWF0ZWRGaWxlID0gYXdhaXQgY3JlYXRlSnNvbkZpbGUodGhpcy5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3JlYXRlZEZpbGUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChjcmVhdGVkRmlsZS5wYXRoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICBuZXcgTm90aWNlKFwiTmV3IGxpYnJhcnkgY3JlYXRlZC5cIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQm94T2ZmaWNlXSBDcmVhdGUgbmV3IGxpYnJhcnkgZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBjcmVhdGUgYSBuZXcgbGlicmFyeS5cIik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRMaWJyYXJ5SnNvbkNvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gUHJlZmVyIGEgbG9jYWwgbGlua2VkIGZpbGUgaW5zaWRlIHRoZSB2YXVsdFxuICAgIGlmICh0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKSB7XG4gICAgICBjb25zdCBsb2NhbFBhdGggPSB0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoO1xuICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBkZWZhdWx0RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aCh0aGlzLnBsdWdpbi5saWJyYXJ5Rm9sZGVyKSk7XG4gICAgaWYgKGRlZmF1bHRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGRlZmF1bHRGaWxlKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcik7XG4gICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmFwcC52YXVsdFxuICAgICAgLmdldEZpbGVzKClcbiAgICAgIC5maW5kKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoYCR7Zm9sZGVyfS9gKSk7XG5cbiAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGZhbGxiYWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaE9wZW5WaWV3cygpIHtcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRSk7XG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIHBsdWdpblZpZXcpIHtcbiAgICAgICAgYXdhaXQgbGVhZi52aWV3Lm9uT3BlbigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1Qjs7O0FDQWhCLElBQU0sWUFBWTtBQUVsQixJQUFNLGFBQWEsQ0FBQyxTQUFTLFVBQVUsU0FBUzs7O0FDRnZELElBQUFDLG1CQUFnRTs7O0FDQXpELFNBQVMsaUJBQ2QsV0FDQSxVQUNBLFFBQ0E7QUFDQSxRQUFNLGFBQWEsVUFBVSxVQUFVO0FBQUEsSUFDckMsS0FBSztBQUFBLEVBQ1AsQ0FBQztBQUVELFFBQU0sVUFBVSxXQUFXLFVBQVUsRUFBRSxLQUFLLCtCQUErQixDQUFDO0FBQzVFLFFBQU0sZUFBZSxRQUFRLFNBQVMsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDOUUsZUFBYSxpQkFBaUIsU0FBUyxRQUFRO0FBRS9DLE1BQUksUUFBUTtBQUNWLFlBQVEsU0FBUyxLQUFLLEVBQUUsTUFBTSxLQUFLLENBQUM7QUFDcEMs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QUssZ0JBQWdCO0FBQ3JCLFVBQU0sS0FBSyxlQUFlO0FBQUEsRUFDM0I7QUFBQSxFQUVBLE1BQU0saUJBQWlCLFFBQWdCO0FBQ3RDLFNBQUssZ0JBQWdCO0FBQ3JCLFVBQU0sS0FBSyxlQUFlO0FBQUEsRUFDM0I7QUFBQTtBQUFBLEVBR0EsTUFBYyxhQUFhO0FBQzFCLFVBQU0saUJBQWlCLEtBQUssSUFBSSxVQUFVLGdCQUFnQixTQUFTO0FBQ25FLFFBQUksZUFBZSxTQUFTLEdBQUc7QUFDOUIsV0FBSyxJQUFJLFVBQVUsV0FBVyxlQUFlLENBQUMsQ0FBQztBQUMvQztBQUFBLElBQ0Q7QUFFQSxVQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsUUFBUSxJQUFJO0FBQzVDLFVBQU0sS0FBSyxhQUFhO0FBQUEsTUFDdkIsTUFBTTtBQUFBLE1BQ04sUUFBUTtBQUFBLElBQ1QsQ0FBQztBQUFBLEVBQ0Y7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAidHlwZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
