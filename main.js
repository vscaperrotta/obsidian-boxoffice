/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CineVaultPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/constants.ts
var NAME = "BoxOffice";
var VIEW_TYPE = "BoxOfficeView";
var FOLDER = "BoxOffice";
var OMDB_TYPES = ["movie", "series", "episode"];
var OMDB_URL = "https://www.omdbapi.com";

// src/views/PluginView.ts
var import_obsidian5 = require("obsidian");

// src/ui/onboarding.ts
function renderOnboarding(container, onCreate, onLink) {
  const onboarding = container.createDiv({
    cls: "obs-plugin-boxoffice-boxoffice-onboarding"
  });
  const actions = onboarding.createDiv({ cls: "obs-plugin-boxoffice-boxoffice-onboarding-actions" });
  const createButton = actions.createEl("button", { text: "Create new library" });
  createButton.addEventListener("click", onCreate);
  if (onLink) {
    actions.createEl("p", { text: "or" });
    const linkButton = actions.createEl("button", { text: "Link existing library" });
    linkButton.addEventListener("click", onLink);
  }
}

// src/ui/modals/actionModal.ts
var import_obsidian = require("obsidian");

// src/utils/helpers.ts
function nullSafe(func, fallbackValue = null) {
  try {
    const value = func();
    return value === null || value === void 0 ? fallbackValue : value;
  } catch (e) {
    console.error("Error: ", e);
    return fallbackValue;
  }
}
function formatRating(rating) {
  let value = rating;
  const isPerTen = rating.includes("/10");
  const isPerCent = rating.includes("/100");
  if (isPerTen && !isPerCent) {
    const normalized = value.replace(",", ".");
    const num = parseFloat(normalized);
    if (!isNaN(num) && isFinite(num)) {
      const multiplied = num * 10;
      value = multiplied % 1 === 0 ? String(Math.trunc(multiplied)) : String(multiplied);
    }
  } else if (rating.includes("/") && isPerCent) {
    value = rating.split("/")[0].trim();
  } else if (rating.includes("%")) {
    value = rating.replace("%", "").trim();
  }
  return value;
}
function averageRating(ratings) {
  const normalizedRatings = ratings.map(formatRating).map((r) => parseFloat(r)).filter((r) => !isNaN(r) && isFinite(r));
  if (normalizedRatings.length === 0)
    return "N/A";
  const sum = normalizedRatings.reduce((acc, val) => acc + val, 0);
  const average = sum / normalizedRatings.length;
  return average % 1 === 0 ? String(Math.trunc(average)) : String(average.toFixed(1));
}
function renderExternalRatingBar(parent, ratings, options) {
  if (!ratings || ratings.length === 0)
    return null;
  const ratingBarContainer = parent.createDiv({ cls: "obs-plugin-boxoffice-bar-container" });
  const ratingBar = ratingBarContainer.createDiv({ cls: "obs-plugin-boxoffice-bar" });
  const ratingFill = ratingBar.createDiv({ cls: "obs-plugin-boxoffice-fill" });
  const values = ratings.map((r) => formatRating(r.Value));
  const average = averageRating(values);
  const percentage = parseFloat(average);
  ratingFill.style.width = `${isNaN(percentage) ? 0 : percentage}%`;
  ratingBarContainer.createEl("span", {
    text: `${average}%`,
    cls: "obs-plugin-boxoffice-average"
  });
  return {
    container: ratingBarContainer,
    average,
    percentage: isNaN(percentage) ? 0 : percentage
  };
}

// src/ui/modals/actionModal.ts
var CineVaultMovieActionModal = class extends import_obsidian.Modal {
  constructor(app, movie, onSave) {
    super(app);
    this.movie = movie;
    this.onSave = onSave;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const modalContainer = contentEl.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-container"
    });
    const modalHeader = modalContainer.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-header"
    });
    const modalTitleContainer = modalHeader.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-title-container"
    });
    modalTitleContainer.createEl("h1", {
      text: this.movie.title,
      cls: "obs-plugin-boxoffice-modal-detail-title"
    });
    const type = nullSafe(() => this.movie.type[0].toUpperCase() + this.movie.type.slice(1), null);
    const year = nullSafe(() => this.movie.year, null);
    modalTitleContainer.createEl("p", {
      text: `${year} - ${type}`
    });
    if (this.movie.poster) {
      modalHeader.createEl("img", { cls: "obs-plugin-boxoffice-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    const actions = contentEl.createDiv({ cls: "obs-plugin-boxoffice-modal-detail-actions" });
    const watchedButton = actions.createEl(
      "button",
      {
        text: "Mark as watched"
      }
    );
    const toWatchButton = actions.createEl(
      "button",
      {
        text: "To watch"
      }
    );
    watchedButton.addEventListener("click", () => {
      this.onSave(true);
      this.close();
    });
    toWatchButton.addEventListener("click", () => {
      this.onSave(false);
      this.close();
    });
  }
};

// src/ui/modals/detailModal.ts
var import_obsidian2 = require("obsidian");

// src/ui/starRating.ts
function createStarRating(container, rating, readOnly, onChange) {
  const stars = container.createDiv({ cls: "obs-plugin-boxoffice-stars" });
  const starElements = [];
  let currentRating = rating;
  for (let i = 1; i <= 5; i += 1) {
    const star = stars.createEl("span", { text: "\u2605", cls: "obs-plugin-boxoffice-star" });
    if (i <= rating)
      star.classList.add("active");
    starElements.push(star);
    if (!readOnly) {
      star.addEventListener("click", () => {
        if (currentRating === i) {
          currentRating = 0;
          starElements.forEach((element) => {
            element.classList.remove("active");
          });
        } else {
          currentRating = i;
          starElements.forEach((element, index) => {
            element.classList.toggle("active", index < i);
          });
        }
        onChange == null ? void 0 : onChange(currentRating);
      });
    } else {
      star.classList.add("readonly");
    }
  }
  return stars;
}

// src/ui/modals/detailModal.ts
var CineVaultMovieDetailModal = class extends import_obsidian2.Modal {
  constructor(app, movie, onRate, onRemove, onToggleWatched) {
    super(app);
    this.movie = movie;
    this.onRate = onRate;
    this.onRemove = onRemove;
    this.onToggleWatched = onToggleWatched;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const modalContainer = contentEl.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-container"
    });
    const modalHeader = modalContainer.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-header"
    });
    const modalTitleContainer = modalHeader.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-title-container"
    });
    modalTitleContainer.createEl("h1", {
      text: this.movie.title,
      cls: "obs-plugin-boxoffice-modal-detail-title"
    });
    const type = nullSafe(() => this.movie.type[0].toUpperCase() + this.movie.type.slice(1), null);
    const year = nullSafe(() => this.movie.year, null);
    modalTitleContainer.createEl("p", {
      text: `${year} - ${type}`
    });
    modalTitleContainer.createEl("p", {
      text: "Directed by " + nullSafe(() => this.movie.director, "N/A")
    });
    modalTitleContainer.createEl("p", {
      text: "Duration " + nullSafe(() => this.movie.runtime, "N/A")
    });
    if (this.movie.poster) {
      modalHeader.createEl("img", { cls: "obs-plugin-boxoffice-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    if (this.movie.plot) {
      const plotContainer = modalContainer.createEl("div", { cls: "obs-plugin-boxoffice-modal-detail-plot-container" });
      const plotEl = plotContainer.createEl("p", {
        text: this.movie.plot,
        cls: "obs-plugin-boxoffice-modal-detail-plot"
      });
      const showMoreButton = plotContainer.createEl("button", {
        text: "Show more",
        cls: "obs-plugin-boxoffice-modal-detail-show-more obs-plugin-boxoffice-modal-detail-show-more-hidden"
      });
      showMoreButton.addEventListener("click", () => {
        const isExpanded = plotEl.classList.toggle("expanded-plot");
        showMoreButton.setText(isExpanded ? "Show less" : "Show more");
      });
      requestAnimationFrame(() => {
        if (plotEl.scrollHeight > plotEl.clientHeight + 1) {
          showMoreButton.removeClass("obs-plugin-boxoffice-modal-detail-show-more-hidden");
        }
      });
    }
    function rederDetailSection(type2, value) {
      const detailElement = modalContainer.createEl("div", { cls: "obs-plugin-boxoffice-modal-detail-detail-container" });
      detailElement.createEl("p", {
        text: `${type2}:`,
        cls: "obs-plugin-boxoffice-modal-detail-label"
      });
      detailElement.createEl("p", {
        text: value,
        cls: "obs-plugin-boxoffice-modal-detail-detail-value"
      });
    }
    modalContainer.createEl("hr");
    if (this.movie.genre) {
      rederDetailSection("Genre", this.movie.genre);
    }
    if (this.movie.actors) {
      rederDetailSection("Actors", this.movie.actors);
    }
    modalContainer.createEl("hr");
    const ratingWrapper = modalContainer.createDiv({ cls: "obs-plugin-boxoffice-modal-detail-rating-wrapper" });
    const ratingContainer = ratingWrapper.createDiv({
      cls: "obs-plugin-boxoffice-modal-detail-rating-container"
    });
    ratingContainer.createEl("div", { text: "Rating", cls: "obs-plugin-boxoffice-modal-detail-rating-label" });
    createStarRating(ratingContainer, this.movie.starRating, false, (rating) => {
      this.onRate(rating);
    });
    if (this.movie.ratings) {
      const externalRatingsContainer = ratingWrapper.createDiv({ cls: "obs-plugin-boxoffice-modal-detail-rating-container" });
      externalRatingsContainer.createEl("div", {
        text: "External rating",
        cls: "obs-plugin-boxoffice-modal-detail-rating-label"
      });
      renderExternalRatingBar(externalRatingsContainer, this.movie.ratings);
      modalContainer.createEl("p", {
        text: "The external rating is an average based on votes from Internet Movie Database, Rotten Tomatoes and Metacritic",
        cls: "obs-plugin-boxoffice-modal-detail-rating-disclaimer"
      });
    }
    const actions = modalContainer.createDiv({ cls: "obs-plugin-boxoffice-modal-detail-actions" });
    const toggleWatchedLabel = this.movie.watched ? "Mark as to watch" : "Mark as watched";
    const toggleWatchedButton = actions.createEl("button", { text: toggleWatchedLabel });
    const removeButton = actions.createEl("button", { text: "Remove", cls: "obs-plugin-boxoffice-danger" });
    toggleWatchedButton.addEventListener("click", () => {
      this.onToggleWatched();
      this.close();
    });
    removeButton.addEventListener("click", () => {
      this.onRemove();
      this.close();
    });
  }
};

// src/ui/JsonFileSuggestModal.ts
var import_obsidian3 = require("obsidian");
var JsonFileSuggestModal = class extends import_obsidian3.SuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
    this.jsonFiles = this.app.vault.getFiles().filter((f) => f.extension === "json");
    this.setPlaceholder("Select a JSON file from your vault...");
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    return this.jsonFiles.filter(
      (file) => file.path.toLowerCase().includes(lowerQuery)
    );
  }
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.path });
  }
  onChooseSuggestion(file, evt) {
    this.onSelect(file);
  }
};

// src/services/libraryStorage.ts
var DEFAULT_NAME = `${NAME}.json`;
function getDefaultPath(folder) {
  const folderPath = folder != null ? folder : FOLDER;
  return `${folderPath}/${DEFAULT_NAME}`;
}
function getFolder(folder) {
  return folder != null ? folder : FOLDER;
}
function createEmptyMovie() {
  return {
    id: Math.random().toString(36),
    imdbId: "",
    title: "",
    year: "",
    rated: "",
    released: "",
    runtime: "",
    genre: "",
    director: "",
    writer: "",
    actors: "",
    plot: "",
    language: "",
    country: "",
    awards: "",
    poster: "",
    posterLocal: "",
    ratings: [],
    metascore: "",
    imdbRating: "",
    imdbVotes: "",
    type: "",
    dvd: "",
    boxOffice: "",
    production: "",
    website: "",
    totalSeasons: "",
    tomatoURL: "",
    tomatoMeter: "",
    tomatoImage: "",
    tomatoRating: "",
    tomatoReviews: "",
    tomatoFresh: "",
    tomatoRotten: "",
    tomatoConsensus: "",
    tomatoUserMeter: "",
    tomatoUserRating: "",
    tomatoUserReviews: "",
    starRating: 0,
    watched: false,
    notes: ""
  };
}
function createDefaultData() {
  const now = new Date().toISOString();
  return {
    schemaVersion: 1,
    createdAt: now,
    updatedAt: now,
    libraryName: "CineVault",
    owner: "",
    source: "CineVault",
    movies: []
  };
}
function normalizeData(data) {
  return {
    ...data,
    movies: data.movies.map((movie) => ({
      ...createEmptyMovie(),
      ...movie,
      year: movie.year ? String(movie.year) : "",
      starRating: typeof movie.starRating === "number" ? movie.starRating : 0
    }))
  };
}
async function ensureFolder(app, folder) {
  const folderPath = getFolder(folder);
  if (!app.vault.getAbstractFileByPath(folderPath)) {
    await app.vault.createFolder(folderPath);
  }
}
async function createJsonFile(app, folder) {
  const folderPath = getFolder(folder);
  await ensureFolder(app, folder);
  const existing = app.vault.getAbstractFileByPath(getDefaultPath(folder));
  const filename = existing ? `boxoffice-${Date.now()}.json` : DEFAULT_NAME;
  const path = `${folderPath}/${filename}`;
  return app.vault.create(path, JSON.stringify(createDefaultData(), null, 2));
}
async function loadLocalFile(app, file) {
  const raw = await app.vault.read(file);
  const parsed = JSON.parse(raw);
  if (!parsed || !Array.isArray(parsed.movies)) {
    throw new Error("Formato JSON non valido");
  }
  return normalizeData(parsed);
}
async function saveLocalData(app, file, data) {
  await app.vault.modify(file, JSON.stringify(data, null, 2));
}

// src/services/omdbService.ts
var import_obsidian4 = require("obsidian");
async function searchOmdb(query, apiKey, type, year) {
  if (!apiKey) {
    return [];
  }
  try {
    let url = `${OMDB_URL}/?apikey=${apiKey}&s=${encodeURIComponent(query)}`;
    if (type) {
      url += `&type=${encodeURIComponent(type)}`;
    }
    if (year) {
      url += `&y=${encodeURIComponent(year)}`;
    }
    const response = await (0, import_obsidian4.requestUrl)(url);
    console.log(response);
    const data = response.json;
    console.log(data);
    if (data == null ? void 0 : data.Search) {
      return data.Search.map((item) => ({
        imdbId: item.imdbID,
        title: item.Title,
        year: item.Year,
        type: item.Type,
        poster: item.Poster && item.Poster !== "N/A" ? item.Poster : ""
      }));
    }
    return [];
  } catch (error) {
    console.error("Error searching OMDb:", error);
    return [];
  }
}
async function getOmdbDetails(imdbId, apiKey, depth = 0) {
  if (depth >= 3) {
    console.error(`Failed to fetch movie details after ${depth} attempts`);
    return null;
  }
  if (!apiKey) {
    return null;
  }
  try {
    const url = `${OMDB_URL}/?apikey=${apiKey}&i=${imdbId}&plot=full&tomatoes=true`;
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data.Response !== "True") {
      console.error("OMDb API returned error response", data);
      return null;
    }
    return data;
  } catch (error) {
    console.error("Error fetching movie details, retrying...", error);
    return getOmdbDetails(imdbId, apiKey, depth + 1);
  }
}

// src/views/PluginView.ts
var PluginViewView = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.file = null;
    this.data = null;
    this.activeTab = "toWatch";
    this.moviesContainer = null;
    this.viewMode = "grid";
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE;
  }
  getDisplayText() {
    return "BoxOffice";
  }
  // Provide a custom icon for the view's tab
  getIcon() {
    return "clapperboard";
  }
  async onOpen() {
    var _a;
    this.viewMode = (_a = this.plugin.viewMode) != null ? _a : "grid";
    await this.initializeData();
    await this.render();
  }
  async render() {
    const container = this.containerEl.children[1];
    container.empty();
    const header = container.createDiv({ cls: "obs-plugin-boxoffice-header" });
    header.createEl("h1", {
      text: "BoxOffice",
      cls: "obs-plugin-boxoffice-title"
    });
    header.createEl("p", {
      text: "This plugin allow you to manage your favorites movie and tv library into your vault.\nSearch OMDb, rate titles, and store your collection in a json file within your vault or in a separate vault.",
      cls: "obs-plugin-boxoffice-header-text"
    });
    if (!this.data) {
      renderOnboarding(container, async () => {
        this.file = await createJsonFile(this.plugin.app, this.plugin.libraryFolder);
        if (this.file) {
          await this.plugin.setLocalJsonPath(this.file.path);
        }
        await this.loadFile(this.file);
        await this.render();
      }, () => {
        new JsonFileSuggestModal(this.plugin.app, async (file) => {
          await this.loadFile(file);
          await this.render();
        }).open();
      });
      return;
    }
    const searchBox = container.createDiv({ cls: "obs-plugin-boxoffice-search" });
    const searchInputsGroup = searchBox.createDiv({ cls: "obs-plugin-boxoffice-search-inputs-group" });
    const searchInputContainer = searchInputsGroup.createDiv({ cls: "obs-plugin-boxoffice-search-input-container" });
    const searchInput = searchInputContainer.createEl("input", {
      cls: "obs-plugin-boxoffice-search-input",
      attr: {
        placeholder: "Search"
      }
    });
    const filterSwitch = searchInputContainer.createEl("button", {
      cls: "obs-plugin-boxoffice-search-clear",
      attr: {
        "aria-label": "More filter",
        title: "More filter"
      }
    });
    (0, import_obsidian5.setIcon)(filterSwitch, "sliders-horizontal");
    const moreFilterContainer = searchInputsGroup.createDiv({ cls: "obs-plugin-boxoffice-more-filter" });
    moreFilterContainer.style.display = "none";
    filterSwitch.addEventListener("click", () => {
      if (moreFilterContainer.style.display === "none") {
        moreFilterContainer.style.display = "flex";
      } else {
        moreFilterContainer.style.display = "none";
      }
    });
    const yearInput = moreFilterContainer.createEl("input", {
      cls: "obs-plugin-boxoffice-search-input",
      attr: { placeholder: "Year" }
    });
    const typeSelect = moreFilterContainer.createEl("select", { cls: "obs-plugin-boxoffice-search-select" });
    typeSelect.createEl("option", {
      text: "All",
      attr: {
        value: "",
        placeholder: "Type"
      }
    });
    OMDB_TYPES.forEach((t) => {
      typeSelect.createEl("option", {
        text: t[0].toUpperCase() + t.slice(1),
        attr: { value: t }
      });
    });
    let resultsList = null;
    const content = container.createDiv({ cls: "obs-plugin-boxoffice-content" });
    this.moviesContainer = content;
    this.renderMovies(content);
    let searchTimeout = null;
    const runSearch = async () => {
      const query = searchInput.value.trim();
      if (!query)
        return;
      const type = typeSelect.value || void 0;
      const year = yearInput.value.trim() || void 0;
      const results = await searchOmdb(query, this.plugin.omdbApiKey, type, year);
      console.log(results);
      if (!results || results.length === 0) {
        if (!resultsList)
          resultsList = searchBox.createDiv({ cls: "obs-plugin-boxoffice-search-results" });
        resultsList.empty();
        resultsList.createEl("div", { text: "No results found.", cls: "obs-plugin-boxoffice-search-empty" });
        return;
      }
      if (!resultsList)
        resultsList = searchBox.createDiv({ cls: "obs-plugin-boxoffice-search-results" });
      await this.renderSearchResults(resultsList, results);
    };
    searchInput.addEventListener("input", () => {
      if (!searchInput.value.trim()) {
        if (resultsList) {
          resultsList.empty();
          resultsList.remove();
          resultsList = null;
        }
        if (searchTimeout) {
          window.clearTimeout(searchTimeout);
          searchTimeout = null;
        }
        return;
      }
      if (searchTimeout)
        window.clearTimeout(searchTimeout);
      searchTimeout = window.setTimeout(runSearch, 350);
    });
    yearInput.addEventListener("input", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
    typeSelect.addEventListener("change", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
  }
  renderMovies(container) {
    container.empty();
    if (!this.data) {
      container.createEl("p", { text: "No library loaded." });
      return;
    }
    const watched = this.data.movies.filter((movie) => movie.watched);
    const toWatch = this.data.movies.filter((movie) => !movie.watched);
    const tabsContainer = container.createDiv({ cls: "obs-plugin-boxoffice-tabs-container" });
    const tabHeader = tabsContainer.createDiv({ cls: "obs-plugin-boxoffice-tab-header" });
    const tabButtons = tabHeader.createDiv({ cls: "obs-plugin-boxoffice-tab-buttons" });
    const viewToggle = tabHeader.createDiv({ cls: "obs-plugin-boxoffice-view-toggle" });
    const toWatchButton = tabButtons.createEl("button", {
      cls: "obs-plugin-boxoffice-tab-button",
      text: `To Watch (${toWatch.length})`
    });
    const watchedButton = tabButtons.createEl("button", {
      cls: "obs-plugin-boxoffice-tab-button",
      text: `Watched (${watched.length})`
    });
    const gridButton = viewToggle.createEl("button", {
      cls: "obs-plugin-boxoffice-view-button",
      attr: { "aria-label": "Grid view", title: "Grid view" }
    });
    const listButton = viewToggle.createEl("button", {
      cls: "obs-plugin-boxoffice-view-button",
      attr: { "aria-label": "List view", title: "List view" }
    });
    (0, import_obsidian5.setIcon)(gridButton, "layout-grid");
    (0, import_obsidian5.setIcon)(listButton, "list");
    if (this.activeTab === "toWatch") {
      toWatchButton.classList.add("obs-plugin-boxoffice-tab-button-active");
    } else {
      watchedButton.classList.add("obs-plugin-boxoffice-tab-button-active");
    }
    if (this.viewMode === "grid") {
      gridButton.classList.add("obs-plugin-boxoffice-view-button-active");
    } else {
      listButton.classList.add("obs-plugin-boxoffice-view-button-active");
    }
    const searchInternalContainer = tabsContainer.createDiv({ cls: "obs-plugin-boxoffice-search" });
    const searchInputsGroup = searchInternalContainer.createDiv({ cls: "obs-plugin-boxoffice-search-inputs-group" });
    const searchInputContainer = searchInputsGroup.createDiv({ cls: "obs-plugin-boxoffice-search-input-container" });
    const searchInput = searchInputContainer.createEl("input", {
      cls: "obs-plugin-boxoffice-search-input",
      attr: {
        placeholder: "Internal search"
      }
    });
    searchInput.addEventListener("input", () => {
      var _a;
      const query = searchInput.value.trim().toLowerCase();
      const filteredMovies = ((_a = this.data) == null ? void 0 : _a.movies) ? this.data.movies.filter((movie) => {
        if (this.activeTab === "toWatch" && !movie.watched) {
          return movie.title.toLowerCase().includes(query);
        }
        if (this.activeTab === "watched" && movie.watched) {
          return movie.title.toLowerCase().includes(query);
        }
        return false;
      }) : [];
      tabContent.empty();
      this.renderMovieSection(tabContent, filteredMovies);
      return;
    });
    const tabContent = tabsContainer.createDiv({ cls: "obs-plugin-boxoffice-tab-content" });
    const activeMovies = this.activeTab === "toWatch" ? toWatch : watched;
    this.renderMovieSection(tabContent, activeMovies);
    toWatchButton.addEventListener("click", () => {
      if (this.activeTab === "toWatch")
        return;
      this.activeTab = "toWatch";
      this.renderMovies(container);
    });
    watchedButton.addEventListener("click", () => {
      if (this.activeTab === "watched")
        return;
      this.activeTab = "watched";
      this.renderMovies(container);
    });
    gridButton.addEventListener("click", async () => {
      if (this.viewMode === "grid")
        return;
      this.viewMode = "grid";
      await this.plugin.setViewMode("grid");
      this.renderMovies(container);
    });
    listButton.addEventListener("click", async () => {
      if (this.viewMode === "list")
        return;
      this.viewMode = "list";
      await this.plugin.setViewMode("list");
      this.renderMovies(container);
    });
  }
  renderMovieSection(container, movies) {
    const section = container.createDiv({ cls: "obs-plugin-boxoffice-section" });
    if (movies.length === 0) {
      section.createEl("p", { text: "No movies in this list." });
      return;
    }
    const list = section.createDiv({
      cls: this.viewMode === "grid" ? "obs-plugin-boxoffice-movie-grid" : "obs-plugin-boxoffice-movie-list"
    });
    if (this.viewMode === "grid") {
      this.renderMovieGrid(list, movies);
    } else {
      this.renderMovieList(list, movies);
    }
  }
  renderMovieGrid(container, movies) {
    movies.forEach((movie) => {
      const card = container.createDiv({ cls: "obs-plugin-boxoffice-movie-card" });
      card.createEl("img", { cls: "obs-plugin-boxoffice-movie-poster" }).setAttribute("src", movie.poster);
      card.createEl("div", { text: movie.title, cls: "obs-plugin-boxoffice-movie-title" });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year)
        detailsParts.push(year);
      if (type)
        detailsParts.push(type);
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        card.createEl("div", { text: detailsText, cls: "obs-plugin-boxoffice-movie-year" });
      }
      if (movie.watched) {
        createStarRating(card, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(card, movie.ratings);
        }
      }
      card.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  renderMovieList(container, movies) {
    movies.forEach((movie) => {
      const row = container.createDiv({
        cls: "obs-plugin-boxoffice-movie-row"
      });
      const poster = row.createEl("img", {
        cls: "obs-plugin-boxoffice-movie-thumbnail"
      });
      poster.setAttribute("src", movie.poster || "");
      const info = row.createDiv({
        cls: "obs-plugin-boxoffice-movie-info"
      });
      info.createEl("div", {
        text: movie.title,
        cls: "obs-plugin-boxoffice-movie-title"
      });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year) {
        detailsParts.push(year);
      }
      ;
      if (type) {
        detailsParts.push(type);
      }
      ;
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        info.createEl("div", {
          text: detailsText,
          cls: "obs-plugin-boxoffice-movie-year"
        });
      }
      if (movie.watched) {
        createStarRating(info, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(info, movie.ratings);
        }
      }
      row.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  openMovieDetails(movie) {
    new CineVaultMovieDetailModal(this.plugin.app, movie, async (rating) => {
      if (!this.data)
        return;
      movie.starRating = rating;
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      this.data.movies = this.data.movies.filter((item) => item.id !== movie.id);
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      movie.watched = !movie.watched;
      await this.saveData();
      this.refreshMovies();
    }).open();
  }
  refreshMovies() {
    if (!this.moviesContainer)
      return;
    this.renderMovies(this.moviesContainer);
  }
  getJsonFiles() {
    return this.plugin.app.vault.getFiles().filter((file) => file.extension === "json");
  }
  async initializeData() {
    const localPath = this.plugin.localJsonPath;
    if (localPath) {
      const localFile = this.plugin.app.vault.getAbstractFileByPath(localPath);
      if (localFile instanceof import_obsidian5.TFile) {
        await this.loadFile(localFile);
        return;
      }
    }
    this.file = null;
    this.data = null;
  }
  async loadFile(file) {
    try {
      const parsed = await loadLocalFile(this.plugin.app, file);
      this.file = file;
      this.data = parsed;
      await this.plugin.setLocalJsonPath(file.path);
    } catch (error) {
      this.data = null;
      this.file = null;
      new import_obsidian5.Notice("Unable to read the JSON file.");
    }
  }
  async saveData() {
    if (!this.data)
      return;
    this.data.updatedAt = new Date().toISOString();
    if (this.file) {
      await saveLocalData(this.plugin.app, this.file, this.data);
    }
  }
  async renderSearchResults(container, results) {
    container.empty();
    results.forEach((result) => {
      const item = container.createDiv({ cls: "obs-plugin-boxoffice-search-item" });
      if (result.poster) {
        item.createEl("img", { cls: "obs-plugin-boxoffice-search-poster" }).setAttribute("src", result.poster);
      }
      const info = item.createDiv({ cls: "obs-plugin-boxoffice-search-info" });
      info.createEl("div", { text: result.title, cls: "obs-plugin-boxoffice-search-title" });
      info.createEl("div", { text: result.year, cls: "obs-plugin-boxoffice-search-year" });
      item.addEventListener("click", () => {
        new CineVaultMovieActionModal(
          this.plugin.app,
          result,
          async (watched) => {
            if (!this.data)
              return;
            const existing = this.data.movies.find((movie) => movie.imdbId === result.imdbId);
            if (existing) {
              existing.watched = watched;
            } else {
              new import_obsidian5.Notice(`Loading details for ${result.title}...`);
              const details = await getOmdbDetails(result.imdbId, this.plugin.omdbApiKey);
              if (!details) {
                new import_obsidian5.Notice("Unable to load movie details.");
                return;
              }
              const newMovie = createEmptyMovie();
              newMovie.imdbId = details.imdbID || result.imdbId;
              newMovie.title = details.Title || result.title;
              newMovie.year = details.Year || result.year;
              newMovie.rated = details.Rated || "";
              newMovie.released = details.Released || "";
              newMovie.runtime = details.Runtime || "";
              newMovie.genre = details.Genre || "";
              newMovie.director = details.Director || "";
              newMovie.writer = details.Writer || "";
              newMovie.actors = details.Actors || "";
              newMovie.plot = details.Plot || result.plot;
              newMovie.language = details.Language || "";
              newMovie.country = details.Country || "";
              newMovie.awards = details.Awards || "";
              newMovie.poster = details.Poster && details.Poster !== "N/A" ? details.Poster : result.poster;
              newMovie.posterLocal = "";
              newMovie.ratings = details.Ratings || [];
              newMovie.metascore = details.Metascore || "";
              newMovie.imdbRating = details.imdbRating || "";
              newMovie.imdbVotes = details.imdbVotes || "";
              newMovie.type = details.Type || result.type;
              newMovie.dvd = details.DVD || "";
              newMovie.boxOffice = details.BoxOffice || "";
              newMovie.production = details.Production || "";
              newMovie.website = details.Website || "";
              newMovie.totalSeasons = details.totalSeasons || "";
              newMovie.watched = watched;
              this.data.movies.unshift(newMovie);
            }
            await this.saveData();
            this.render();
          }
        ).open();
      });
    });
  }
};

// src/settings/settingsTab.ts
var import_obsidian6 = require("obsidian");
var CineVaultSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian6.Setting(containerEl).setName("Configuration").setHeading();
    new import_obsidian6.Setting(containerEl).setName("OMDb API key").setDesc("Enter your OMDb API key. You can get one for free at omdbapi.com").addText((text) => text.setPlaceholder("Enter your API key").setValue(this.plugin.omdbApiKey).onChange(async (value) => {
      await this.plugin.setOmdbApiKey(value);
    }));
    new import_obsidian6.Setting(containerEl).setName("Library folder").setDesc("The folder where the plugin will store library files").addText((text) => text.setPlaceholder("Folder name").setValue(this.plugin.libraryFolder).onChange(async (value) => {
      const folder = value.trim() || "BoxOffice";
      await this.plugin.setLibraryFolder(folder);
    }));
    new import_obsidian6.Setting(containerEl).setName("Linked local library").setDesc(
      this.plugin.localJsonPath ? `Local file: ${this.plugin.localJsonPath}` : "No local library linked"
    ).addDropdown((drop) => {
      var _a;
      const files = this.app.vault.getFiles().filter((f) => f.extension === "json");
      const options = { "": "-- None --" };
      files.forEach((f) => options[f.path] = f.path);
      drop.addOptions(options).setValue((_a = this.plugin.localJsonPath) != null ? _a : "").onChange(async (value) => {
        const path = value || null;
        await this.plugin.setLocalJsonPath(path);
        await this.refreshOpenViews();
        this.display();
      });
    }).addButton((button) => button.setButtonText("Unlink local").setDisabled(!this.plugin.localJsonPath).onClick(async () => {
      await this.plugin.setLocalJsonPath(null);
      await this.refreshOpenViews();
      this.display();
    }));
    new import_obsidian6.Setting(containerEl).setName("Create new library").setDesc("Create a new empty local library from scratch. This will unlink any external library.").addButton((button) => button.setButtonText("Create library").onClick(async () => {
      await this.createNewLibrary();
    }));
    new import_obsidian6.Setting(containerEl).setName("Export library").setDesc("Save a copy of your library JSON to a file.").addButton((button) => button.setButtonText("Export JSON").onClick(async () => {
      await this.exportLibraryJson();
    }));
    new import_obsidian6.Setting(containerEl).setName("Bugfix").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Report issues").setDesc("If you encounter any issues with the plugin, please report them. Your feedback is invaluable for improving BoxOffice!").addButton((button) => button.setButtonText("GitHub").onClick(() => {
      window.open("https://github.com/vscaperrotta/obsidian-cinevault/issues", "_blank");
    }));
    new import_obsidian6.Setting(containerEl).setName("Support").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Donate").setDesc(
      "If you like this plugin, consider donating to support continued development."
    ).addButton((bt) => {
      bt.buttonEl.outerHTML = "<a href='https://ko-fi.com/T6T01TX807' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi6.png?v=6' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a>";
    });
  }
  async exportLibraryJson() {
    try {
      const content = await this.getLibraryJsonContent();
      if (!content) {
        new import_obsidian6.Notice("No library file found to export.");
        return;
      }
      const timestamp = new Date().toISOString().replace(/[:.]/g, "-").slice(0, 19);
      const exportPath = `boxoffice-export-${timestamp}.json`;
      let finalPath = exportPath;
      let counter = 1;
      while (this.app.vault.getAbstractFileByPath(finalPath)) {
        finalPath = `boxoffice-export-${timestamp}-${counter}.json`;
        counter++;
      }
      await this.app.vault.create(finalPath, content);
      new import_obsidian6.Notice(`Library exported to ${finalPath}`);
    } catch (error) {
      console.error("[BoxOffice] Export library error", error);
      new import_obsidian6.Notice("Unable to export the library.");
    }
  }
  async createNewLibrary() {
    const confirmed = window.confirm(
      "Create a new empty BoxOffice library? This will unlink any external library and reset your local library data."
    );
    if (!confirmed)
      return;
    try {
      const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
      let createdFile;
      if (defaultFile instanceof import_obsidian6.TFile) {
        await saveLocalData(this.app, defaultFile, createDefaultData());
        createdFile = defaultFile;
      } else {
        createdFile = await createJsonFile(this.app, this.plugin.libraryFolder);
      }
      if (createdFile) {
        await this.plugin.setLocalJsonPath(createdFile.path);
      }
      await this.refreshOpenViews();
      this.display();
      new import_obsidian6.Notice("New library created.");
    } catch (error) {
      console.error("[BoxOffice] Create new library error", error);
      new import_obsidian6.Notice("Unable to create a new library.");
    }
  }
  async getLibraryJsonContent() {
    if (this.plugin.localJsonPath) {
      const localPath = this.plugin.localJsonPath;
      const file = this.app.vault.getAbstractFileByPath(localPath);
      if (file instanceof import_obsidian6.TFile) {
        return this.app.vault.read(file);
      }
    }
    const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
    if (defaultFile instanceof import_obsidian6.TFile) {
      return this.app.vault.read(defaultFile);
    }
    const folder = getFolder(this.plugin.libraryFolder);
    const fallback = this.app.vault.getFiles().find((file) => file.extension === "json" && file.path.startsWith(`${folder}/`));
    if (fallback) {
      return this.app.vault.read(fallback);
    }
    return null;
  }
  async refreshOpenViews() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    for (const leaf of leaves) {
      if (leaf.view instanceof PluginViewView) {
        await leaf.view.onOpen();
      }
    }
  }
};

// src/main.ts
var CineVaultPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.localJsonPath = null;
    this.omdbApiKey = "";
    this.viewMode = "grid";
    this.libraryFolder = FOLDER;
  }
  // Load plugin data and register views/settings when the plugin is loaded
  async onload() {
    await this.loadPluginData();
    this.addSettingTab(new CineVaultSettingTab(this.app, this));
    this.registerView(
      VIEW_TYPE,
      (leaf) => new PluginViewView(leaf, this)
    );
    this.addRibbonIcon("clapperboard", "BoxOffice", async () => {
      await this.openNewTab();
    });
  }
  // Unmount the status bar element when the plugin is disabled
  onunload() {
  }
  async loadPluginData() {
    var _a, _b, _c, _d;
    const data = await this.loadData();
    this.localJsonPath = (_a = data == null ? void 0 : data.localJsonPath) != null ? _a : null;
    this.omdbApiKey = (_b = data == null ? void 0 : data.omdbApiKey) != null ? _b : "";
    this.viewMode = (_c = data == null ? void 0 : data.viewMode) != null ? _c : "grid";
    this.libraryFolder = (_d = data == null ? void 0 : data.libraryFolder) != null ? _d : FOLDER;
  }
  async setOmdbApiKey(apiKey) {
    this.omdbApiKey = apiKey;
    await this.savePluginData();
  }
  async setViewMode(viewMode) {
    this.viewMode = viewMode;
    await this.savePluginData();
  }
  async savePluginData() {
    const data = {
      omdbApiKey: this.omdbApiKey,
      viewMode: this.viewMode,
      libraryFolder: this.libraryFolder
    };
    if (this.localJsonPath) {
      data.localJsonPath = this.localJsonPath;
    }
    await this.saveData(data);
  }
  async setLocalJsonPath(path) {
    this.localJsonPath = path;
    await this.savePluginData();
  }
  async setLibraryFolder(folder) {
    this.libraryFolder = folder;
    await this.savePluginData();
  }
  // Open a new tab with the "BoxOffice" view type
  async openNewTab() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: VIEW_TYPE,
      active: true
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbnN0YW50cy50cyIsICJzcmMvdmlld3MvUGx1Z2luVmlldy50cyIsICJzcmMvdWkvb25ib2FyZGluZy50cyIsICJzcmMvdWkvbW9kYWxzL2FjdGlvbk1vZGFsLnRzIiwgInNyYy91dGlscy9oZWxwZXJzLnRzIiwgInNyYy91aS9tb2RhbHMvZGV0YWlsTW9kYWwudHMiLCAic3JjL3VpL3N0YXJSYXRpbmcudHMiLCAic3JjL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9zZXJ2aWNlcy9saWJyYXJ5U3RvcmFnZS50cyIsICJzcmMvc2VydmljZXMvb21kYlNlcnZpY2UudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZJRVdfVFlQRSwgRk9MREVSIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgUGx1Z2luVmlldyBmcm9tIFwiLi92aWV3cy9QbHVnaW5WaWV3XCI7XG5pbXBvcnQgQ2luZVZhdWx0U2V0dGluZ1RhYiBmcm9tIFwiLi9zZXR0aW5ncy9zZXR0aW5nc1RhYlwiO1xuXG50eXBlIENpbmVWYXVsdFBsdWdpbkRhdGEgPSB7XG5cdGxvY2FsSnNvblBhdGg/OiBzdHJpbmc7XG5cdG9tZGJBcGlLZXk/OiBzdHJpbmc7XG5cdHZpZXdNb2RlPzogXCJncmlkXCIgfCBcImxpc3RcIjtcblx0bGlicmFyeUZvbGRlcj86IHN0cmluZztcblx0b3Blbj86IGJvb2xlYW47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRsb2NhbEpzb25QYXRoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0b21kYkFwaUtleTogc3RyaW5nID0gXCJcIjtcblx0dmlld01vZGU6IFwiZ3JpZFwiIHwgXCJsaXN0XCIgPSBcImdyaWRcIjtcblx0bGlicmFyeUZvbGRlcjogc3RyaW5nID0gRk9MREVSO1xuXG5cdC8vIExvYWQgcGx1Z2luIGRhdGEgYW5kIHJlZ2lzdGVyIHZpZXdzL3NldHRpbmdzIHdoZW4gdGhlIHBsdWdpbiBpcyBsb2FkZWRcblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFBsdWdpbkRhdGEoKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQ2luZVZhdWx0U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0dGhpcy5yZWdpc3RlclZpZXcoXG5cdFx0XHRWSUVXX1RZUEUsXG5cdFx0XHQobGVhZikgPT4gbmV3IFBsdWdpblZpZXcobGVhZiwgdGhpcylcblx0XHQpO1xuXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKFwiY2xhcHBlcmJvYXJkXCIsIFwiQm94T2ZmaWNlXCIsIGFzeW5jICgpID0+IHtcblx0XHRcdGF3YWl0IHRoaXMub3Blbk5ld1RhYigpO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly8gVW5tb3VudCB0aGUgc3RhdHVzIGJhciBlbGVtZW50IHdoZW4gdGhlIHBsdWdpbiBpcyBkaXNhYmxlZFxuXHRvbnVubG9hZCgpIHtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgbG9hZFBsdWdpbkRhdGEoKSB7XG5cdFx0Y29uc3QgZGF0YSA9IChhd2FpdCB0aGlzLmxvYWREYXRhKCkpIGFzIENpbmVWYXVsdFBsdWdpbkRhdGEgfCBudWxsO1xuXHRcdHRoaXMubG9jYWxKc29uUGF0aCA9IGRhdGE/LmxvY2FsSnNvblBhdGggPz8gbnVsbDtcblx0XHR0aGlzLm9tZGJBcGlLZXkgPSBkYXRhPy5vbWRiQXBpS2V5ID8/IFwiXCI7XG5cdFx0dGhpcy52aWV3TW9kZSA9IGRhdGE/LnZpZXdNb2RlID8/IFwiZ3JpZFwiO1xuXHRcdHRoaXMubGlicmFyeUZvbGRlciA9IGRhdGE/LmxpYnJhcnlGb2xkZXIgPz8gRk9MREVSO1xuXHR9XG5cblx0YXN5bmMgc2V0T21kYkFwaUtleShhcGlLZXk6IHN0cmluZykge1xuXHRcdHRoaXMub21kYkFwaUtleSA9IGFwaUtleTtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRhc3luYyBzZXRWaWV3TW9kZSh2aWV3TW9kZTogXCJncmlkXCIgfCBcImxpc3RcIikge1xuXHRcdHRoaXMudmlld01vZGUgPSB2aWV3TW9kZTtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHNhdmVQbHVnaW5EYXRhKCkge1xuXHRcdGNvbnN0IGRhdGE6IENpbmVWYXVsdFBsdWdpbkRhdGEgPSB7XG5cdFx0XHRvbWRiQXBpS2V5OiB0aGlzLm9tZGJBcGlLZXksXG5cdFx0XHR2aWV3TW9kZTogdGhpcy52aWV3TW9kZSxcblx0XHRcdGxpYnJhcnlGb2xkZXI6IHRoaXMubGlicmFyeUZvbGRlclxuXHRcdH07XG5cdFx0aWYgKHRoaXMubG9jYWxKc29uUGF0aCkge1xuXHRcdFx0ZGF0YS5sb2NhbEpzb25QYXRoID0gdGhpcy5sb2NhbEpzb25QYXRoO1xuXHRcdH1cblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKGRhdGEpO1xuXHR9XG5cblx0YXN5bmMgc2V0TG9jYWxKc29uUGF0aChwYXRoOiBzdHJpbmcgfCBudWxsKSB7XG5cdFx0dGhpcy5sb2NhbEpzb25QYXRoID0gcGF0aDtcblx0XHRhd2FpdCB0aGlzLnNhdmVQbHVnaW5EYXRhKCk7XG5cdH1cblxuXHRhc3luYyBzZXRMaWJyYXJ5Rm9sZGVyKGZvbGRlcjogc3RyaW5nKSB7XG5cdFx0dGhpcy5saWJyYXJ5Rm9sZGVyID0gZm9sZGVyO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdC8vIE9wZW4gYSBuZXcgdGFiIHdpdGggdGhlIFwiQm94T2ZmaWNlXCIgdmlldyB0eXBlXG5cdHByaXZhdGUgYXN5bmMgb3Blbk5ld1RhYigpIHtcblx0XHRjb25zdCBleGlzdGluZ0xlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFKTtcblx0XHRpZiAoZXhpc3RpbmdMZWF2ZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYoZXhpc3RpbmdMZWF2ZXNbMF0pO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcblx0XHRhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XG5cdFx0XHR0eXBlOiBWSUVXX1RZUEUsXG5cdFx0XHRhY3RpdmU6IHRydWVcblx0XHR9KTtcblx0fVxufSIsICJleHBvcnQgY29uc3QgTkFNRSA9IFwiQm94T2ZmaWNlXCI7XG5leHBvcnQgY29uc3QgVklFV19UWVBFID0gXCJCb3hPZmZpY2VWaWV3XCI7XG5leHBvcnQgY29uc3QgRk9MREVSID0gXCJCb3hPZmZpY2VcIjtcbmV4cG9ydCBjb25zdCBPTURCX1RZUEVTID0gW1wibW92aWVcIiwgXCJzZXJpZXNcIiwgXCJlcGlzb2RlXCJdIGFzIGNvbnN0O1xuZXhwb3J0IGNvbnN0IE9NREJfVVJMID0gXCJodHRwczovL3d3dy5vbWRiYXBpLmNvbVwiOyIsICJpbXBvcnQgeyBJdGVtVmlldywgV29ya3NwYWNlTGVhZiwgVEZpbGUsIE5vdGljZSwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IENpbmVWYXVsdFBsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuaW1wb3J0IHsgVklFV19UWVBFLCBPTURCX1RZUEVTIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHR5cGUgeyBDaW5lVmF1bHREYXRhLCBDaW5lVmF1bHRNb3ZpZSB9IGZyb20gXCIuLi90eXBlcy9jaW5ldmF1bHRcIjtcbmltcG9ydCB7IHJlbmRlck9uYm9hcmRpbmcgfSBmcm9tIFwiLi4vdWkvb25ib2FyZGluZ1wiO1xuaW1wb3J0IHsgQ2luZVZhdWx0TW92aWVBY3Rpb25Nb2RhbCB9IGZyb20gXCIuLi91aS9tb2RhbHMvYWN0aW9uTW9kYWxcIjtcbmltcG9ydCB7IENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwgfSBmcm9tIFwiLi4vdWkvbW9kYWxzL2RldGFpbE1vZGFsXCI7XG5pbXBvcnQgeyBKc29uRmlsZVN1Z2dlc3RNb2RhbCB9IGZyb20gXCIuLi91aS9Kc29uRmlsZVN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHtcbiAgY3JlYXRlRW1wdHlNb3ZpZSxcbiAgY3JlYXRlSnNvbkZpbGUsXG4gIGxvYWRMb2NhbEZpbGUsXG4gIHNhdmVMb2NhbERhdGFcbn0gZnJvbSBcIi4uL3NlcnZpY2VzL2xpYnJhcnlTdG9yYWdlXCI7XG5pbXBvcnQgeyBzZWFyY2hPbWRiLCBnZXRPbWRiRGV0YWlscyB9IGZyb20gXCIuLi9zZXJ2aWNlcy9vbWRiU2VydmljZVwiO1xuaW1wb3J0IHsgY3JlYXRlU3RhclJhdGluZyB9IGZyb20gXCIuLi91aS9zdGFyUmF0aW5nXCI7XG5pbXBvcnQgeyBudWxsU2FmZSwgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIgfSBmcm9tIFwic3JjL3V0aWxzL2hlbHBlcnNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGx1Z2luVmlld1ZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cbiAgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW47XG4gIGZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG4gIGRhdGE6IENpbmVWYXVsdERhdGEgfCBudWxsID0gbnVsbDtcbiAgYWN0aXZlVGFiOiBcInRvV2F0Y2hcIiB8IFwid2F0Y2hlZFwiID0gXCJ0b1dhdGNoXCI7XG4gIG1vdmllc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcbiAgdmlld01vZGU6IFwiZ3JpZFwiIHwgXCJsaXN0XCIgPSBcImdyaWRcIjtcblxuICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IENpbmVWYXVsdFBsdWdpbikge1xuICAgIHN1cGVyKGxlYWYpO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG5cbiAgZ2V0Vmlld1R5cGUoKSB7XG4gICAgcmV0dXJuIFZJRVdfVFlQRTtcbiAgfVxuXG4gIGdldERpc3BsYXlUZXh0KCkge1xuICAgIHJldHVybiBcIkJveE9mZmljZVwiO1xuICB9XG5cbiAgLy8gUHJvdmlkZSBhIGN1c3RvbSBpY29uIGZvciB0aGUgdmlldydzIHRhYlxuICBnZXRJY29uKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIFwiY2xhcHBlcmJvYXJkXCI7XG4gIH1cblxuICBhc3luYyBvbk9wZW4oKSB7XG4gICAgdGhpcy52aWV3TW9kZSA9IHRoaXMucGx1Z2luLnZpZXdNb2RlID8/IFwiZ3JpZFwiO1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZURhdGEoKTtcbiAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXIoKSB7XG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIGNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtaGVhZGVyXCIgfSk7XG4gICAgaGVhZGVyLmNyZWF0ZUVsKFwiaDFcIiwge1xuICAgICAgdGV4dDogXCJCb3hPZmZpY2VcIixcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS10aXRsZVwiXG4gICAgfSk7XG5cbiAgICBoZWFkZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiVGhpcyBwbHVnaW4gYWxsb3cgeW91IHRvIG1hbmFnZSB5b3VyIGZhdm9yaXRlcyBtb3ZpZSBhbmQgdHYgbGlicmFyeSBpbnRvIHlvdXIgdmF1bHQuXFxuU2VhcmNoIE9NRGIsIHJhdGUgdGl0bGVzLCBhbmQgc3RvcmUgeW91ciBjb2xsZWN0aW9uIGluIGEganNvbiBmaWxlIHdpdGhpbiB5b3VyIHZhdWx0IG9yIGluIGEgc2VwYXJhdGUgdmF1bHQuXCIsXG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtaGVhZGVyLXRleHRcIlxuICAgIH0pO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEpIHtcbiAgICAgIHJlbmRlck9uYm9hcmRpbmcoY29udGFpbmVyLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMuZmlsZSA9IGF3YWl0IGNyZWF0ZUpzb25GaWxlKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcik7XG4gICAgICAgIGlmICh0aGlzLmZpbGUpIHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKHRoaXMuZmlsZS5wYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRGaWxlKHRoaXMuZmlsZSk7XG4gICAgICAgIGF3YWl0IHRoaXMucmVuZGVyKCk7XG4gICAgICB9LCAoKSA9PiB7XG4gICAgICAgIC8vIE9wZW4gbW9kYWwgdG8gc2VsZWN0IEpTT04gZmlsZSBmcm9tIHZhdWx0XG4gICAgICAgIG5ldyBKc29uRmlsZVN1Z2dlc3RNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRmlsZShmaWxlKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KS5vcGVuKCk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZWFyY2ggYXJlYVxuICAgIGNvbnN0IHNlYXJjaEJveCA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoXCIgfSk7XG5cbiAgICBjb25zdCBzZWFyY2hJbnB1dHNHcm91cCA9IHNlYXJjaEJveC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0cy1ncm91cFwiIH0pO1xuXG4gICAgLy8gU2VhcmNoIHRpdGxlXG4gICAgY29uc3Qgc2VhcmNoSW5wdXRDb250YWluZXIgPSBzZWFyY2hJbnB1dHNHcm91cC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0LWNvbnRhaW5lclwiIH0pO1xuICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoSW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0XCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIlNlYXJjaFwiXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBmaWx0ZXJTd2l0Y2ggPSBzZWFyY2hJbnB1dENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWNsZWFyXCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIFwiYXJpYS1sYWJlbFwiOiBcIk1vcmUgZmlsdGVyXCIsXG4gICAgICAgIHRpdGxlOiBcIk1vcmUgZmlsdGVyXCJcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgc2V0SWNvbihmaWx0ZXJTd2l0Y2gsIFwic2xpZGVycy1ob3Jpem9udGFsXCIpO1xuXG4gICAgY29uc3QgbW9yZUZpbHRlckNvbnRhaW5lciA9IHNlYXJjaElucHV0c0dyb3VwLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb3JlLWZpbHRlclwiIH0pO1xuXG4gICAgbW9yZUZpbHRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICBmaWx0ZXJTd2l0Y2guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmIChtb3JlRmlsdGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiKSB7XG4gICAgICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbW9yZUZpbHRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBZZWFyIGZpbHRlclxuICAgIGNvbnN0IHllYXJJbnB1dCA9IG1vcmVGaWx0ZXJDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0XCIsXG4gICAgICBhdHRyOiB7IHBsYWNlaG9sZGVyOiBcIlllYXJcIiB9XG4gICAgfSk7XG5cbiAgICAvLyBUeXBlIGZpbHRlclxuICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBtb3JlRmlsdGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwic2VsZWN0XCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXNlYXJjaC1zZWxlY3RcIiB9KTtcbiAgICB0eXBlU2VsZWN0LmNyZWF0ZUVsKFwib3B0aW9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQWxsXCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJUeXBlXCJcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIE9NREJfVFlQRVMuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgdHlwZVNlbGVjdC5jcmVhdGVFbChcIm9wdGlvblwiLCB7XG4gICAgICAgIHRleHQ6IHRbMF0udG9VcHBlckNhc2UoKSArIHQuc2xpY2UoMSksXG4gICAgICAgIGF0dHI6IHsgdmFsdWU6IHQgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDb250YWluZXIgZm9yIHNlYXJjaCByZXN1bHRzLCBjcmVhdGVkIG9uIGRlbWFuZFxuICAgIGxldCByZXN1bHRzTGlzdDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLWNvbnRlbnRcIiB9KTtcbiAgICB0aGlzLm1vdmllc0NvbnRhaW5lciA9IGNvbnRlbnQ7XG5cbiAgICB0aGlzLnJlbmRlck1vdmllcyhjb250ZW50KTtcblxuICAgIGxldCBzZWFyY2hUaW1lb3V0OiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgICBjb25zdCBydW5TZWFyY2ggPSBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBxdWVyeSA9IHNlYXJjaElucHV0LnZhbHVlLnRyaW0oKTtcbiAgICAgIGlmICghcXVlcnkpIHJldHVybjtcbiAgICAgIGNvbnN0IHR5cGUgPSB0eXBlU2VsZWN0LnZhbHVlIHx8IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHllYXIgPSB5ZWFySW5wdXQudmFsdWUudHJpbSgpIHx8IHVuZGVmaW5lZDtcblxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNlYXJjaE9tZGIocXVlcnksIHRoaXMucGx1Z2luLm9tZGJBcGlLZXksIHR5cGUsIHllYXIpO1xuXG4gICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKVxuXG4gICAgICBpZiAoIXJlc3VsdHMgfHwgcmVzdWx0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgaWYgKCFyZXN1bHRzTGlzdCkgcmVzdWx0c0xpc3QgPSBzZWFyY2hCb3guY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXNlYXJjaC1yZXN1bHRzXCIgfSk7XG4gICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG4gICAgICAgIHJlc3VsdHNMaXN0LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJObyByZXN1bHRzIGZvdW5kLlwiLCBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWVtcHR5XCIgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXN1bHRzTGlzdCkgcmVzdWx0c0xpc3QgPSBzZWFyY2hCb3guY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXNlYXJjaC1yZXN1bHRzXCIgfSk7XG4gICAgICBhd2FpdCB0aGlzLnJlbmRlclNlYXJjaFJlc3VsdHMocmVzdWx0c0xpc3QsIHJlc3VsdHMpO1xuICAgIH07XG5cbiAgICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgaWYgKCFzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkpIHtcbiAgICAgICAgaWYgKHJlc3VsdHNMaXN0KSB7XG4gICAgICAgICAgcmVzdWx0c0xpc3QuZW1wdHkoKTtcbiAgICAgICAgICByZXN1bHRzTGlzdC5yZW1vdmUoKTtcbiAgICAgICAgICByZXN1bHRzTGlzdCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlYXJjaFRpbWVvdXQpIHtcbiAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpO1xuICAgICAgICAgIHNlYXJjaFRpbWVvdXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHNlYXJjaFRpbWVvdXQpIHdpbmRvdy5jbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7XG4gICAgICBzZWFyY2hUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQocnVuU2VhcmNoLCAzNTApO1xuICAgIH0pO1xuXG4gICAgeWVhcklucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXNlYXJjaElucHV0LnZhbHVlLnRyaW0oKSkgcmV0dXJuO1xuICAgICAgYXdhaXQgcnVuU2VhcmNoKCk7XG4gICAgfSk7XG5cbiAgICB0eXBlU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkpIHJldHVybjtcbiAgICAgIGF3YWl0IHJ1blNlYXJjaCgpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZXMoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEpIHtcbiAgICAgIGNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIk5vIGxpYnJhcnkgbG9hZGVkLlwiIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHdhdGNoZWQgPSB0aGlzLmRhdGEubW92aWVzLmZpbHRlcigobW92aWUpID0+IG1vdmllLndhdGNoZWQpO1xuICAgIGNvbnN0IHRvV2F0Y2ggPSB0aGlzLmRhdGEubW92aWVzLmZpbHRlcigobW92aWUpID0+ICFtb3ZpZS53YXRjaGVkKTtcblxuICAgIGNvbnN0IHRhYnNDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXRhYnMtY29udGFpbmVyXCIgfSk7XG4gICAgY29uc3QgdGFiSGVhZGVyID0gdGFic0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtdGFiLWhlYWRlclwiIH0pO1xuXG4gICAgY29uc3QgdGFiQnV0dG9ucyA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtdGFiLWJ1dHRvbnNcIiB9KTtcbiAgICBjb25zdCB2aWV3VG9nZ2xlID0gdGFiSGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS12aWV3LXRvZ2dsZVwiIH0pO1xuXG4gICAgY29uc3QgdG9XYXRjaEJ1dHRvbiA9IHRhYkJ1dHRvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXRhYi1idXR0b25cIixcbiAgICAgIHRleHQ6IGBUbyBXYXRjaCAoJHt0b1dhdGNoLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3Qgd2F0Y2hlZEJ1dHRvbiA9IHRhYkJ1dHRvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXRhYi1idXR0b25cIixcbiAgICAgIHRleHQ6IGBXYXRjaGVkICgke3dhdGNoZWQubGVuZ3RofSlgXG4gICAgfSk7XG5cbiAgICBjb25zdCBncmlkQnV0dG9uID0gdmlld1RvZ2dsZS5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utdmlldy1idXR0b25cIixcbiAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiR3JpZCB2aWV3XCIsIHRpdGxlOiBcIkdyaWQgdmlld1wiIH1cbiAgICB9KTtcbiAgICBjb25zdCBsaXN0QnV0dG9uID0gdmlld1RvZ2dsZS5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utdmlldy1idXR0b25cIixcbiAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTGlzdCB2aWV3XCIsIHRpdGxlOiBcIkxpc3Qgdmlld1wiIH1cbiAgICB9KTtcblxuICAgIHNldEljb24oZ3JpZEJ1dHRvbiwgXCJsYXlvdXQtZ3JpZFwiKTtcbiAgICBzZXRJY29uKGxpc3RCdXR0b24sIFwibGlzdFwiKTtcblxuICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHtcbiAgICAgIHRvV2F0Y2hCdXR0b24uY2xhc3NMaXN0LmFkZChcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXRhYi1idXR0b24tYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3YXRjaGVkQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJvYnMtcGx1Z2luLWJveG9mZmljZS10YWItYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHtcbiAgICAgIGdyaWRCdXR0b24uY2xhc3NMaXN0LmFkZChcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utdmlldy1idXR0b24tYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIC8vIFNlYXJjaCBpbnRlcm5hbCB0byBzZWN0aW9uIChmb3IgZnV0dXJlIGltcGxlbWVudGF0aW9uLCBjdXJyZW50bHkgbm9uLWZ1bmN0aW9uYWwpXG4gICAgY29uc3Qgc2VhcmNoSW50ZXJuYWxDb250YWluZXIgPSB0YWJzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1zZWFyY2hcIiB9KTtcbiAgICBjb25zdCBzZWFyY2hJbnB1dHNHcm91cCA9IHNlYXJjaEludGVybmFsQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1zZWFyY2gtaW5wdXRzLWdyb3VwXCIgfSk7XG4gICAgY29uc3Qgc2VhcmNoSW5wdXRDb250YWluZXIgPSBzZWFyY2hJbnB1dHNHcm91cC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0LWNvbnRhaW5lclwiIH0pO1xuICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoSW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWlucHV0XCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHBsYWNlaG9sZGVyOiBcIkludGVybmFsIHNlYXJjaFwiXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgIGNvbnN0IGZpbHRlcmVkTW92aWVzID0gdGhpcy5kYXRhPy5tb3ZpZXMgPyB0aGlzLmRhdGEubW92aWVzLmZpbHRlcigobW92aWUpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcInRvV2F0Y2hcIiAmJiAhbW92aWUud2F0Y2hlZCkge1xuICAgICAgICAgIHJldHVybiBtb3ZpZS50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5KVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcIndhdGNoZWRcIiAmJiBtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgICAgcmV0dXJuIG1vdmllLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSkgOiBbXTtcblxuICAgICAgdGFiQ29udGVudC5lbXB0eSgpO1xuXG4gICAgICB0aGlzLnJlbmRlck1vdmllU2VjdGlvbih0YWJDb250ZW50LCBmaWx0ZXJlZE1vdmllcyk7XG4gICAgICByZXR1cm47XG4gICAgfSk7XG5cbiAgICAvLyBJbml0aWFsbHkgcmVuZGVyIHRoZSBhY3RpdmUgdGFiXG4gICAgY29uc3QgdGFiQ29udGVudCA9IHRhYnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXRhYi1jb250ZW50XCIgfSk7XG4gICAgY29uc3QgYWN0aXZlTW92aWVzID0gdGhpcy5hY3RpdmVUYWIgPT09IFwidG9XYXRjaFwiID8gdG9XYXRjaCA6IHdhdGNoZWQ7XG4gICAgdGhpcy5yZW5kZXJNb3ZpZVNlY3Rpb24odGFiQ29udGVudCwgYWN0aXZlTW92aWVzKTtcblxuICAgIHRvV2F0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHJldHVybjtcbiAgICAgIHRoaXMuYWN0aXZlVGFiID0gXCJ0b1dhdGNoXCI7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuXG4gICAgd2F0Y2hlZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcIndhdGNoZWRcIikgcmV0dXJuO1xuICAgICAgdGhpcy5hY3RpdmVUYWIgPSBcIndhdGNoZWRcIjtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBncmlkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImdyaWRcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwiZ3JpZFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBsaXN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJsaXN0XCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImxpc3RcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwibGlzdFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vdmllU2VjdGlvbihjb250YWluZXI6IEhUTUxFbGVtZW50LCBtb3ZpZXM6IENpbmVWYXVsdE1vdmllW10pIHtcbiAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1zZWN0aW9uXCIgfSk7XG5cbiAgICBpZiAobW92aWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2VjdGlvbi5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIk5vIG1vdmllcyBpbiB0aGlzIGxpc3QuXCIgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgbGlzdCA9IHNlY3Rpb24uY3JlYXRlRGl2KHtcbiAgICAgIGNsczogdGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIgPyBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vdmllLWdyaWRcIiA6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW92aWUtbGlzdFwiXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVHcmlkKGxpc3QsIG1vdmllcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVMaXN0KGxpc3QsIG1vdmllcyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZUdyaWQoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgbW92aWVzLmZvckVhY2goKG1vdmllKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb3ZpZS1jYXJkXCIgfSk7XG4gICAgICBjYXJkLmNyZWF0ZUVsKFwiaW1nXCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vdmllLXBvc3RlclwiIH0pLnNldEF0dHJpYnV0ZShcInNyY1wiLCBtb3ZpZS5wb3N0ZXIpO1xuICAgICAgY2FyZC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IG1vdmllLnRpdGxlLCBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW92aWUtdGl0bGVcIiB9KTtcblxuICAgICAgLy8gQnVpbGQgdGhlIGRldGFpbHMgc3RyaW5nIGNvbmRpdGlvbmFsbHksIG9ubHkgaW5jbHVkaW5nIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcbiAgICAgIGNvbnN0IGRldGFpbHNQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS55ZWFyLCBudWxsKTtcbiAgICAgIGNvbnN0IHR5cGUgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyBtb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcblxuICAgICAgaWYgKHllYXIpIGRldGFpbHNQYXJ0cy5wdXNoKHllYXIpO1xuICAgICAgaWYgKHR5cGUpIGRldGFpbHNQYXJ0cy5wdXNoKHR5cGUpO1xuXG4gICAgICBjb25zdCBkZXRhaWxzVGV4dCA9IGRldGFpbHNQYXJ0cy5qb2luKFwiIC0gXCIpO1xuICAgICAgaWYgKGRldGFpbHNUZXh0KSB7XG4gICAgICAgIGNhcmQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBkZXRhaWxzVGV4dCwgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vdmllLXllYXJcIiB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vdmllLndhdGNoZWQpIHtcbiAgICAgICAgY3JlYXRlU3RhclJhdGluZyhjYXJkLCBtb3ZpZS5zdGFyUmF0aW5nLCB0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChtb3ZpZS5yYXRpbmdzICYmIG1vdmllLnJhdGluZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIoY2FyZCwgbW92aWUucmF0aW5ncyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTW92aWVEZXRhaWxzKG1vdmllKSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vdmllTGlzdChjb250YWluZXI6IEhUTUxFbGVtZW50LCBtb3ZpZXM6IENpbmVWYXVsdE1vdmllW10pIHtcbiAgICBtb3ZpZXMuZm9yRWFjaCgobW92aWUpID0+IHtcbiAgICAgIGNvbnN0IHJvdyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW92aWUtcm93XCJcbiAgICAgIH0pO1xuICAgICAgY29uc3QgcG9zdGVyID0gcm93LmNyZWF0ZUVsKFwiaW1nXCIsIHtcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vdmllLXRodW1ibmFpbFwiXG4gICAgICB9KTtcbiAgICAgIHBvc3Rlci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbW92aWUucG9zdGVyIHx8IFwiXCIpO1xuXG4gICAgICBjb25zdCBpbmZvID0gcm93LmNyZWF0ZURpdih7XG4gICAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb3ZpZS1pbmZvXCJcbiAgICAgIH0pO1xuXG4gICAgICBpbmZvLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogbW92aWUudGl0bGUsXG4gICAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb3ZpZS10aXRsZVwiXG4gICAgICB9KTtcblxuICAgICAgLy8gQnVpbGQgdGhlIGRldGFpbHMgc3RyaW5nIGNvbmRpdGlvbmFsbHksIG9ubHkgaW5jbHVkaW5nIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcbiAgICAgIGNvbnN0IGRldGFpbHNQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS55ZWFyLCBudWxsKTtcbiAgICAgIGNvbnN0IHR5cGUgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyBtb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcblxuICAgICAgaWYgKHllYXIpIHtcbiAgICAgICAgZGV0YWlsc1BhcnRzLnB1c2goeWVhcilcbiAgICAgIH07XG5cbiAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgIGRldGFpbHNQYXJ0cy5wdXNoKHR5cGUpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkZXRhaWxzVGV4dCA9IGRldGFpbHNQYXJ0cy5qb2luKFwiIC0gXCIpO1xuICAgICAgaWYgKGRldGFpbHNUZXh0KSB7XG4gICAgICAgIGluZm8uY3JlYXRlRWwoXCJkaXZcIiwge1xuICAgICAgICAgIHRleHQ6IGRldGFpbHNUZXh0LFxuICAgICAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb3ZpZS15ZWFyXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgIGNyZWF0ZVN0YXJSYXRpbmcoaW5mbywgbW92aWUuc3RhclJhdGluZywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobW92aWUucmF0aW5ncyAmJiBtb3ZpZS5yYXRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGluZm8sIG1vdmllLnJhdGluZ3MpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTW92aWVEZXRhaWxzKG1vdmllKSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9wZW5Nb3ZpZURldGFpbHMobW92aWU6IENpbmVWYXVsdE1vdmllKSB7XG4gICAgbmV3IENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwodGhpcy5wbHVnaW4uYXBwLCBtb3ZpZSwgYXN5bmMgKHJhdGluZykgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICAgIG1vdmllLnN0YXJSYXRpbmcgPSByYXRpbmc7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgdGhpcy5kYXRhLm1vdmllcyA9IHRoaXMuZGF0YS5tb3ZpZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmlkICE9PSBtb3ZpZS5pZCk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgbW92aWUud2F0Y2hlZCA9ICFtb3ZpZS53YXRjaGVkO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgdGhpcy5yZWZyZXNoTW92aWVzKCk7XG4gICAgfSkub3BlbigpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWZyZXNoTW92aWVzKCkge1xuICAgIGlmICghdGhpcy5tb3ZpZXNDb250YWluZXIpIHJldHVybjtcbiAgICB0aGlzLnJlbmRlck1vdmllcyh0aGlzLm1vdmllc0NvbnRhaW5lcik7XG4gIH1cblxuICBwcml2YXRlIGdldEpzb25GaWxlcygpOiBURmlsZVtdIHtcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplRGF0YSgpIHtcbiAgICAvLyBQcmVmZXIgYSBsb2NhbGx5IGxpbmtlZCBmaWxlIGluc2lkZSB0aGUgdmF1bHQgaWYgY29uZmlndXJlZFxuICAgIGNvbnN0IGxvY2FsUGF0aCA9IHRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGg7XG4gICAgaWYgKGxvY2FsUGF0aCkge1xuICAgICAgY29uc3QgbG9jYWxGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGxvY2FsRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUobG9jYWxGaWxlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vIGxpbmtlZCBmaWxlcyBmb3VuZCBcdTIwMTQgZG9uJ3QgY3JlYXRlIGZvbGRlcnMvZmlsZXMgYXV0b21hdGljYWxseS4gU2hvdyBvbmJvYXJkaW5nLlxuICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZEZpbGUoZmlsZTogVEZpbGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gYXdhaXQgbG9hZExvY2FsRmlsZSh0aGlzLnBsdWdpbi5hcHAsIGZpbGUpO1xuICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgIHRoaXMuZGF0YSA9IHBhcnNlZDtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldExvY2FsSnNvblBhdGgoZmlsZS5wYXRoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgICBuZXcgTm90aWNlKFwiVW5hYmxlIHRvIHJlYWQgdGhlIEpTT04gZmlsZS5cIik7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgYXN5bmMgc2F2ZURhdGEoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICB0aGlzLmRhdGEudXBkYXRlZEF0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGlmICh0aGlzLmZpbGUpIHtcbiAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIHRoaXMuZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZW5kZXJTZWFyY2hSZXN1bHRzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHJlc3VsdHM6IGFueVtdKSB7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICByZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xuICAgICAgY29uc3QgaXRlbSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLWl0ZW1cIiB9KTtcbiAgICAgIGlmIChyZXN1bHQucG9zdGVyKSB7XG4gICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLXBvc3RlclwiIH0pLnNldEF0dHJpYnV0ZShcInNyY1wiLCByZXN1bHQucG9zdGVyKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGluZm8gPSBpdGVtLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1zZWFyY2gtaW5mb1wiIH0pO1xuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHJlc3VsdC50aXRsZSwgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXNlYXJjaC10aXRsZVwiIH0pO1xuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHJlc3VsdC55ZWFyLCBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc2VhcmNoLXllYXJcIiB9KTtcblxuICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBuZXcgQ2luZVZhdWx0TW92aWVBY3Rpb25Nb2RhbChcbiAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAsXG4gICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgIGFzeW5jICh3YXRjaGVkKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IHRoaXMuZGF0YS5tb3ZpZXMuZmluZCgobW92aWUpID0+IG1vdmllLmltZGJJZCA9PT0gcmVzdWx0LmltZGJJZCk7XG4gICAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgICAgZXhpc3Rpbmcud2F0Y2hlZCA9IHdhdGNoZWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZXcgTm90aWNlKGBMb2FkaW5nIGRldGFpbHMgZm9yICR7cmVzdWx0LnRpdGxlfS4uLmApO1xuICAgICAgICAgICAgICBjb25zdCBkZXRhaWxzID0gYXdhaXQgZ2V0T21kYkRldGFpbHMocmVzdWx0LmltZGJJZCwgdGhpcy5wbHVnaW4ub21kYkFwaUtleSk7XG5cbiAgICAgICAgICAgICAgaWYgKCFkZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBsb2FkIG1vdmllIGRldGFpbHMuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IG5ld01vdmllID0gY3JlYXRlRW1wdHlNb3ZpZSgpO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5pbWRiSWQgPSBkZXRhaWxzLmltZGJJRCB8fCByZXN1bHQuaW1kYklkO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS50aXRsZSA9IGRldGFpbHMuVGl0bGUgfHwgcmVzdWx0LnRpdGxlO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS55ZWFyID0gZGV0YWlscy5ZZWFyIHx8IHJlc3VsdC55ZWFyO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5yYXRlZCA9IGRldGFpbHMuUmF0ZWQgfHwgXCJcIjtcbiAgICAgICAgICAgICAgbmV3TW92aWUucmVsZWFzZWQgPSBkZXRhaWxzLlJlbGVhc2VkIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLnJ1bnRpbWUgPSBkZXRhaWxzLlJ1bnRpbWUgfHwgXCJcIjtcbiAgICAgICAgICAgICAgbmV3TW92aWUuZ2VucmUgPSBkZXRhaWxzLkdlbnJlIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLmRpcmVjdG9yID0gZGV0YWlscy5EaXJlY3RvciB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS53cml0ZXIgPSBkZXRhaWxzLldyaXRlciB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5hY3RvcnMgPSBkZXRhaWxzLkFjdG9ycyB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5wbG90ID0gZGV0YWlscy5QbG90IHx8IHJlc3VsdC5wbG90O1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5sYW5ndWFnZSA9IGRldGFpbHMuTGFuZ3VhZ2UgfHwgXCJcIjtcbiAgICAgICAgICAgICAgbmV3TW92aWUuY291bnRyeSA9IGRldGFpbHMuQ291bnRyeSB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5hd2FyZHMgPSBkZXRhaWxzLkF3YXJkcyB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5wb3N0ZXIgPSBkZXRhaWxzLlBvc3RlciAmJiBkZXRhaWxzLlBvc3RlciAhPT0gXCJOL0FcIiA/IGRldGFpbHMuUG9zdGVyIDogcmVzdWx0LnBvc3RlcjtcbiAgICAgICAgICAgICAgbmV3TW92aWUucG9zdGVyTG9jYWwgPSBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5yYXRpbmdzID0gZGV0YWlscy5SYXRpbmdzIHx8IFtdO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5tZXRhc2NvcmUgPSBkZXRhaWxzLk1ldGFzY29yZSB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS5pbWRiUmF0aW5nID0gZGV0YWlscy5pbWRiUmF0aW5nIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLmltZGJWb3RlcyA9IGRldGFpbHMuaW1kYlZvdGVzIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLnR5cGUgPSBkZXRhaWxzLlR5cGUgfHwgcmVzdWx0LnR5cGU7XG4gICAgICAgICAgICAgIG5ld01vdmllLmR2ZCA9IGRldGFpbHMuRFZEIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLmJveE9mZmljZSA9IGRldGFpbHMuQm94T2ZmaWNlIHx8IFwiXCI7XG4gICAgICAgICAgICAgIG5ld01vdmllLnByb2R1Y3Rpb24gPSBkZXRhaWxzLlByb2R1Y3Rpb24gfHwgXCJcIjtcbiAgICAgICAgICAgICAgbmV3TW92aWUud2Vic2l0ZSA9IGRldGFpbHMuV2Vic2l0ZSB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS50b3RhbFNlYXNvbnMgPSBkZXRhaWxzLnRvdGFsU2Vhc29ucyB8fCBcIlwiO1xuICAgICAgICAgICAgICBuZXdNb3ZpZS53YXRjaGVkID0gd2F0Y2hlZDtcblxuICAgICAgICAgICAgICB0aGlzLmRhdGEubW92aWVzLnVuc2hpZnQobmV3TW92aWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5vcGVuKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufSIsICJleHBvcnQgZnVuY3Rpb24gcmVuZGVyT25ib2FyZGluZyhcbiAgY29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgb25DcmVhdGU6ICgpID0+IHZvaWQsXG4gIG9uTGluaz86ICgpID0+IHZvaWRcbikge1xuICBjb25zdCBvbmJvYXJkaW5nID0gY29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLWJveG9mZmljZS1vbmJvYXJkaW5nXCJcbiAgfSk7XG5cbiAgY29uc3QgYWN0aW9ucyA9IG9uYm9hcmRpbmcuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLWJveG9mZmljZS1vbmJvYXJkaW5nLWFjdGlvbnNcIiB9KTtcbiAgY29uc3QgY3JlYXRlQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiQ3JlYXRlIG5ldyBsaWJyYXJ5XCIgfSk7XG4gIGNyZWF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DcmVhdGUpO1xuXG4gIGlmIChvbkxpbmspIHtcbiAgICBhY3Rpb25zLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwib3JcIiB9KTtcbiAgICBjb25zdCBsaW5rQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiTGluayBleGlzdGluZyBsaWJyYXJ5XCIgfSk7XG4gICAgbGlua0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25MaW5rKTtcbiAgfVxufSIsICJpbXBvcnQgeyBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgeyBDaW5lVmF1bHRTZWFyY2hJdGVtIH0gZnJvbSBcIi4uLy4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgbnVsbFNhZmUgfSBmcm9tIFwic3JjL3V0aWxzL2hlbHBlcnNcIjtcblxuZXhwb3J0IGNsYXNzIENpbmVWYXVsdE1vdmllQWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHByaXZhdGUgbW92aWU6IENpbmVWYXVsdFNlYXJjaEl0ZW07XG4gIHByaXZhdGUgb25TYXZlOiAod2F0Y2hlZDogYm9vbGVhbikgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihhcHA6IE1vZGFsW1wiYXBwXCJdLCBtb3ZpZTogQ2luZVZhdWx0U2VhcmNoSXRlbSwgb25TYXZlOiAod2F0Y2hlZDogYm9vbGVhbikgPT4gdm9pZCkge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5tb3ZpZSA9IG1vdmllO1xuICAgIHRoaXMub25TYXZlID0gb25TYXZlO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtY29udGFpbmVyXCJcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZGFsSGVhZGVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtaGVhZGVyXCJcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZGFsVGl0bGVDb250YWluZXIgPSBtb2RhbEhlYWRlci5jcmVhdGVEaXYoe1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC10aXRsZS1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcImgxXCIsIHtcbiAgICAgIHRleHQ6IHRoaXMubW92aWUudGl0bGUsXG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXRpdGxlXCJcbiAgICB9KTtcblxuICAgIC8vIFllYXIgYW5kIFR5cGVcbiAgICBjb25zdCB0eXBlID0gbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyB0aGlzLm1vdmllLnR5cGUuc2xpY2UoMSksIG51bGwpO1xuICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiB0aGlzLm1vdmllLnllYXIsIG51bGwpO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgdGV4dDogYCR7eWVhcn0gLSAke3R5cGV9YCxcbiAgICB9KTtcblxuICAgIC8vIFBvc3RlclxuICAgIGlmICh0aGlzLm1vdmllLnBvc3Rlcikge1xuICAgICAgbW9kYWxIZWFkZXIuY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXBvc3RlclwiIH0pLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLm1vdmllLnBvc3Rlcik7XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aW9ucyA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLWFjdGlvbnNcIiB9KTtcbiAgICBjb25zdCB3YXRjaGVkQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcbiAgICAgIFwiYnV0dG9uXCIsXG4gICAgICB7XG4gICAgICAgIHRleHQ6IFwiTWFyayBhcyB3YXRjaGVkXCJcbiAgICAgIH0pO1xuICAgIGNvbnN0IHRvV2F0Y2hCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFxuICAgICAgXCJidXR0b25cIixcbiAgICAgIHtcbiAgICAgICAgdGV4dDogXCJUbyB3YXRjaFwiXG4gICAgICB9KTtcblxuICAgIHdhdGNoZWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25TYXZlKHRydWUpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuXG4gICAgdG9XYXRjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblNhdmUoZmFsc2UpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCAiaW1wb3J0IHR5cGUgeyBNb3ZpZVJhdGluZyB9IGZyb20gXCIuLi90eXBlcy9jaW5ldmF1bHRcIjtcblxuLyoqXG4gKiBTYWZlbHkgZXhlY3V0ZSBhIGZ1bmN0aW9uIHRoYXQgbWF5IHRocm93IG9yIHJldHVybiBudWxsL3VuZGVmaW5lZC5cbiAqIEB0ZW1wbGF0ZSBUXG4gKiBAcGFyYW0geygpID0+IFR9IGZ1bmMgLSBGdW5jdGlvbiB0byBleGVjdXRlIHNhZmVseS5cbiAqIEBwYXJhbSB7VCB8IG51bGx9IFtmYWxsYmFja1ZhbHVlPW51bGxdIC0gVmFsdWUgdG8gcmV0dXJuIGlmIGBmdW5jYCB0aHJvd3Mgb3IgcmV0dXJucyBudWxsL3VuZGVmaW5lZC5cbiAqIEByZXR1cm5zIHtUIHwgbnVsbH0gVGhlIHJlc3VsdCBvZiBgZnVuY2Agb3IgdGhlIHByb3ZpZGVkIGBmYWxsYmFja1ZhbHVlYC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG51bGxTYWZlPFQ+KGZ1bmM6ICgpID0+IFQsIGZhbGxiYWNrVmFsdWU6IFQgfCBudWxsID0gbnVsbCk6IFQgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWx1ZSA9IGZ1bmMoKTtcbiAgICByZXR1cm4gdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCA/IGZhbGxiYWNrVmFsdWUgOiB2YWx1ZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOiAnLCBlKTtcbiAgICByZXR1cm4gZmFsbGJhY2tWYWx1ZTtcbiAgfVxufVxuXG4vKipcbiAqIE5vcm1hbGl6ZSB2YXJpb3VzIHJhdGluZyBmb3JtYXRzIGludG8gYSBudW1lcmljIHN0cmluZy5cbiAqIFN1cHBvcnRzIGZvcm1hdHMgbGlrZSBcIjcvMTBcIiwgXCI4NS8xMDBcIiwgXCI4NSVcIiwgYW5kIGRlY2ltYWxzIHVzaW5nIGNvbW1hcy5cbiAqIC0gXCJ4LzEwXCIgaXMgY29udmVydGVkIHRvIGEgdmFsdWUgb3V0IG9mIDEwMCAobXVsdGlwbGllZCBieSAxMCkuXG4gKiAtIFwieC8xMDBcIiByZXR1cm5zIHRoZSBudW1lcmljIHBhcnQgYmVmb3JlIHRoZSBzbGFzaC5cbiAqIC0gXCJ4JVwiIHJlbW92ZXMgdGhlIHBlcmNlbnQgc2lnbi5cbiAqIEBwYXJhbSB7c3RyaW5nfSByYXRpbmcgLSBSYXRpbmcgc3RyaW5nIGZyb20gZXh0ZXJuYWwgc291cmNlcy5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IE5vcm1hbGl6ZWQgbnVtZXJpYyBzdHJpbmcgKGUuZy4gXCI3NVwiLCBcIjcuNVwiKS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFJhdGluZyhyYXRpbmc6IHN0cmluZyk6IHN0cmluZyB7XG4gIGxldCB2YWx1ZSA9IHJhdGluZztcbiAgY29uc3QgaXNQZXJUZW4gPSByYXRpbmcuaW5jbHVkZXMoXCIvMTBcIik7XG4gIGNvbnN0IGlzUGVyQ2VudCA9IHJhdGluZy5pbmNsdWRlcyhcIi8xMDBcIik7XG5cbiAgaWYgKGlzUGVyVGVuICYmICFpc1BlckNlbnQpIHtcbiAgICBjb25zdCBub3JtYWxpemVkID0gdmFsdWUucmVwbGFjZSgnLCcsICcuJyk7XG4gICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdChub3JtYWxpemVkKTtcbiAgICBpZiAoIWlzTmFOKG51bSkgJiYgaXNGaW5pdGUobnVtKSkge1xuICAgICAgY29uc3QgbXVsdGlwbGllZCA9IG51bSAqIDEwO1xuICAgICAgdmFsdWUgPSBtdWx0aXBsaWVkICUgMSA9PT0gMCA/IFN0cmluZyhNYXRoLnRydW5jKG11bHRpcGxpZWQpKSA6IFN0cmluZyhtdWx0aXBsaWVkKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAocmF0aW5nLmluY2x1ZGVzKFwiL1wiKSAmJiBpc1BlckNlbnQpIHtcbiAgICB2YWx1ZSA9IHJhdGluZy5zcGxpdChcIi9cIilbMF0udHJpbSgpO1xuICB9IGVsc2UgaWYgKHJhdGluZy5pbmNsdWRlcyhcIiVcIikpIHtcbiAgICB2YWx1ZSA9IHJhdGluZy5yZXBsYWNlKFwiJVwiLCBcIlwiKS50cmltKCk7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICogQ29tcHV0ZSB0aGUgYXZlcmFnZSBvZiBhbiBhcnJheSBvZiByYXRpbmcgc3RyaW5ncy5cbiAqIFVzZXMgYGZvcm1hdFJhdGluZ2AgdG8gbm9ybWFsaXplIHZhbHVlcywgaWdub3JlcyBub24tbnVtZXJpYyBlbnRyaWVzLlxuICogQHBhcmFtIHtzdHJpbmdbXX0gcmF0aW5ncyAtIEFycmF5IG9mIHJhdGluZyBzdHJpbmdzIHRvIGF2ZXJhZ2UuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBBdmVyYWdlIGFzIGFuIGludGVnZXIgc3RyaW5nIG9yIG9uZS1kZWNpbWFsIHN0cmluZzsgcmV0dXJucyBcIk4vQVwiIGlmIG5vIHZhbGlkIHJhdGluZ3MuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhdmVyYWdlUmF0aW5nKHJhdGluZ3M6IHN0cmluZ1tdKTogc3RyaW5nIHtcbiAgY29uc3Qgbm9ybWFsaXplZFJhdGluZ3MgPSByYXRpbmdzLm1hcChmb3JtYXRSYXRpbmcpLm1hcChyID0+IHBhcnNlRmxvYXQocikpLmZpbHRlcihyID0+ICFpc05hTihyKSAmJiBpc0Zpbml0ZShyKSk7XG4gIGlmIChub3JtYWxpemVkUmF0aW5ncy5sZW5ndGggPT09IDApIHJldHVybiBcIk4vQVwiO1xuICBjb25zdCBzdW0gPSBub3JtYWxpemVkUmF0aW5ncy5yZWR1Y2UoKGFjYywgdmFsKSA9PiBhY2MgKyB2YWwsIDApO1xuICBjb25zdCBhdmVyYWdlID0gc3VtIC8gbm9ybWFsaXplZFJhdGluZ3MubGVuZ3RoO1xuICByZXR1cm4gYXZlcmFnZSAlIDEgPT09IDAgPyBTdHJpbmcoTWF0aC50cnVuYyhhdmVyYWdlKSkgOiBTdHJpbmcoYXZlcmFnZS50b0ZpeGVkKDEpKTtcbn1cblxuLyoqXG4gKiBSZW5kZXIgYSBzaW1wbGUgcmF0aW5nIGJhciBVSSBpbnRvIGEgcGFyZW50IGVsZW1lbnQgdXNpbmcgZXh0ZXJuYWwgcmF0aW5ncy5cbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHBhcmVudCAtIFBhcmVudCBlbGVtZW50IHRvIHdoaWNoIHRoZSByYXRpbmcgYmFyIHdpbGwgYmUgYXBwZW5kZWQuXG4gKiBAcGFyYW0ge01vdmllUmF0aW5nW10gfCB1bmRlZmluZWQgfCBudWxsfSByYXRpbmdzIC0gQXJyYXkgb2YgcmF0aW5nIG9iamVjdHMgd2l0aCBhIGBWYWx1ZWAgcHJvcGVydHkuXG4gKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIC0gT3B0aW9uYWwgY2xhc3NlcyB0byBjdXN0b21pemUgZWxlbWVudHMuXG4gKiBAcGFyYW0ge3tiYXJDb250YWluZXI/OiBzdHJpbmcsIGJhcj86IHN0cmluZywgZmlsbD86IHN0cmluZywgYXZlcmFnZT86IHN0cmluZ319IFtvcHRpb25zLmNsYXNzZXNdXG4gKiBAcmV0dXJucyB7e2NvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGF2ZXJhZ2U6IHN0cmluZywgcGVyY2VudGFnZTogbnVtYmVyfSB8IG51bGx9IEFuIG9iamVjdCB3aXRoIHRoZSBjb250YWluZXIgZWxlbWVudCwgYXZlcmFnZSBzdHJpbmcgYW5kIHBlcmNlbnRhZ2UgbnVtYmVyLCBvciBgbnVsbGAgd2hlbiBubyByYXRpbmdzIGFyZSBwcm92aWRlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKHBhcmVudDogSFRNTEVsZW1lbnQsIHJhdGluZ3M6IE1vdmllUmF0aW5nW10gfCB1bmRlZmluZWQgfCBudWxsLCBvcHRpb25zPzoge1xuICBjbGFzc2VzPzoge1xuICAgIGJhckNvbnRhaW5lcj86IHN0cmluZztcbiAgICBiYXI/OiBzdHJpbmc7XG4gICAgZmlsbD86IHN0cmluZztcbiAgICBhdmVyYWdlPzogc3RyaW5nO1xuICB9O1xufSkge1xuICBpZiAoIXJhdGluZ3MgfHwgcmF0aW5ncy5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gIGNvbnN0IHJhdGluZ0JhckNvbnRhaW5lciA9IHBhcmVudC5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtYmFyLWNvbnRhaW5lclwiIH0pO1xuICBjb25zdCByYXRpbmdCYXIgPSByYXRpbmdCYXJDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLWJhclwiIH0pO1xuICBjb25zdCByYXRpbmdGaWxsID0gcmF0aW5nQmFyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1maWxsXCIgfSk7XG5cbiAgY29uc3QgdmFsdWVzID0gcmF0aW5ncy5tYXAoKHIpID0+IGZvcm1hdFJhdGluZyhyLlZhbHVlKSk7XG4gIGNvbnN0IGF2ZXJhZ2UgPSBhdmVyYWdlUmF0aW5nKHZhbHVlcyk7XG4gIGNvbnN0IHBlcmNlbnRhZ2UgPSBwYXJzZUZsb2F0KGF2ZXJhZ2UpO1xuXG4gIHJhdGluZ0ZpbGwuc3R5bGUud2lkdGggPSBgJHtpc05hTihwZXJjZW50YWdlKSA/IDAgOiBwZXJjZW50YWdlfSVgO1xuXG4gIHJhdGluZ0JhckNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwge1xuICAgIHRleHQ6IGAke2F2ZXJhZ2V9JWAsXG4gICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLWF2ZXJhZ2VcIlxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lcjogcmF0aW5nQmFyQ29udGFpbmVyLFxuICAgIGF2ZXJhZ2UsXG4gICAgcGVyY2VudGFnZTogaXNOYU4ocGVyY2VudGFnZSkgPyAwIDogcGVyY2VudGFnZVxuICB9O1xufVxuIiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uLy4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgY3JlYXRlU3RhclJhdGluZyB9IGZyb20gXCIuLi9zdGFyUmF0aW5nXCI7XG5pbXBvcnQgeyBudWxsU2FmZSwgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIgfSBmcm9tIFwic3JjL3V0aWxzL2hlbHBlcnNcIjtcblxuZXhwb3J0IGNsYXNzIENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHByaXZhdGUgbW92aWU6IENpbmVWYXVsdE1vdmllO1xuICBwcml2YXRlIG9uUmF0ZTogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uUmVtb3ZlOiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uVG9nZ2xlV2F0Y2hlZDogKCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBhcHA6IE1vZGFsW1wiYXBwXCJdLFxuICAgIG1vdmllOiBDaW5lVmF1bHRNb3ZpZSxcbiAgICBvblJhdGU6IChyYXRpbmc6IG51bWJlcikgPT4gdm9pZCxcbiAgICBvblJlbW92ZTogKCkgPT4gdm9pZCxcbiAgICBvblRvZ2dsZVdhdGNoZWQ6ICgpID0+IHZvaWRcbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm1vdmllID0gbW92aWU7XG4gICAgdGhpcy5vblJhdGUgPSBvblJhdGU7XG4gICAgdGhpcy5vblJlbW92ZSA9IG9uUmVtb3ZlO1xuICAgIHRoaXMub25Ub2dnbGVXYXRjaGVkID0gb25Ub2dnbGVXYXRjaGVkO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtY29udGFpbmVyXCJcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZGFsSGVhZGVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtaGVhZGVyXCJcbiAgICB9KTtcblxuICAgIGNvbnN0IG1vZGFsVGl0bGVDb250YWluZXIgPSBtb2RhbEhlYWRlci5jcmVhdGVEaXYoe1xuICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC10aXRsZS1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcImgxXCIsIHtcbiAgICAgIHRleHQ6IHRoaXMubW92aWUudGl0bGUsXG4gICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXRpdGxlXCJcbiAgICB9KTtcblxuICAgIC8vIFllYXIgYW5kIFR5cGVcbiAgICBjb25zdCB0eXBlID0gbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyB0aGlzLm1vdmllLnR5cGUuc2xpY2UoMSksIG51bGwpO1xuICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiB0aGlzLm1vdmllLnllYXIsIG51bGwpO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgdGV4dDogYCR7eWVhcn0gLSAke3R5cGV9YCxcbiAgICB9KTtcblxuICAgIG1vZGFsVGl0bGVDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiRGlyZWN0ZWQgYnkgXCIgKyBudWxsU2FmZSgoKSA9PiB0aGlzLm1vdmllLmRpcmVjdG9yLCBcIk4vQVwiKSxcbiAgICB9KTtcblxuICAgIG1vZGFsVGl0bGVDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiRHVyYXRpb24gXCIgKyBudWxsU2FmZSgoKSA9PiB0aGlzLm1vdmllLnJ1bnRpbWUsIFwiTi9BXCIpLFxuICAgIH0pO1xuXG4gICAgLy8gUG9zdGVyXG4gICAgaWYgKHRoaXMubW92aWUucG9zdGVyKSB7XG4gICAgICBtb2RhbEhlYWRlci5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMubW92aWUucG9zdGVyKTtcbiAgICB9XG5cbiAgICAvLyBQbG90XG4gICAgaWYgKHRoaXMubW92aWUucGxvdCkge1xuICAgICAgY29uc3QgcGxvdENvbnRhaW5lciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1wbG90LWNvbnRhaW5lclwiIH0pO1xuXG4gICAgICBjb25zdCBwbG90RWwgPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IHRoaXMubW92aWUucGxvdCxcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1wbG90XCJcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzaG93TW9yZUJ1dHRvbiA9IHBsb3RDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgICB0ZXh0OiBcIlNob3cgbW9yZVwiLFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXNob3ctbW9yZSBvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiXG4gICAgICB9KVxuXG4gICAgICBzaG93TW9yZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gcGxvdEVsLmNsYXNzTGlzdC50b2dnbGUoXCJleHBhbmRlZC1wbG90XCIpO1xuICAgICAgICBzaG93TW9yZUJ1dHRvbi5zZXRUZXh0KGlzRXhwYW5kZWQgPyBcIlNob3cgbGVzc1wiIDogXCJTaG93IG1vcmVcIik7XG4gICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3IgbGF5b3V0IHNvIHdlIGNhbiBtZWFzdXJlIG92ZXJmbG93XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAvLyBJZiBjb250ZW50IGhlaWdodCBleGNlZWRzIGNvbnRhaW5lciBoZWlnaHQsIGl0J3MgdHJ1bmNhdGVkXG4gICAgICAgIGlmIChwbG90RWwuc2Nyb2xsSGVpZ2h0ID4gcGxvdEVsLmNsaWVudEhlaWdodCArIDEpIHtcbiAgICAgICAgICBzaG93TW9yZUJ1dHRvbi5yZW1vdmVDbGFzcyhcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1zaG93LW1vcmUtaGlkZGVuXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBkZXRhaWxzIHNlY3Rpb24gb25seSBpZiBhdCBsZWFzdCBvbmUgZGV0YWlsIGlzIGF2YWlsYWJsZVxuICAgIGZ1bmN0aW9uIHJlZGVyRGV0YWlsU2VjdGlvbih0eXBlOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IGRldGFpbEVsZW1lbnQgPSBtb2RhbENvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtZGV0YWlsLWNvbnRhaW5lclwiIH0pO1xuICAgICAgZGV0YWlsRWxlbWVudC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICB0ZXh0OiBgJHt0eXBlfTpgLFxuICAgICAgICBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLWxhYmVsXCJcbiAgICAgIH0pO1xuICAgICAgZGV0YWlsRWxlbWVudC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICB0ZXh0OiB2YWx1ZSxcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1kZXRhaWwtdmFsdWVcIlxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgIC8vIEdlbnJlXG4gICAgaWYgKHRoaXMubW92aWUuZ2VucmUpIHtcbiAgICAgIHJlZGVyRGV0YWlsU2VjdGlvbihcIkdlbnJlXCIsIHRoaXMubW92aWUuZ2VucmUpO1xuICAgIH1cblxuICAgIC8vIEFjdG9yc1xuICAgIGlmICh0aGlzLm1vdmllLmFjdG9ycykge1xuICAgICAgcmVkZXJEZXRhaWxTZWN0aW9uKFwiQWN0b3JzXCIsIHRoaXMubW92aWUuYWN0b3JzKTtcbiAgICB9XG5cbiAgICBtb2RhbENvbnRhaW5lci5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgY29uc3QgcmF0aW5nV3JhcHBlciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtcmF0aW5nLXdyYXBwZXJcIiB9KTtcblxuICAgIC8vIFBlcnNvbmFsIFJhdGluZ1xuICAgIGNvbnN0IHJhdGluZ0NvbnRhaW5lciA9IHJhdGluZ1dyYXBwZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJvYnMtcGx1Z2luLWJveG9mZmljZS1tb2RhbC1kZXRhaWwtcmF0aW5nLWNvbnRhaW5lclwiXG4gICAgfSk7XG5cbiAgICByYXRpbmdDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlJhdGluZ1wiLCBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXJhdGluZy1sYWJlbFwiIH0pO1xuICAgIGNyZWF0ZVN0YXJSYXRpbmcocmF0aW5nQ29udGFpbmVyLCB0aGlzLm1vdmllLnN0YXJSYXRpbmcsIGZhbHNlLCAocmF0aW5nKSA9PiB7XG4gICAgICB0aGlzLm9uUmF0ZShyYXRpbmcpO1xuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMubW92aWUucmF0aW5ncykge1xuICAgICAgY29uc3QgZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyID0gcmF0aW5nV3JhcHBlci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIiB9KTtcblxuICAgICAgZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogXCJFeHRlcm5hbCByYXRpbmdcIixcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1yYXRpbmctbGFiZWxcIlxuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGV4dGVybmFsUmF0aW5nc0NvbnRhaW5lciwgdGhpcy5tb3ZpZS5yYXRpbmdzKTtcblxuICAgICAgLy8gRXh0ZXJuYWwgcmF0aW5nIGRpc2NsYWltZXIgc3RheXMgaW4gdGhlIG1vZGFsXG4gICAgICBtb2RhbENvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICB0ZXh0OiBcIlRoZSBleHRlcm5hbCByYXRpbmcgaXMgYW4gYXZlcmFnZSBiYXNlZCBvbiB2b3RlcyBmcm9tIEludGVybmV0IE1vdmllIERhdGFiYXNlLCBSb3R0ZW4gVG9tYXRvZXMgYW5kIE1ldGFjcml0aWNcIixcbiAgICAgICAgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1yYXRpbmctZGlzY2xhaW1lclwiXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBhY3Rpb25zID0gbW9kYWxDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLW1vZGFsLWRldGFpbC1hY3Rpb25zXCIgfSk7XG4gICAgY29uc3QgdG9nZ2xlV2F0Y2hlZExhYmVsID0gdGhpcy5tb3ZpZS53YXRjaGVkID8gXCJNYXJrIGFzIHRvIHdhdGNoXCIgOiBcIk1hcmsgYXMgd2F0Y2hlZFwiO1xuICAgIGNvbnN0IHRvZ2dsZVdhdGNoZWRCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogdG9nZ2xlV2F0Y2hlZExhYmVsIH0pO1xuICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlJlbW92ZVwiLCBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2UtZGFuZ2VyXCIgfSk7XG5cbiAgICB0b2dnbGVXYXRjaGVkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLm9uVG9nZ2xlV2F0Y2hlZCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuXG4gICAgcmVtb3ZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLm9uUmVtb3ZlKCk7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn0iLCAiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN0YXJSYXRpbmcoXG4gIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gIHJhdGluZzogbnVtYmVyLFxuICByZWFkT25seTogYm9vbGVhbixcbiAgb25DaGFuZ2U/OiAocmF0aW5nOiBudW1iZXIpID0+IHZvaWRcbikge1xuICBjb25zdCBzdGFycyA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwib2JzLXBsdWdpbi1ib3hvZmZpY2Utc3RhcnNcIiB9KTtcbiAgY29uc3Qgc3RhckVsZW1lbnRzOiBIVE1MU3BhbkVsZW1lbnRbXSA9IFtdO1xuICBsZXQgY3VycmVudFJhdGluZyA9IHJhdGluZztcblxuICBmb3IgKGxldCBpID0gMTsgaSA8PSA1OyBpICs9IDEpIHtcbiAgICBjb25zdCBzdGFyID0gc3RhcnMuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJcdTI2MDVcIiwgY2xzOiBcIm9icy1wbHVnaW4tYm94b2ZmaWNlLXN0YXJcIiB9KTtcbiAgICBpZiAoaSA8PSByYXRpbmcpIHN0YXIuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICBzdGFyRWxlbWVudHMucHVzaChzdGFyKTtcbiAgICBpZiAoIXJlYWRPbmx5KSB7XG4gICAgICBzdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIElmIGNsaWNraW5nIHRoZSBzYW1lIHN0YXIgdGhhdCdzIGFscmVhZHkgc2VsZWN0ZWQsIHJlc2V0IHRvIDBcbiAgICAgICAgaWYgKGN1cnJlbnRSYXRpbmcgPT09IGkpIHtcbiAgICAgICAgICBjdXJyZW50UmF0aW5nID0gMDtcbiAgICAgICAgICBzdGFyRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRSYXRpbmcgPSBpO1xuICAgICAgICAgIHN0YXJFbGVtZW50cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIsIGluZGV4IDwgaSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgb25DaGFuZ2U/LihjdXJyZW50UmF0aW5nKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoXCJyZWFkb25seVwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0YXJzO1xufVxuIiwgImltcG9ydCB7IEFwcCwgU3VnZ2VzdE1vZGFsLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgSnNvbkZpbGVTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgcHJpdmF0ZSBqc29uRmlsZXM6IFRGaWxlW107XG4gIHByaXZhdGUgb25TZWxlY3Q6IChmaWxlOiBURmlsZSkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TZWxlY3Q6IChmaWxlOiBURmlsZSkgPT4gdm9pZCkge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5vblNlbGVjdCA9IG9uU2VsZWN0O1xuICAgIHRoaXMuanNvbkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoKGYpID0+IGYuZXh0ZW5zaW9uID09PSBcImpzb25cIik7XG4gICAgdGhpcy5zZXRQbGFjZWhvbGRlcihcIlNlbGVjdCBhIEpTT04gZmlsZSBmcm9tIHlvdXIgdmF1bHQuLi5cIik7XG4gIH1cblxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIHRoaXMuanNvbkZpbGVzLmZpbHRlcigoZmlsZSkgPT5cbiAgICAgIGZpbGUucGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpXG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgIGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZmlsZS5wYXRoIH0pO1xuICB9XG5cbiAgb25DaG9vc2VTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgdGhpcy5vblNlbGVjdChmaWxlKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIHsgQ2luZVZhdWx0RGF0YSwgQ2luZVZhdWx0TW92aWUgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5pbXBvcnQgeyBGT0xERVIsIE5BTUUgfSBmcm9tIFwic3JjL2NvbnN0YW50c1wiO1xuXG5jb25zdCBERUZBVUxUX05BTUUgPSBgJHtOQU1FfS5qc29uYDtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRQYXRoKGZvbGRlcj86IHN0cmluZykge1xuICBjb25zdCBmb2xkZXJQYXRoID0gZm9sZGVyID8/IEZPTERFUjtcbiAgcmV0dXJuIGAke2ZvbGRlclBhdGh9LyR7REVGQVVMVF9OQU1FfWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRGb2xkZXIoZm9sZGVyPzogc3RyaW5nKSB7XG4gIHJldHVybiBmb2xkZXIgPz8gRk9MREVSO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRW1wdHlNb3ZpZSgpOiBDaW5lVmF1bHRNb3ZpZSB7XG4gIHJldHVybiB7XG4gICAgaWQ6IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLFxuICAgIGltZGJJZDogXCJcIixcbiAgICB0aXRsZTogXCJcIixcbiAgICB5ZWFyOiBcIlwiLFxuICAgIHJhdGVkOiBcIlwiLFxuICAgIHJlbGVhc2VkOiBcIlwiLFxuICAgIHJ1bnRpbWU6IFwiXCIsXG4gICAgZ2VucmU6IFwiXCIsXG4gICAgZGlyZWN0b3I6IFwiXCIsXG4gICAgd3JpdGVyOiBcIlwiLFxuICAgIGFjdG9yczogXCJcIixcbiAgICBwbG90OiBcIlwiLFxuICAgIGxhbmd1YWdlOiBcIlwiLFxuICAgIGNvdW50cnk6IFwiXCIsXG4gICAgYXdhcmRzOiBcIlwiLFxuICAgIHBvc3RlcjogXCJcIixcbiAgICBwb3N0ZXJMb2NhbDogXCJcIixcbiAgICByYXRpbmdzOiBbXSxcbiAgICBtZXRhc2NvcmU6IFwiXCIsXG4gICAgaW1kYlJhdGluZzogXCJcIixcbiAgICBpbWRiVm90ZXM6IFwiXCIsXG4gICAgdHlwZTogXCJcIixcbiAgICBkdmQ6IFwiXCIsXG4gICAgYm94T2ZmaWNlOiBcIlwiLFxuICAgIHByb2R1Y3Rpb246IFwiXCIsXG4gICAgd2Vic2l0ZTogXCJcIixcbiAgICB0b3RhbFNlYXNvbnM6IFwiXCIsXG4gICAgdG9tYXRvVVJMOiBcIlwiLFxuICAgIHRvbWF0b01ldGVyOiBcIlwiLFxuICAgIHRvbWF0b0ltYWdlOiBcIlwiLFxuICAgIHRvbWF0b1JhdGluZzogXCJcIixcbiAgICB0b21hdG9SZXZpZXdzOiBcIlwiLFxuICAgIHRvbWF0b0ZyZXNoOiBcIlwiLFxuICAgIHRvbWF0b1JvdHRlbjogXCJcIixcbiAgICB0b21hdG9Db25zZW5zdXM6IFwiXCIsXG4gICAgdG9tYXRvVXNlck1ldGVyOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJSYXRpbmc6IFwiXCIsXG4gICAgdG9tYXRvVXNlclJldmlld3M6IFwiXCIsXG4gICAgc3RhclJhdGluZzogMCxcbiAgICB3YXRjaGVkOiBmYWxzZSxcbiAgICBub3RlczogXCJcIlxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdERhdGEoKTogQ2luZVZhdWx0RGF0YSB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgcmV0dXJuIHtcbiAgICBzY2hlbWFWZXJzaW9uOiAxLFxuICAgIGNyZWF0ZWRBdDogbm93LFxuICAgIHVwZGF0ZWRBdDogbm93LFxuICAgIGxpYnJhcnlOYW1lOiBcIkNpbmVWYXVsdFwiLFxuICAgIG93bmVyOiBcIlwiLFxuICAgIHNvdXJjZTogXCJDaW5lVmF1bHRcIixcbiAgICBtb3ZpZXM6IFtdXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVEYXRhKGRhdGE6IENpbmVWYXVsdERhdGEpOiBDaW5lVmF1bHREYXRhIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIG1vdmllczogZGF0YS5tb3ZpZXMubWFwKChtb3ZpZSkgPT4gKHtcbiAgICAgIC4uLmNyZWF0ZUVtcHR5TW92aWUoKSxcbiAgICAgIC4uLm1vdmllLFxuICAgICAgeWVhcjogbW92aWUueWVhciA/IFN0cmluZyhtb3ZpZS55ZWFyKSA6IFwiXCIsXG4gICAgICBzdGFyUmF0aW5nOiB0eXBlb2YgbW92aWUuc3RhclJhdGluZyA9PT0gXCJudW1iZXJcIiA/IG1vdmllLnN0YXJSYXRpbmcgOiAwXG4gICAgfSkpXG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbnN1cmVGb2xkZXIoYXBwOiBBcHAsIGZvbGRlcj86IHN0cmluZykge1xuICBjb25zdCBmb2xkZXJQYXRoID0gZ2V0Rm9sZGVyKGZvbGRlcik7XG4gIGlmICghYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKSkge1xuICAgIGF3YWl0IGFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUpzb25GaWxlKGFwcDogQXBwLCBmb2xkZXI/OiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlPiB7XG4gIGNvbnN0IGZvbGRlclBhdGggPSBnZXRGb2xkZXIoZm9sZGVyKTtcbiAgYXdhaXQgZW5zdXJlRm9sZGVyKGFwcCwgZm9sZGVyKTtcbiAgY29uc3QgZXhpc3RpbmcgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGdldERlZmF1bHRQYXRoKGZvbGRlcikpO1xuICBjb25zdCBmaWxlbmFtZSA9IGV4aXN0aW5nID8gYGJveG9mZmljZS0ke0RhdGUubm93KCl9Lmpzb25gIDogREVGQVVMVF9OQU1FO1xuICBjb25zdCBwYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtmaWxlbmFtZX1gO1xuXG4gIHJldHVybiBhcHAudmF1bHQuY3JlYXRlKHBhdGgsIEpTT04uc3RyaW5naWZ5KGNyZWF0ZURlZmF1bHREYXRhKCksIG51bGwsIDIpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRMb2NhbEZpbGUoYXBwOiBBcHAsIGZpbGU6IFRGaWxlKTogUHJvbWlzZTxDaW5lVmF1bHREYXRhPiB7XG4gIGNvbnN0IHJhdyA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJhdykgYXMgQ2luZVZhdWx0RGF0YTtcbiAgaWYgKCFwYXJzZWQgfHwgIUFycmF5LmlzQXJyYXkocGFyc2VkLm1vdmllcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGb3JtYXRvIEpTT04gbm9uIHZhbGlkb1wiKTtcbiAgfVxuICByZXR1cm4gbm9ybWFsaXplRGF0YShwYXJzZWQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUxvY2FsRGF0YShhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGRhdGE6IENpbmVWYXVsdERhdGEpIHtcbiAgYXdhaXQgYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XG59XG4iLCAiaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgeyBDaW5lVmF1bHRTZWFyY2hJdGVtLCBPbWRiRGV0YWlsZWRSZXNwb25zZSB9IGZyb20gXCIuLi90eXBlcy9jaW5ldmF1bHRcIjtcbmltcG9ydCB7IE9NREJfVVJMIH0gZnJvbSBcInNyYy9jb25zdGFudHNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaE9tZGIocXVlcnk6IHN0cmluZywgYXBpS2V5OiBzdHJpbmcsIHR5cGU/OiBzdHJpbmcsIHllYXI/OiBzdHJpbmcpOiBQcm9taXNlPENpbmVWYXVsdFNlYXJjaEl0ZW1bXT4ge1xuICBpZiAoIWFwaUtleSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgbGV0IHVybCA9IGAke09NREJfVVJMfS8/YXBpa2V5PSR7YXBpS2V5fSZzPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX1gO1xuICAgIGlmICh0eXBlKSB7XG4gICAgICB1cmwgKz0gYCZ0eXBlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHR5cGUpfWA7XG4gICAgfVxuICAgIGlmICh5ZWFyKSB7XG4gICAgICB1cmwgKz0gYCZ5PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHllYXIpfWA7XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh1cmwpO1xuXG4gICAgY29uc29sZS5sb2cocmVzcG9uc2UpXG5cbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbiBhcyB7XG4gICAgICBTZWFyY2g/OiBBcnJheTx7IFRpdGxlOiBzdHJpbmc7IFllYXI6IHN0cmluZzsgaW1kYklEOiBzdHJpbmc7IFR5cGU6IHN0cmluZzsgUG9zdGVyOiBzdHJpbmc7IH0+O1xuICAgIH07XG5cbiAgICBjb25zb2xlLmxvZyhkYXRhKVxuXG4gICAgaWYgKGRhdGE/LlNlYXJjaCkge1xuICAgICAgcmV0dXJuIGRhdGEuU2VhcmNoLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgaW1kYklkOiBpdGVtLmltZGJJRCxcbiAgICAgICAgdGl0bGU6IGl0ZW0uVGl0bGUsXG4gICAgICAgIHllYXI6IGl0ZW0uWWVhcixcbiAgICAgICAgdHlwZTogaXRlbS5UeXBlLFxuICAgICAgICBwb3N0ZXI6IGl0ZW0uUG9zdGVyICYmIGl0ZW0uUG9zdGVyICE9PSBcIk4vQVwiID8gaXRlbS5Qb3N0ZXIgOiBcIlwiLFxuICAgICAgfSkpO1xuICAgIH1cblxuICAgIHJldHVybiBbXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VhcmNoaW5nIE9NRGI6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9tZGJEZXRhaWxzKGltZGJJZDogc3RyaW5nLCBhcGlLZXk6IHN0cmluZywgZGVwdGg6IG51bWJlciA9IDApOiBQcm9taXNlPE9tZGJEZXRhaWxlZFJlc3BvbnNlIHwgbnVsbD4ge1xuICAvLyBSZXRyeSBsaW1pdFxuICBpZiAoZGVwdGggPj0gMykge1xuICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBmZXRjaCBtb3ZpZSBkZXRhaWxzIGFmdGVyICR7ZGVwdGh9IGF0dGVtcHRzYCk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBpZiAoIWFwaUtleSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBgJHtPTURCX1VSTH0vP2FwaWtleT0ke2FwaUtleX0maT0ke2ltZGJJZH0mcGxvdD1mdWxsJnRvbWF0b2VzPXRydWVgO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh1cmwpO1xuXG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb24gYXMgT21kYkRldGFpbGVkUmVzcG9uc2UgJiB7IFJlc3BvbnNlOiBzdHJpbmcgfTtcblxuICAgIGlmIChkYXRhLlJlc3BvbnNlICE9PSBcIlRydWVcIikge1xuICAgICAgY29uc29sZS5lcnJvcihcIk9NRGIgQVBJIHJldHVybmVkIGVycm9yIHJlc3BvbnNlXCIsIGRhdGEpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIG1vdmllIGRldGFpbHMsIHJldHJ5aW5nLi4uXCIsIGVycm9yKTtcbiAgICByZXR1cm4gZ2V0T21kYkRldGFpbHMoaW1kYklkLCBhcGlLZXksIGRlcHRoICsgMSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE5vdGljZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBQbHVnaW5WaWV3IGZyb20gXCIuLi92aWV3cy9QbHVnaW5WaWV3XCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0RGF0YSwgY3JlYXRlSnNvbkZpbGUsIGdldERlZmF1bHRQYXRoLCBnZXRGb2xkZXIsIHNhdmVMb2NhbERhdGEgfSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2luZVZhdWx0U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IENpbmVWYXVsdFBsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gIH1cblxuICBkaXNwbGF5KCk6IHZvaWQge1xuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgLy8gQ29uZmlndXJhdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQ29uZmlndXJhdGlvblwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIk9NRGIgQVBJIGtleVwiKVxuICAgICAgLnNldERlc2MoXCJFbnRlciB5b3VyIE9NRGIgQVBJIGtleS4gWW91IGNhbiBnZXQgb25lIGZvciBmcmVlIGF0IG9tZGJhcGkuY29tXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgeW91ciBBUEkga2V5XCIpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5vbWRiQXBpS2V5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0T21kYkFwaUtleSh2YWx1ZSk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJMaWJyYXJ5IGZvbGRlclwiKVxuICAgICAgLnNldERlc2MoXCJUaGUgZm9sZGVyIHdoZXJlIHRoZSBwbHVnaW4gd2lsbCBzdG9yZSBsaWJyYXJ5IGZpbGVzXCIpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiRm9sZGVyIG5hbWVcIilcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBmb2xkZXIgPSB2YWx1ZS50cmltKCkgfHwgXCJCb3hPZmZpY2VcIjtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMaWJyYXJ5Rm9sZGVyKGZvbGRlcik7XG4gICAgICAgIH0pKTtcblxuICAgIC8vIEV4dGVybmFsIGxpYnJhcnkgc3VwcG9ydCByZW1vdmVkLlxuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkxpbmtlZCBsb2NhbCBsaWJyYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcbiAgICAgICAgdGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aFxuICAgICAgICAgID8gYExvY2FsIGZpbGU6ICR7dGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aH1gXG4gICAgICAgICAgOiBcIk5vIGxvY2FsIGxpYnJhcnkgbGlua2VkXCJcbiAgICAgIClcbiAgICAgIC5hZGREcm9wZG93bihkcm9wID0+IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcigoZikgPT4gZi5leHRlbnNpb24gPT09IFwianNvblwiKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgXCJcIjogXCItLSBOb25lIC0tXCIgfTtcbiAgICAgICAgZmlsZXMuZm9yRWFjaCgoZikgPT4gKG9wdGlvbnNbZi5wYXRoXSA9IGYucGF0aCkpO1xuICAgICAgICBkcm9wLmFkZE9wdGlvbnMob3B0aW9ucykuc2V0VmFsdWUodGhpcy5wbHVnaW4ubG9jYWxKc29uUGF0aCA/PyBcIlwiKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBwYXRoID0gdmFsdWUgfHwgbnVsbDtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKHBhdGgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJVbmxpbmsgbG9jYWxcIilcbiAgICAgICAgLnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChudWxsKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hPcGVuVmlld3MoKTtcbiAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkNyZWF0ZSBuZXcgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJDcmVhdGUgYSBuZXcgZW1wdHkgbG9jYWwgbGlicmFyeSBmcm9tIHNjcmF0Y2guIFRoaXMgd2lsbCB1bmxpbmsgYW55IGV4dGVybmFsIGxpYnJhcnkuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDcmVhdGUgbGlicmFyeVwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVOZXdMaWJyYXJ5KCk7XG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoXCJFeHBvcnQgbGlicmFyeVwiKVxuICAgICAgLnNldERlc2MoXCJTYXZlIGEgY29weSBvZiB5b3VyIGxpYnJhcnkgSlNPTiB0byBhIGZpbGUuXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJFeHBvcnQgSlNPTlwiKVxuICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5leHBvcnRMaWJyYXJ5SnNvbigpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBCdWdmaXhcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkJ1Z2ZpeFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIlJlcG9ydCBpc3N1ZXNcIilcbiAgICAgIC5zZXREZXNjKFwiSWYgeW91IGVuY291bnRlciBhbnkgaXNzdWVzIHdpdGggdGhlIHBsdWdpbiwgcGxlYXNlIHJlcG9ydCB0aGVtLiBZb3VyIGZlZWRiYWNrIGlzIGludmFsdWFibGUgZm9yIGltcHJvdmluZyBCb3hPZmZpY2UhXCIpXG4gICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHaXRIdWJcIilcbiAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgIHdpbmRvdy5vcGVuKFwiaHR0cHM6Ly9naXRodWIuY29tL3ZzY2FwZXJyb3R0YS9vYnNpZGlhbi1jaW5ldmF1bHQvaXNzdWVzXCIsIFwiX2JsYW5rXCIpO1xuICAgICAgICB9KSk7XG5cbiAgICAvLyBTdXBwb3J0IGFuZCBkb25hdGlvblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiU3VwcG9ydFwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkRvbmF0ZVwiKVxuICAgICAgLnNldERlc2MoXG4gICAgICAgIFwiSWYgeW91IGxpa2UgdGhpcyBwbHVnaW4sIGNvbnNpZGVyIGRvbmF0aW5nIHRvIHN1cHBvcnQgY29udGludWVkIGRldmVsb3BtZW50LlwiXG4gICAgICApXG4gICAgICAuYWRkQnV0dG9uKChidCkgPT4ge1xuICAgICAgICBidC5idXR0b25FbC5vdXRlckhUTUwgPVxuICAgICAgICAgIFwiPGEgaHJlZj0naHR0cHM6Ly9rby1maS5jb20vVDZUMDFUWDgwNycgdGFyZ2V0PSdfYmxhbmsnPjxpbWcgaGVpZ2h0PSczNicgc3R5bGU9J2JvcmRlcjowcHg7aGVpZ2h0OjM2cHg7JyBzcmM9J2h0dHBzOi8vc3RvcmFnZS5rby1maS5jb20vY2RuL2tvZmk2LnBuZz92PTYnIGJvcmRlcj0nMCcgYWx0PSdCdXkgTWUgYSBDb2ZmZWUgYXQga28tZmkuY29tJyAvPjwvYT5cIjtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBleHBvcnRMaWJyYXJ5SnNvbigpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuZ2V0TGlicmFyeUpzb25Db250ZW50KCk7XG4gICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgbmV3IE5vdGljZShcIk5vIGxpYnJhcnkgZmlsZSBmb3VuZCB0byBleHBvcnQuXCIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBleHBvcnQgZmlsZSBpbnNpZGUgdmF1bHQgZm9yIG1vYmlsZSBjb21wYXRpYmlsaXR5XG4gICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkucmVwbGFjZSgvWzouXS9nLCBcIi1cIikuc2xpY2UoMCwgMTkpO1xuICAgICAgY29uc3QgZXhwb3J0UGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS5qc29uYDtcblxuICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMsIGlmIHNvIGFkZCBhIGNvdW50ZXJcbiAgICAgIGxldCBmaW5hbFBhdGggPSBleHBvcnRQYXRoO1xuICAgICAgbGV0IGNvdW50ZXIgPSAxO1xuICAgICAgd2hpbGUgKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaW5hbFBhdGgpKSB7XG4gICAgICAgIGZpbmFsUGF0aCA9IGBib3hvZmZpY2UtZXhwb3J0LSR7dGltZXN0YW1wfS0ke2NvdW50ZXJ9Lmpzb25gO1xuICAgICAgICBjb3VudGVyKys7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaW5hbFBhdGgsIGNvbnRlbnQpO1xuICAgICAgbmV3IE5vdGljZShgTGlicmFyeSBleHBvcnRlZCB0byAke2ZpbmFsUGF0aH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIltCb3hPZmZpY2VdIEV4cG9ydCBsaWJyYXJ5IGVycm9yXCIsIGVycm9yKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJVbmFibGUgdG8gZXhwb3J0IHRoZSBsaWJyYXJ5LlwiKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0xpYnJhcnkoKSB7XG4gICAgY29uc3QgY29uZmlybWVkID0gd2luZG93LmNvbmZpcm0oXG4gICAgICBcIkNyZWF0ZSBhIG5ldyBlbXB0eSBCb3hPZmZpY2UgbGlicmFyeT8gVGhpcyB3aWxsIHVubGluayBhbnkgZXh0ZXJuYWwgbGlicmFyeSBhbmQgcmVzZXQgeW91ciBsb2NhbCBsaWJyYXJ5IGRhdGEuXCJcbiAgICApO1xuICAgIGlmICghY29uZmlybWVkKSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVmYXVsdEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZ2V0RGVmYXVsdFBhdGgodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcikpO1xuICAgICAgbGV0IGNyZWF0ZWRGaWxlOiBURmlsZSB8IHVuZGVmaW5lZDtcbiAgICAgIGlmIChkZWZhdWx0RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5hcHAsIGRlZmF1bHRGaWxlLCBjcmVhdGVEZWZhdWx0RGF0YSgpKTtcbiAgICAgICAgY3JlYXRlZEZpbGUgPSBkZWZhdWx0RmlsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNyZWF0ZWRGaWxlID0gYXdhaXQgY3JlYXRlSnNvbkZpbGUodGhpcy5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3JlYXRlZEZpbGUpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aChjcmVhdGVkRmlsZS5wYXRoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICBuZXcgTm90aWNlKFwiTmV3IGxpYnJhcnkgY3JlYXRlZC5cIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQm94T2ZmaWNlXSBDcmVhdGUgbmV3IGxpYnJhcnkgZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBjcmVhdGUgYSBuZXcgbGlicmFyeS5cIik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRMaWJyYXJ5SnNvbkNvbnRlbnQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gUHJlZmVyIGEgbG9jYWwgbGlua2VkIGZpbGUgaW5zaWRlIHRoZSB2YXVsdFxuICAgIGlmICh0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoKSB7XG4gICAgICBjb25zdCBsb2NhbFBhdGggPSB0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoO1xuICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBkZWZhdWx0RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aCh0aGlzLnBsdWdpbi5saWJyYXJ5Rm9sZGVyKSk7XG4gICAgaWYgKGRlZmF1bHRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGRlZmF1bHRGaWxlKTtcbiAgICB9XG5cbiAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcik7XG4gICAgY29uc3QgZmFsbGJhY2sgPSB0aGlzLmFwcC52YXVsdFxuICAgICAgLmdldEZpbGVzKClcbiAgICAgIC5maW5kKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIgJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoYCR7Zm9sZGVyfS9gKSk7XG5cbiAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGZhbGxiYWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaE9wZW5WaWV3cygpIHtcbiAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRSk7XG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xuICAgICAgaWYgKGxlYWYudmlldyBpbnN0YW5jZW9mIFBsdWdpblZpZXcpIHtcbiAgICAgICAgYXdhaXQgbGVhZi52aWV3Lm9uT3BlbigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1Qjs7O0FDQWhCLElBQU0sT0FBTztBQUNiLElBQU0sWUFBWTtBQUNsQixJQUFNLFNBQVM7QUFDZixJQUFNLGFBQWEsQ0FBQyxTQUFTLFVBQVUsU0FBUztBQUNoRCxJQUFNLFdBQVc7OztBQ0p4QixJQUFBQyxtQkFBZ0U7OztBQ0F6RCxTQUFTLGlCQUNkLFdBQ0EsVUFDQSxRQUNBO0FBQ0EsUUFBTSxhQUFhLFVBQVUsVUFBVTtBQUFBLElBQ3JDLEtBQUs7QUFBQSxFQUNQLENBQUM7QUFFRCxRQUFNLFVBQVUsV0FBVyxVQUFVLEVBQUUsS0FBSyxvREFBb0QsQ0FBQztBQUNqRyxRQUFNLGVBQWUsUUFBUSxTQUFTLFVBQVUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzlFLGVBQWEsaUJBQWlCLFNBQVMsUUFBUTtBQUUvQyxNQUFJLFFBQVE7QUFDVixZQUFRLFNBQVMsS0FBSyxFQUFFLE1B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QUFnQjtBQUNyQixVQUFNLEtBQUssZUFBZTtBQUFBLEVBQzNCO0FBQUEsRUFFQSxNQUFNLGlCQUFpQixRQUFnQjtBQUN0QyxTQUFLLGdCQUFnQjtBQUNyQixVQUFNLEtBQUssZUFBZTtBQUFBLEVBQzNCO0FBQUE7QUFBQSxFQUdBLE1BQWMsYUFBYTtBQUMxQixVQUFNLGlCQUFpQixLQUFLLElBQUksVUFBVSxnQkFBZ0IsU0FBUztBQUNuRSxRQUFJLGVBQWUsU0FBUyxHQUFHO0FBQzlCLFdBQUssSUFBSSxVQUFVLFdBQVcsZUFBZSxDQUFDLENBQUM7QUFDL0M7QUFBQSxJQUNEO0FBRUEsVUFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVEsSUFBSTtBQUM1QyxVQUFNLEtBQUssYUFBYTtBQUFBLE1BQ3ZCLE1BQU07QUFBQSxNQUNOLFFBQVE7QUFBQSxJQUNULENBQUM7QUFBQSxFQUNGO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInR5cGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
