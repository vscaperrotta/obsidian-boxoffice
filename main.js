/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CineVaultPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/constants.ts
var VIEW_TYPE = "CineVaultView";
var OMDB_TYPES = ["movie", "series", "episode"];

// src/views/pluginView.ts
var import_obsidian5 = require("obsidian");

// src/ui/onboarding.ts
function renderOnboarding(container, onCreate, onLink) {
  const onboarding = container.createDiv({
    cls: "cinevault-onboarding"
  });
  const actions = onboarding.createDiv({ cls: "cinevault-onboarding-actions" });
  const createButton = actions.createEl("button", { text: "Create new library" });
  createButton.addEventListener("click", onCreate);
  if (onLink) {
    actions.createEl("p", { text: "or" });
    const linkButton = actions.createEl("button", { text: "Link existing library" });
    linkButton.addEventListener("click", onLink);
  }
}

// src/ui/modals/actionModal.ts
var import_obsidian = require("obsidian");
var CineVaultMovieActionModal = class extends import_obsidian.Modal {
  constructor(app, movie, onSave) {
    super(app);
    this.movie = movie;
    this.onSave = onSave;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", { text: this.movie.title });
    contentEl.createEl("p", { text: `${this.movie.year} \u2022 ${this.movie.type}` });
    if (this.movie.poster) {
      contentEl.createEl("img", { cls: "cinevault-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    contentEl.createEl("p", { text: this.movie.plot });
    const actions = contentEl.createDiv({ cls: "cinevault-modal-detail-actions" });
    const watchedButton = actions.createEl("button", { text: "Mark as watched" });
    const toWatchButton = actions.createEl("button", { text: "To watch" });
    watchedButton.addEventListener("click", () => {
      this.onSave(true);
      this.close();
    });
    toWatchButton.addEventListener("click", () => {
      this.onSave(false);
      this.close();
    });
  }
};

// src/ui/modals/detailModal.ts
var import_obsidian2 = require("obsidian");

// src/ui/starRating.ts
function createStarRating(container, rating, readOnly, onChange) {
  const stars = container.createDiv({ cls: "cinevault-stars" });
  const starElements = [];
  let currentRating = rating;
  for (let i = 1; i <= 5; i += 1) {
    const star = stars.createEl("span", { text: "\u2605", cls: "cinevault-star" });
    if (i <= rating)
      star.classList.add("active");
    starElements.push(star);
    if (!readOnly) {
      star.addEventListener("click", () => {
        if (currentRating === i) {
          currentRating = 0;
          starElements.forEach((element) => {
            element.classList.remove("active");
          });
        } else {
          currentRating = i;
          starElements.forEach((element, index) => {
            element.classList.toggle("active", index < i);
          });
        }
        onChange == null ? void 0 : onChange(currentRating);
      });
    } else {
      star.classList.add("readonly");
    }
  }
  return stars;
}

// src/utils/globalMethods.ts
function nullSafe(func, fallbackValue = null) {
  try {
    const value = func();
    return value === null || value === void 0 ? fallbackValue : value;
  } catch (e) {
    console.error("Error: ", e);
    return fallbackValue;
  }
}
function formatRating(rating) {
  let value = rating;
  const isPerTen = rating.includes("/10");
  const isPerCent = rating.includes("/100");
  if (isPerTen && !isPerCent) {
    const normalized = value.replace(",", ".");
    const num = parseFloat(normalized);
    if (!isNaN(num) && isFinite(num)) {
      const multiplied = num * 10;
      value = multiplied % 1 === 0 ? String(Math.trunc(multiplied)) : String(multiplied);
    }
  } else if (rating.includes("/") && isPerCent) {
    value = rating.split("/")[0].trim();
  } else if (rating.includes("%")) {
    value = rating.replace("%", "").trim();
  }
  return value;
}
function averageRating(ratings) {
  const normalizedRatings = ratings.map(formatRating).map((r) => parseFloat(r)).filter((r) => !isNaN(r) && isFinite(r));
  if (normalizedRatings.length === 0)
    return "N/A";
  const sum = normalizedRatings.reduce((acc, val) => acc + val, 0);
  const average = sum / normalizedRatings.length;
  return average % 1 === 0 ? String(Math.trunc(average)) : String(average.toFixed(1));
}
function renderExternalRatingBar(parent, ratings, options) {
  if (!ratings || ratings.length === 0)
    return null;
  const ratingBarContainer = parent.createDiv({ cls: "plugin-ratings-bar-container" });
  const ratingBar = ratingBarContainer.createDiv({ cls: "plugin-ratings-bar" });
  const ratingFill = ratingBar.createDiv({ cls: "plugin-ratings-fill" });
  const values = ratings.map((r) => formatRating(r.Value));
  const average = averageRating(values);
  const percentage = parseFloat(average);
  ratingFill.style.width = `${isNaN(percentage) ? 0 : percentage}%`;
  ratingBarContainer.createEl("span", {
    text: `${average}%`,
    cls: "plugin-ratings-average"
  });
  return {
    container: ratingBarContainer,
    average,
    percentage: isNaN(percentage) ? 0 : percentage
  };
}

// src/ui/modals/detailModal.ts
var CineVaultMovieDetailModal = class extends import_obsidian2.Modal {
  constructor(app, movie, onRate, onRemove, onToggleWatched) {
    super(app);
    this.movie = movie;
    this.onRate = onRate;
    this.onRemove = onRemove;
    this.onToggleWatched = onToggleWatched;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const modalContainer = contentEl.createDiv({
      cls: "cinevault-modal-detail-container"
    });
    const modalHeader = modalContainer.createDiv({
      cls: "cinevault-modal-detail-header"
    });
    const modalTitleContainer = modalHeader.createDiv({
      cls: "cinevault-modal-detail-title-container"
    });
    modalTitleContainer.createEl("h1", {
      text: this.movie.title,
      cls: "cinevault-modal-detail-title"
    });
    const type = nullSafe(() => this.movie.type[0].toUpperCase() + this.movie.type.slice(1), null);
    const year = nullSafe(() => this.movie.year, null);
    modalTitleContainer.createEl("p", {
      text: `${year} - ${type}`
    });
    modalTitleContainer.createEl("p", {
      text: "Directed by " + nullSafe(() => this.movie.director, "N/A")
    });
    modalTitleContainer.createEl("p", {
      text: "Duration " + nullSafe(() => this.movie.runtime, "N/A")
    });
    if (this.movie.poster) {
      modalHeader.createEl("img", { cls: "cinevault-modal-detail-poster" }).setAttribute("src", this.movie.poster);
    }
    if (this.movie.plot) {
      const plotContainer = modalContainer.createEl("div", { cls: "cinevault-modal-detail-plot-container" });
      const plotEl = plotContainer.createEl("p", {
        text: this.movie.plot,
        cls: "cinevault-modal-detail-plot"
      });
      const showMoreButton = plotContainer.createEl("button", {
        text: "Show more",
        cls: "cinevault-modal-detail-show-more cinevault-modal-detail-show-more-hidden"
      });
      showMoreButton.addEventListener("click", () => {
        const isExpanded = plotEl.classList.toggle("expanded-plot");
        showMoreButton.setText(isExpanded ? "Show less" : "Show more");
      });
      requestAnimationFrame(() => {
        if (plotEl.scrollHeight > plotEl.clientHeight + 1) {
          showMoreButton.removeClass("cinevault-modal-detail-show-more-hidden");
        }
      });
    }
    function rederDetailSection(type2, value) {
      const detailElement = modalContainer.createEl("div", { cls: "cinevault-modal-detail-detail-container" });
      detailElement.createEl("p", {
        text: `${type2}:`,
        cls: "cinevault-modal-detail-detail-label"
      });
      detailElement.createEl("p", {
        text: value,
        cls: "cinevault-modal-detail-detail-value"
      });
    }
    modalContainer.createEl("hr");
    if (this.movie.genre) {
      rederDetailSection("Genre", this.movie.genre);
    }
    if (this.movie.actors) {
      rederDetailSection("Actors", this.movie.actors);
    }
    modalContainer.createEl("hr");
    const ratingWrapper = modalContainer.createDiv({ cls: "cinevault-modal-detail-rating-wrapper" });
    const ratingContainer = ratingWrapper.createDiv({
      cls: "cinevault-modal-detail-rating-container"
    });
    ratingContainer.createEl("div", { text: "Rating", cls: "cinevault-modal-detail-rating-label" });
    createStarRating(ratingContainer, this.movie.starRating, false, (rating) => {
      this.onRate(rating);
    });
    if (this.movie.ratings) {
      const externalRatingsContainer = ratingWrapper.createDiv({ cls: "cinevault-modal-detail-rating-container" });
      externalRatingsContainer.createEl("div", {
        text: "External rating",
        cls: "cinevault-modal-detail-rating-label"
      });
      renderExternalRatingBar(externalRatingsContainer, this.movie.ratings);
      modalContainer.createEl("p", {
        text: "The external rating is an average based on votes from Internet Movie Database, Rotten Tomatoes and Metacritic",
        cls: "cinevault-modal-detail-rating-disclaimer"
      });
    }
    const actions = modalContainer.createDiv({ cls: "cinevault-modal-detail-actions" });
    const toggleWatchedLabel = this.movie.watched ? "Mark as to watch" : "Mark as watched";
    const toggleWatchedButton = actions.createEl("button", { text: toggleWatchedLabel });
    const removeButton = actions.createEl("button", { text: "Remove", cls: "cinevault-danger" });
    toggleWatchedButton.addEventListener("click", () => {
      this.onToggleWatched();
      this.close();
    });
    removeButton.addEventListener("click", () => {
      this.onRemove();
      this.close();
    });
  }
};

// src/ui/JsonFileSuggestModal.ts
var import_obsidian3 = require("obsidian");
var JsonFileSuggestModal = class extends import_obsidian3.SuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
    this.jsonFiles = this.app.vault.getFiles().filter((f) => f.extension === "json");
    this.setPlaceholder("Select a JSON file from your vault...");
  }
  getSuggestions(query) {
    const lowerQuery = query.toLowerCase();
    return this.jsonFiles.filter(
      (file) => file.path.toLowerCase().includes(lowerQuery)
    );
  }
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.path });
  }
  onChooseSuggestion(file, evt) {
    this.onSelect(file);
  }
};

// src/services/libraryStorage.ts
var FOLDER = "BoxOffice";
var DEFAULT_NAME = "libraryStorage.json";
function getDefaultPath(folder) {
  const folderPath = folder != null ? folder : FOLDER;
  return `${folderPath}/${DEFAULT_NAME}`;
}
function getFolder(folder) {
  return folder != null ? folder : FOLDER;
}
function createEmptyMovie() {
  return {
    id: crypto.randomUUID(),
    imdbId: "",
    title: "",
    year: "",
    rated: "",
    released: "",
    runtime: "",
    genre: "",
    director: "",
    writer: "",
    actors: "",
    plot: "",
    language: "",
    country: "",
    awards: "",
    poster: "",
    posterLocal: "",
    ratings: [],
    metascore: "",
    imdbRating: "",
    imdbVotes: "",
    type: "",
    dvd: "",
    boxOffice: "",
    production: "",
    website: "",
    totalSeasons: "",
    tomatoURL: "",
    tomatoMeter: "",
    tomatoImage: "",
    tomatoRating: "",
    tomatoReviews: "",
    tomatoFresh: "",
    tomatoRotten: "",
    tomatoConsensus: "",
    tomatoUserMeter: "",
    tomatoUserRating: "",
    tomatoUserReviews: "",
    starRating: 0,
    watched: false,
    notes: ""
  };
}
function createDefaultData() {
  const now = new Date().toISOString();
  return {
    schemaVersion: 1,
    createdAt: now,
    updatedAt: now,
    libraryName: "CineVault",
    owner: "",
    source: "CineVault",
    movies: []
  };
}
function normalizeData(data) {
  return {
    ...data,
    movies: data.movies.map((movie) => ({
      ...createEmptyMovie(),
      ...movie,
      year: movie.year ? String(movie.year) : "",
      starRating: typeof movie.starRating === "number" ? movie.starRating : 0
    }))
  };
}
async function ensureFolder(app, folder) {
  const folderPath = getFolder(folder);
  if (!app.vault.getAbstractFileByPath(folderPath)) {
    await app.vault.createFolder(folderPath);
  }
}
async function createJsonFile(app, folder) {
  const folderPath = getFolder(folder);
  await ensureFolder(app, folder);
  const existing = app.vault.getAbstractFileByPath(getDefaultPath(folder));
  const filename = existing ? `boxoffice-${Date.now()}.json` : DEFAULT_NAME;
  const path = `${folderPath}/${filename}`;
  return app.vault.create(path, JSON.stringify(createDefaultData(), null, 2));
}
async function loadLocalFile(app, file) {
  const raw = await app.vault.read(file);
  const parsed = JSON.parse(raw);
  if (!parsed || !Array.isArray(parsed.movies)) {
    throw new Error("Formato JSON non valido");
  }
  return normalizeData(parsed);
}
async function saveLocalData(app, file, data) {
  await app.vault.modify(file, JSON.stringify(data, null, 2));
}

// src/services/omdbService.ts
var import_obsidian4 = require("obsidian");
async function searchOmdb(query, apiKey, type, year) {
  if (!apiKey) {
    return [];
  }
  try {
    let url = `https://www.omdbapi.com/?apikey=${apiKey}&s=${encodeURIComponent(query)}`;
    if (type) {
      url += `&type=${encodeURIComponent(type)}`;
    }
    if (year) {
      url += `&y=${encodeURIComponent(year)}`;
    }
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data == null ? void 0 : data.Search) {
      return data.Search.map((item) => ({
        imdbId: item.imdbID,
        title: item.Title,
        year: item.Year,
        type: item.Type,
        poster: item.Poster && item.Poster !== "N/A" ? item.Poster : "",
        plot: ""
      }));
    }
    return [];
  } catch (error) {
    console.error("Error searching OMDb:", error);
    return [];
  }
}
async function getOmdbDetails(imdbId, apiKey, depth = 0) {
  if (depth >= 3) {
    console.error(`Failed to fetch movie details after ${depth} attempts`);
    return null;
  }
  if (!apiKey) {
    return null;
  }
  try {
    const url = `https://www.omdbapi.com/?apikey=${apiKey}&i=${imdbId}&plot=full&tomatoes=true`;
    const response = await (0, import_obsidian4.requestUrl)(url);
    const data = response.json;
    if (data.Response !== "True") {
      console.error("OMDb API returned error response", data);
      return null;
    }
    return data;
  } catch (error) {
    console.error("Error fetching movie details, retrying...", error);
    return getOmdbDetails(imdbId, apiKey, depth + 1);
  }
}

// src/views/pluginView.ts
var CineVaultView = class extends import_obsidian5.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.file = null;
    this.data = null;
    this.activeTab = "toWatch";
    this.moviesContainer = null;
    this.viewMode = "grid";
    this.plugin = plugin;
  }
  getViewType() {
    return VIEW_TYPE;
  }
  getDisplayText() {
    return "BoxOffice";
  }
  // Provide a custom icon for the view's tab
  getIcon() {
    return "clapperboard";
  }
  async onOpen() {
    var _a;
    this.viewMode = (_a = this.plugin.viewMode) != null ? _a : "grid";
    await this.initializeData();
    await this.render();
  }
  async render() {
    const container = this.containerEl.children[1];
    container.empty();
    const header = container.createDiv({ cls: "cinevault-header" });
    header.createEl("h1", {
      text: "BoxOffice",
      cls: "cinevault-title"
    });
    header.createEl("p", {
      text: "This plugin allow you to manage your favorites movie and tv library into your vault.\nSearch OMDb, rate titles, and store your collection in a json file within your vault or in a separate vault.",
      cls: "cinevault-header-text"
    });
    if (!this.data) {
      renderOnboarding(container, async () => {
        this.file = await createJsonFile(this.plugin.app, this.plugin.libraryFolder);
        if (this.file) {
          await this.plugin.setLocalJsonPath(this.file.path);
        }
        await this.loadFile(this.file);
        await this.render();
      }, () => {
        new JsonFileSuggestModal(this.plugin.app, async (file) => {
          await this.loadFile(file);
          await this.render();
        }).open();
      });
      return;
    }
    const searchBox = container.createDiv({ cls: "cinevault-search" });
    const searchInputsGroup = searchBox.createDiv({ cls: "cinevault-search-inputs-group" });
    const searchInputContainer = searchInputsGroup.createDiv({ cls: "cinevault-search-input-container" });
    const searchInput = searchInputContainer.createEl("input", {
      cls: "cinevault-search-input",
      attr: {
        placeholder: "Search"
      }
    });
    const filterSwitch = searchInputContainer.createEl("button", {
      cls: "cinevault-search-clear",
      attr: {
        "aria-label": "More filter",
        title: "More filter"
      }
    });
    (0, import_obsidian5.setIcon)(filterSwitch, "sliders-horizontal");
    const moreFilterContainer = searchInputsGroup.createDiv({ cls: "cinevault-more-filter" });
    moreFilterContainer.style.display = "none";
    filterSwitch.addEventListener("click", () => {
      if (moreFilterContainer.style.display === "none") {
        moreFilterContainer.style.display = "flex";
      } else {
        moreFilterContainer.style.display = "none";
      }
    });
    const yearInput = moreFilterContainer.createEl("input", {
      cls: "cinevault-search-input",
      attr: { placeholder: "Year" }
    });
    const typeSelect = moreFilterContainer.createEl("select", { cls: "cinevault-search-select" });
    typeSelect.createEl("option", {
      text: "All",
      attr: {
        value: "",
        placeholder: "Type"
      }
    });
    OMDB_TYPES.forEach((t) => {
      typeSelect.createEl("option", {
        text: t[0].toUpperCase() + t.slice(1),
        attr: { value: t }
      });
    });
    let resultsList = null;
    const content = container.createDiv({ cls: "cinevault-content" });
    this.moviesContainer = content;
    this.renderMovies(content);
    let searchTimeout = null;
    const runSearch = async () => {
      const query = searchInput.value.trim();
      if (!query)
        return;
      const type = typeSelect.value || void 0;
      const year = yearInput.value.trim() || void 0;
      const results = await searchOmdb(query, this.plugin.omdbApiKey, type, year);
      if (!results || results.length === 0) {
        if (!resultsList)
          resultsList = searchBox.createDiv({ cls: "cinevault-search-results" });
        resultsList.empty();
        resultsList.createEl("div", { text: "No results found.", cls: "cinevault-search-empty" });
        return;
      }
      if (!resultsList)
        resultsList = searchBox.createDiv({ cls: "cinevault-search-results" });
      await this.renderSearchResults(resultsList, results);
    };
    searchInput.addEventListener("input", () => {
      if (!searchInput.value.trim()) {
        if (resultsList) {
          resultsList.empty();
          resultsList.remove();
          resultsList = null;
        }
        if (searchTimeout) {
          window.clearTimeout(searchTimeout);
          searchTimeout = null;
        }
        return;
      }
      if (searchTimeout)
        window.clearTimeout(searchTimeout);
      searchTimeout = window.setTimeout(runSearch, 350);
    });
    yearInput.addEventListener("input", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
    typeSelect.addEventListener("change", async () => {
      if (!searchInput.value.trim())
        return;
      await runSearch();
    });
  }
  renderMovies(container) {
    container.empty();
    if (!this.data) {
      container.createEl("p", { text: "No library loaded." });
      return;
    }
    const watched = this.data.movies.filter((movie) => movie.watched);
    const toWatch = this.data.movies.filter((movie) => !movie.watched);
    const tabsContainer = container.createDiv({ cls: "cinevault-tabs-container" });
    const tabHeader = tabsContainer.createDiv({ cls: "cinevault-tab-header" });
    const tabButtons = tabHeader.createDiv({ cls: "cinevault-tab-buttons" });
    const viewToggle = tabHeader.createDiv({ cls: "cinevault-view-toggle" });
    const toWatchButton = tabButtons.createEl("button", {
      cls: "cinevault-tab-button",
      text: `To Watch (${toWatch.length})`
    });
    const watchedButton = tabButtons.createEl("button", {
      cls: "cinevault-tab-button",
      text: `Watched (${watched.length})`
    });
    const gridButton = viewToggle.createEl("button", {
      cls: "cinevault-view-button",
      attr: { "aria-label": "Grid view", title: "Grid view" }
    });
    const listButton = viewToggle.createEl("button", {
      cls: "cinevault-view-button",
      attr: { "aria-label": "List view", title: "List view" }
    });
    (0, import_obsidian5.setIcon)(gridButton, "layout-grid");
    (0, import_obsidian5.setIcon)(listButton, "list");
    if (this.activeTab === "toWatch") {
      toWatchButton.classList.add("cinevault-tab-button-active");
    } else {
      watchedButton.classList.add("cinevault-tab-button-active");
    }
    if (this.viewMode === "grid") {
      gridButton.classList.add("cinevault-view-button-active");
    } else {
      listButton.classList.add("cinevault-view-button-active");
    }
    const tabContent = tabsContainer.createDiv({ cls: "cinevault-tab-content" });
    const activeMovies = this.activeTab === "toWatch" ? toWatch : watched;
    const activeTitle = this.activeTab === "toWatch" ? "To Watch" : "Watched";
    this.renderMovieSection(tabContent, activeTitle, activeMovies);
    toWatchButton.addEventListener("click", () => {
      if (this.activeTab === "toWatch")
        return;
      this.activeTab = "toWatch";
      this.renderMovies(container);
    });
    watchedButton.addEventListener("click", () => {
      if (this.activeTab === "watched")
        return;
      this.activeTab = "watched";
      this.renderMovies(container);
    });
    gridButton.addEventListener("click", async () => {
      if (this.viewMode === "grid")
        return;
      this.viewMode = "grid";
      await this.plugin.setViewMode("grid");
      this.renderMovies(container);
    });
    listButton.addEventListener("click", async () => {
      if (this.viewMode === "list")
        return;
      this.viewMode = "list";
      await this.plugin.setViewMode("list");
      this.renderMovies(container);
    });
  }
  renderMovieSection(container, title, movies) {
    const section = container.createDiv({ cls: "cinevault-section" });
    if (movies.length === 0) {
      section.createEl("p", { text: "No movies in this list." });
      return;
    }
    const list = section.createDiv({
      cls: this.viewMode === "grid" ? "cinevault-movie-grid" : "cinevault-movie-list"
    });
    if (this.viewMode === "grid") {
      this.renderMovieGrid(list, movies);
    } else {
      this.renderMovieList(list, movies);
    }
  }
  renderMovieGrid(container, movies) {
    movies.forEach((movie) => {
      const card = container.createDiv({ cls: "cinevault-movie-card" });
      card.createEl("img", { cls: "cinevault-movie-poster" }).setAttribute("src", movie.poster);
      card.createEl("div", { text: movie.title, cls: "cinevault-movie-title" });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year)
        detailsParts.push(year);
      if (type)
        detailsParts.push(type);
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        card.createEl("div", { text: detailsText, cls: "cinevault-movie-year" });
      }
      if (movie.watched) {
        createStarRating(card, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(card, movie.ratings);
        }
      }
      card.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  renderMovieList(container, movies) {
    movies.forEach((movie) => {
      const row = container.createDiv({
        cls: "cinevault-movie-row"
      });
      const poster = row.createEl("img", {
        cls: "cinevault-movie-thumbnail"
      });
      poster.setAttribute("src", movie.poster || "");
      const info = row.createDiv({
        cls: "cinevault-movie-info"
      });
      info.createEl("div", {
        text: movie.title,
        cls: "cinevault-movie-title"
      });
      const detailsParts = [];
      const year = nullSafe(() => movie.year, null);
      const type = nullSafe(() => movie.type[0].toUpperCase() + movie.type.slice(1), null);
      if (year) {
        detailsParts.push(year);
      }
      ;
      if (type) {
        detailsParts.push(type);
      }
      ;
      const detailsText = detailsParts.join(" - ");
      if (detailsText) {
        info.createEl("div", {
          text: detailsText,
          cls: "cinevault-movie-year"
        });
      }
      if (movie.watched) {
        createStarRating(info, movie.starRating, true);
      } else {
        if (movie.ratings && movie.ratings.length) {
          renderExternalRatingBar(info, movie.ratings);
        }
      }
      row.addEventListener("click", () => this.openMovieDetails(movie));
    });
  }
  openMovieDetails(movie) {
    new CineVaultMovieDetailModal(this.plugin.app, movie, async (rating) => {
      if (!this.data)
        return;
      movie.starRating = rating;
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      this.data.movies = this.data.movies.filter((item) => item.id !== movie.id);
      await this.saveData();
      this.refreshMovies();
    }, async () => {
      if (!this.data)
        return;
      movie.watched = !movie.watched;
      await this.saveData();
      this.refreshMovies();
    }).open();
  }
  refreshMovies() {
    if (!this.moviesContainer)
      return;
    this.renderMovies(this.moviesContainer);
  }
  getJsonFiles() {
    return this.plugin.app.vault.getFiles().filter((file) => file.extension === "json");
  }
  async initializeData() {
    const localPath = this.plugin.localJsonPath;
    if (localPath) {
      const localFile = this.plugin.app.vault.getAbstractFileByPath(localPath);
      if (localFile instanceof import_obsidian5.TFile) {
        await this.loadFile(localFile);
        return;
      }
    }
    this.file = null;
    this.data = null;
  }
  async loadFile(file) {
    try {
      const parsed = await loadLocalFile(this.plugin.app, file);
      this.file = file;
      this.data = parsed;
      await this.plugin.setLocalJsonPath(file.path);
    } catch (error) {
      this.data = null;
      this.file = null;
      new import_obsidian5.Notice("Unable to read the JSON file.");
    }
  }
  async saveData() {
    if (!this.data)
      return;
    this.data.updatedAt = new Date().toISOString();
    if (this.file) {
      await saveLocalData(this.plugin.app, this.file, this.data);
    }
  }
  async renderSearchResults(container, results) {
    container.empty();
    results.forEach((result) => {
      const item = container.createDiv({ cls: "cinevault-search-item" });
      if (result.poster) {
        item.createEl("img", { cls: "cinevault-search-poster" }).setAttribute("src", result.poster);
      }
      const info = item.createDiv({ cls: "cinevault-search-info" });
      info.createEl("div", { text: result.title, cls: "cinevault-search-title" });
      info.createEl("div", { text: result.year, cls: "cinevault-search-year" });
      item.addEventListener("click", () => {
        new CineVaultMovieActionModal(this.plugin.app, result, async (watched) => {
          if (!this.data)
            return;
          const existing = this.data.movies.find((movie) => movie.imdbId === result.imdbId);
          if (existing) {
            existing.watched = watched;
          } else {
            new import_obsidian5.Notice(`Loading details for ${result.title}...`);
            const details = await getOmdbDetails(result.imdbId, this.plugin.omdbApiKey);
            if (!details) {
              new import_obsidian5.Notice("Unable to load movie details.");
              return;
            }
            const newMovie = createEmptyMovie();
            newMovie.imdbId = details.imdbID || result.imdbId;
            newMovie.title = details.Title || result.title;
            newMovie.year = details.Year || result.year;
            newMovie.rated = details.Rated || "";
            newMovie.released = details.Released || "";
            newMovie.runtime = details.Runtime || "";
            newMovie.genre = details.Genre || "";
            newMovie.director = details.Director || "";
            newMovie.writer = details.Writer || "";
            newMovie.actors = details.Actors || "";
            newMovie.plot = details.Plot || result.plot;
            newMovie.language = details.Language || "";
            newMovie.country = details.Country || "";
            newMovie.awards = details.Awards || "";
            newMovie.poster = details.Poster && details.Poster !== "N/A" ? details.Poster : result.poster;
            newMovie.posterLocal = "";
            newMovie.ratings = details.Ratings || [];
            newMovie.metascore = details.Metascore || "";
            newMovie.imdbRating = details.imdbRating || "";
            newMovie.imdbVotes = details.imdbVotes || "";
            newMovie.type = details.Type || result.type;
            newMovie.dvd = details.DVD || "";
            newMovie.boxOffice = details.BoxOffice || "";
            newMovie.production = details.Production || "";
            newMovie.website = details.Website || "";
            newMovie.totalSeasons = details.totalSeasons || "";
            newMovie.watched = watched;
            this.data.movies.push(newMovie);
          }
          await this.saveData();
          this.render();
        }).open();
      });
    });
  }
};

// src/settings/settingsTab.ts
var import_obsidian6 = require("obsidian");
var CineVaultSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian6.Setting(containerEl).setName("Configuration").setHeading();
    new import_obsidian6.Setting(containerEl).setName("OMDb API key").setDesc("Enter your OMDb API key. You can get one for free at omdbapi.com").addText((text) => text.setPlaceholder("Enter your API key").setValue(this.plugin.omdbApiKey).onChange(async (value) => {
      await this.plugin.setOmdbApiKey(value);
    }));
    new import_obsidian6.Setting(containerEl).setName("Library folder").setDesc("The folder where the plugin will store library files").addText((text) => text.setPlaceholder("Folder name").setValue(this.plugin.libraryFolder).onChange(async (value) => {
      const folder = value.trim() || "BoxOffice";
      await this.plugin.setLibraryFolder(folder);
    }));
    new import_obsidian6.Setting(containerEl).setName("Linked local library").setDesc(
      this.plugin.localJsonPath ? `Local file: ${this.plugin.localJsonPath}` : "No local library linked"
    ).addDropdown((drop) => {
      var _a;
      const files = this.app.vault.getFiles().filter((f) => f.extension === "json");
      const options = { "": "-- None --" };
      files.forEach((f) => options[f.path] = f.path);
      drop.addOptions(options).setValue((_a = this.plugin.localJsonPath) != null ? _a : "").onChange(async (value) => {
        const path = value || null;
        await this.plugin.setLocalJsonPath(path);
        await this.refreshOpenViews();
        this.display();
      });
    }).addButton((button) => button.setButtonText("Unlink local").setDisabled(!this.plugin.localJsonPath).onClick(async () => {
      await this.plugin.setLocalJsonPath(null);
      await this.refreshOpenViews();
      this.display();
    }));
    new import_obsidian6.Setting(containerEl).setName("Create new library").setDesc("Create a new empty local library from scratch. This will unlink any external library.").addButton((button) => button.setButtonText("Create library").onClick(async () => {
      await this.createNewLibrary();
    }));
    new import_obsidian6.Setting(containerEl).setName("Export library").setDesc("Save a copy of your library JSON to a file.").addButton((button) => button.setButtonText("Export JSON").onClick(async () => {
      await this.exportLibraryJson();
    }));
    new import_obsidian6.Setting(containerEl).setName("Bugfix").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Report issues").setDesc("If you encounter any issues with the plugin, please report them. Your feedback is invaluable for improving BoxOffice!").addButton((button) => button.setButtonText("GitHub").onClick(() => {
      window.open("https://github.com/vscaperrotta/obsidian-cinevault/issues", "_blank");
    }));
    new import_obsidian6.Setting(containerEl).setName("Support").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Donate").setDesc(
      "If you like this plugin, consider donating to support continued development."
    ).addButton((bt) => {
      bt.buttonEl.outerHTML = "<a href='https://ko-fi.com/T6T01TX807' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi6.png?v=6' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a>";
    });
  }
  async exportLibraryJson() {
    try {
      const content = await this.getLibraryJsonContent();
      if (!content) {
        new import_obsidian6.Notice("No library file found to export.");
        return;
      }
      const timestamp = new Date().toISOString().replace(/[:.]/g, "-").slice(0, 19);
      const exportPath = `boxoffice-export-${timestamp}.json`;
      let finalPath = exportPath;
      let counter = 1;
      while (this.app.vault.getAbstractFileByPath(finalPath)) {
        finalPath = `boxoffice-export-${timestamp}-${counter}.json`;
        counter++;
      }
      await this.app.vault.create(finalPath, content);
      new import_obsidian6.Notice(`Library exported to ${finalPath}`);
    } catch (error) {
      console.error("[BoxOffice] Export library error", error);
      new import_obsidian6.Notice("Unable to export the library.");
    }
  }
  async createNewLibrary() {
    const confirmed = window.confirm(
      "Create a new empty BoxOffice library? This will unlink any external library and reset your local library data."
    );
    if (!confirmed)
      return;
    try {
      const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
      let createdFile;
      if (defaultFile instanceof import_obsidian6.TFile) {
        await saveLocalData(this.app, defaultFile, createDefaultData());
        createdFile = defaultFile;
      } else {
        createdFile = await createJsonFile(this.app, this.plugin.libraryFolder);
      }
      if (createdFile) {
        await this.plugin.setLocalJsonPath(createdFile.path);
      }
      await this.refreshOpenViews();
      this.display();
      new import_obsidian6.Notice("New library created.");
    } catch (error) {
      console.error("[BoxOffice] Create new library error", error);
      new import_obsidian6.Notice("Unable to create a new library.");
    }
  }
  async getLibraryJsonContent() {
    if (this.plugin.localJsonPath) {
      const localPath = this.plugin.localJsonPath;
      const file = this.app.vault.getAbstractFileByPath(localPath);
      if (file instanceof import_obsidian6.TFile) {
        return this.app.vault.read(file);
      }
    }
    const defaultFile = this.app.vault.getAbstractFileByPath(getDefaultPath(this.plugin.libraryFolder));
    if (defaultFile instanceof import_obsidian6.TFile) {
      return this.app.vault.read(defaultFile);
    }
    const folder = getFolder(this.plugin.libraryFolder);
    const fallback = this.app.vault.getFiles().find((file) => file.extension === "json" && file.path.startsWith(`${folder}/`));
    if (fallback) {
      return this.app.vault.read(fallback);
    }
    return null;
  }
  async refreshOpenViews() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    for (const leaf of leaves) {
      if (leaf.view instanceof CineVaultView) {
        await leaf.view.onOpen();
      }
    }
  }
};

// src/main.ts
var CineVaultPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.localJsonPath = null;
    this.omdbApiKey = "";
    this.viewMode = "grid";
    this.libraryFolder = "BoxOffice";
  }
  // Initialize the plugin and set up event listeners
  async onload() {
    await this.loadPluginData();
    this.addSettingTab(new CineVaultSettingTab(this.app, this));
    this.registerView(
      VIEW_TYPE,
      (leaf) => new CineVaultView(leaf, this)
    );
    this.addRibbonIcon("clapperboard", "BoxOffice", async () => {
      await this.openNewTab();
    });
  }
  // Unmount the status bar element when the plugin is disabled
  onunload() {
  }
  async loadPluginData() {
    var _a, _b, _c, _d;
    const data = await this.loadData();
    this.localJsonPath = (_a = data == null ? void 0 : data.localJsonPath) != null ? _a : null;
    this.omdbApiKey = (_b = data == null ? void 0 : data.omdbApiKey) != null ? _b : "";
    this.viewMode = (_c = data == null ? void 0 : data.viewMode) != null ? _c : "grid";
    this.libraryFolder = (_d = data == null ? void 0 : data.libraryFolder) != null ? _d : "BoxOffice";
  }
  // externalJsonPath removed; no-op placeholder removed
  async setOmdbApiKey(apiKey) {
    this.omdbApiKey = apiKey;
    await this.savePluginData();
  }
  async setViewMode(viewMode) {
    this.viewMode = viewMode;
    await this.savePluginData();
  }
  async savePluginData() {
    const data = {
      omdbApiKey: this.omdbApiKey,
      viewMode: this.viewMode,
      libraryFolder: this.libraryFolder
    };
    if (this.localJsonPath) {
      data.localJsonPath = this.localJsonPath;
    }
    await this.saveData(data);
  }
  async setLocalJsonPath(path) {
    this.localJsonPath = path;
    await this.savePluginData();
  }
  async setLibraryFolder(folder) {
    this.libraryFolder = folder;
    await this.savePluginData();
  }
  // Open a new tab with the "BoxOffice" view type
  async openNewTab() {
    const existingLeaves = this.app.workspace.getLeavesOfType(VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf(true);
    await leaf.setViewState({
      type: VIEW_TYPE,
      active: true
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL2NvbnN0YW50cy50cyIsICJzcmMvdmlld3MvcGx1Z2luVmlldy50cyIsICJzcmMvdWkvb25ib2FyZGluZy50cyIsICJzcmMvdWkvbW9kYWxzL2FjdGlvbk1vZGFsLnRzIiwgInNyYy91aS9tb2RhbHMvZGV0YWlsTW9kYWwudHMiLCAic3JjL3VpL3N0YXJSYXRpbmcudHMiLCAic3JjL3V0aWxzL2dsb2JhbE1ldGhvZHMudHMiLCAic3JjL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9zZXJ2aWNlcy9saWJyYXJ5U3RvcmFnZS50cyIsICJzcmMvc2VydmljZXMvb21kYlNlcnZpY2UudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFZJRVdfVFlQRSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHBsdWdpblZpZXcgZnJvbSBcIi4vdmlld3MvcGx1Z2luVmlld1wiO1xuaW1wb3J0IENpbmVWYXVsdFNldHRpbmdUYWIgZnJvbSBcIi4vc2V0dGluZ3Mvc2V0dGluZ3NUYWJcIjtcblxudHlwZSBDaW5lVmF1bHRQbHVnaW5EYXRhID0ge1xuXHRsb2NhbEpzb25QYXRoPzogc3RyaW5nO1xuXHRvbWRiQXBpS2V5Pzogc3RyaW5nO1xuXHR2aWV3TW9kZT86IFwiZ3JpZFwiIHwgXCJsaXN0XCI7XG5cdGxpYnJhcnlGb2xkZXI/OiBzdHJpbmc7XG5cdG9wZW4/OiBib29sZWFuO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2luZVZhdWx0UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0bG9jYWxKc29uUGF0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cdG9tZGJBcGlLZXk6IHN0cmluZyA9IFwiXCI7XG5cdHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiID0gXCJncmlkXCI7XG5cdGxpYnJhcnlGb2xkZXI6IHN0cmluZyA9IFwiQm94T2ZmaWNlXCI7XG5cblx0Ly8gSW5pdGlhbGl6ZSB0aGUgcGx1Z2luIGFuZCBzZXQgdXAgZXZlbnQgbGlzdGVuZXJzXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRQbHVnaW5EYXRhKCk7XG5cblx0XHQvLyBBZGQgc2V0dGluZ3MgdGFiXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBDaW5lVmF1bHRTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHQvLyBSZWdpc3RlciBuZXcgdmlld1xuXHRcdHRoaXMucmVnaXN0ZXJWaWV3KFxuXHRcdFx0VklFV19UWVBFLFxuXHRcdFx0KGxlYWYpID0+IG5ldyBwbHVnaW5WaWV3KGxlYWYsIHRoaXMpXG5cdFx0KTtcblxuXHRcdHRoaXMuYWRkUmliYm9uSWNvbihcImNsYXBwZXJib2FyZFwiLCBcIkJveE9mZmljZVwiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRhd2FpdCB0aGlzLm9wZW5OZXdUYWIoKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vIFVubW91bnQgdGhlIHN0YXR1cyBiYXIgZWxlbWVudCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWRcblx0b251bmxvYWQoKSB7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGxvYWRQbHVnaW5EYXRhKCkge1xuXHRcdGNvbnN0IGRhdGEgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyBDaW5lVmF1bHRQbHVnaW5EYXRhIHwgbnVsbDtcblx0XHR0aGlzLmxvY2FsSnNvblBhdGggPSBkYXRhPy5sb2NhbEpzb25QYXRoID8/IG51bGw7XG5cdFx0dGhpcy5vbWRiQXBpS2V5ID0gZGF0YT8ub21kYkFwaUtleSA/PyBcIlwiO1xuXHRcdHRoaXMudmlld01vZGUgPSBkYXRhPy52aWV3TW9kZSA/PyBcImdyaWRcIjtcblx0XHR0aGlzLmxpYnJhcnlGb2xkZXIgPSBkYXRhPy5saWJyYXJ5Rm9sZGVyID8/IFwiQm94T2ZmaWNlXCI7XG5cdH1cblxuXHQvLyBleHRlcm5hbEpzb25QYXRoIHJlbW92ZWQ7IG5vLW9wIHBsYWNlaG9sZGVyIHJlbW92ZWRcblxuXHRhc3luYyBzZXRPbWRiQXBpS2V5KGFwaUtleTogc3RyaW5nKSB7XG5cdFx0dGhpcy5vbWRiQXBpS2V5ID0gYXBpS2V5O1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdGFzeW5jIHNldFZpZXdNb2RlKHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiKSB7XG5cdFx0dGhpcy52aWV3TW9kZSA9IHZpZXdNb2RlO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgc2F2ZVBsdWdpbkRhdGEoKSB7XG5cdFx0Y29uc3QgZGF0YTogQ2luZVZhdWx0UGx1Z2luRGF0YSA9IHtcblx0XHRcdG9tZGJBcGlLZXk6IHRoaXMub21kYkFwaUtleSxcblx0XHRcdHZpZXdNb2RlOiB0aGlzLnZpZXdNb2RlLFxuXHRcdFx0bGlicmFyeUZvbGRlcjogdGhpcy5saWJyYXJ5Rm9sZGVyXG5cdFx0fTtcblx0XHRpZiAodGhpcy5sb2NhbEpzb25QYXRoKSB7XG5cdFx0XHRkYXRhLmxvY2FsSnNvblBhdGggPSB0aGlzLmxvY2FsSnNvblBhdGg7XG5cdFx0fVxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEoZGF0YSk7XG5cdH1cblxuXHRhc3luYyBzZXRMb2NhbEpzb25QYXRoKHBhdGg6IHN0cmluZyB8IG51bGwpIHtcblx0XHR0aGlzLmxvY2FsSnNvblBhdGggPSBwYXRoO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZVBsdWdpbkRhdGEoKTtcblx0fVxuXG5cdGFzeW5jIHNldExpYnJhcnlGb2xkZXIoZm9sZGVyOiBzdHJpbmcpIHtcblx0XHR0aGlzLmxpYnJhcnlGb2xkZXIgPSBmb2xkZXI7XG5cdFx0YXdhaXQgdGhpcy5zYXZlUGx1Z2luRGF0YSgpO1xuXHR9XG5cblx0Ly8gT3BlbiBhIG5ldyB0YWIgd2l0aCB0aGUgXCJCb3hPZmZpY2VcIiB2aWV3IHR5cGVcblx0cHJpdmF0ZSBhc3luYyBvcGVuTmV3VGFiKCkge1xuXHRcdGNvbnN0IGV4aXN0aW5nTGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEUpO1xuXHRcdGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihleGlzdGluZ0xlYXZlc1swXSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuXHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcblx0XHRcdHR5cGU6IFZJRVdfVFlQRSxcblx0XHRcdGFjdGl2ZTogdHJ1ZVxuXHRcdH0pO1xuXHR9XG59IiwgImV4cG9ydCBjb25zdCBWSUVXX1RZUEUgPSBcIkNpbmVWYXVsdFZpZXdcIjtcblxuZXhwb3J0IGNvbnN0IE9NREJfVFlQRVMgPSBbXCJtb3ZpZVwiLCBcInNlcmllc1wiLCBcImVwaXNvZGVcIl0gYXMgY29uc3Q7IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmLCBURmlsZSwgTm90aWNlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQ2luZVZhdWx0UGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBWSUVXX1RZUEUsIE9NREJfVFlQRVMgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdERhdGEsIENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgcmVuZGVyT25ib2FyZGluZyB9IGZyb20gXCIuLi91aS9vbmJvYXJkaW5nXCI7XG5pbXBvcnQgeyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIH0gZnJvbSBcIi4uL3VpL21vZGFscy9hY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IHsgQ2luZVZhdWx0TW92aWVEZXRhaWxNb2RhbCB9IGZyb20gXCIuLi91aS9tb2RhbHMvZGV0YWlsTW9kYWxcIjtcbmltcG9ydCB7IEpzb25GaWxlU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIi4uL3VpL0pzb25GaWxlU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQge1xuICBjcmVhdGVFbXB0eU1vdmllLFxuICBjcmVhdGVKc29uRmlsZSxcbiAgZ2V0RGVmYXVsdFBhdGgsXG4gIGdldEZvbGRlcixcbiAgbG9hZExvY2FsRmlsZSxcbiAgc2F2ZUxvY2FsRGF0YVxufSBmcm9tIFwiLi4vc2VydmljZXMvbGlicmFyeVN0b3JhZ2VcIjtcbmltcG9ydCB7IHNlYXJjaE9tZGIsIGdldE9tZGJEZXRhaWxzIH0gZnJvbSBcIi4uL3NlcnZpY2VzL29tZGJTZXJ2aWNlXCI7XG5pbXBvcnQgeyBjcmVhdGVTdGFyUmF0aW5nIH0gZnJvbSBcIi4uL3VpL3N0YXJSYXRpbmdcIjtcbmltcG9ydCB7IG51bGxTYWZlLCByZW5kZXJFeHRlcm5hbFJhdGluZ0JhciB9IGZyb20gXCJzcmMvdXRpbHMvZ2xvYmFsTWV0aG9kc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuXG4gIHBsdWdpbjogQ2luZVZhdWx0UGx1Z2luO1xuICBmaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xuICBkYXRhOiBDaW5lVmF1bHREYXRhIHwgbnVsbCA9IG51bGw7XG4gIGFjdGl2ZVRhYjogXCJ0b1dhdGNoXCIgfCBcIndhdGNoZWRcIiA9IFwidG9XYXRjaFwiO1xuICBtb3ZpZXNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gIHZpZXdNb2RlOiBcImdyaWRcIiB8IFwibGlzdFwiID0gXCJncmlkXCI7XG5cbiAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBDaW5lVmF1bHRQbHVnaW4pIHtcbiAgICBzdXBlcihsZWFmKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGdldFZpZXdUeXBlKCkge1xuICAgIHJldHVybiBWSUVXX1RZUEU7XG4gIH1cblxuICBnZXREaXNwbGF5VGV4dCgpIHtcbiAgICByZXR1cm4gXCJCb3hPZmZpY2VcIjtcbiAgfVxuXG4gIC8vIFByb3ZpZGUgYSBjdXN0b20gaWNvbiBmb3IgdGhlIHZpZXcncyB0YWJcbiAgZ2V0SWNvbigpOiBzdHJpbmcge1xuICAgIHJldHVybiBcImNsYXBwZXJib2FyZFwiO1xuICB9XG5cbiAgYXN5bmMgb25PcGVuKCkge1xuICAgIHRoaXMudmlld01vZGUgPSB0aGlzLnBsdWdpbi52aWV3TW9kZSA/PyBcImdyaWRcIjtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV0gYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29udGFpbmVyLmVtcHR5KCk7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1oZWFkZXJcIiB9KTtcbiAgICBoZWFkZXIuY3JlYXRlRWwoXCJoMVwiLCB7XG4gICAgICB0ZXh0OiBcIkJveE9mZmljZVwiLFxuICAgICAgY2xzOiBcImNpbmV2YXVsdC10aXRsZVwiXG4gICAgfSk7XG5cbiAgICBoZWFkZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IFwiVGhpcyBwbHVnaW4gYWxsb3cgeW91IHRvIG1hbmFnZSB5b3VyIGZhdm9yaXRlcyBtb3ZpZSBhbmQgdHYgbGlicmFyeSBpbnRvIHlvdXIgdmF1bHQuXFxuU2VhcmNoIE9NRGIsIHJhdGUgdGl0bGVzLCBhbmQgc3RvcmUgeW91ciBjb2xsZWN0aW9uIGluIGEganNvbiBmaWxlIHdpdGhpbiB5b3VyIHZhdWx0IG9yIGluIGEgc2VwYXJhdGUgdmF1bHQuXCIsXG4gICAgICBjbHM6IFwiY2luZXZhdWx0LWhlYWRlci10ZXh0XCJcbiAgICB9KTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICByZW5kZXJPbmJvYXJkaW5nKGNvbnRhaW5lciwgYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aGlzLmZpbGUgPSBhd2FpdCBjcmVhdGVKc29uRmlsZSh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpO1xuICAgICAgICBpZiAodGhpcy5maWxlKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2V0TG9jYWxKc29uUGF0aCh0aGlzLmZpbGUucGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkRmlsZSh0aGlzLmZpbGUpO1xuICAgICAgICBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAvLyBPcGVuIG1vZGFsIHRvIHNlbGVjdCBKU09OIGZpbGUgZnJvbSB2YXVsdFxuICAgICAgICBuZXcgSnNvbkZpbGVTdWdnZXN0TW9kYWwodGhpcy5wbHVnaW4uYXBwLCBhc3luYyAoZmlsZSkgPT4ge1xuICAgICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUoZmlsZSk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSkub3BlbigpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2VhcmNoIGFyZWFcbiAgICBjb25zdCBzZWFyY2hCb3ggPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2hcIiB9KTtcblxuICAgIGNvbnN0IHNlYXJjaElucHV0c0dyb3VwID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWlucHV0cy1ncm91cFwiIH0pO1xuXG4gICAgLy8gU2VhcmNoIHRpdGxlXG4gICAgY29uc3Qgc2VhcmNoSW5wdXRDb250YWluZXIgPSBzZWFyY2hJbnB1dHNHcm91cC5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1pbnB1dC1jb250YWluZXJcIiB9KTtcbiAgICBjb25zdCBzZWFyY2hJbnB1dCA9IHNlYXJjaElucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtaW5wdXRcIixcbiAgICAgIGF0dHI6IHtcbiAgICAgICAgcGxhY2Vob2xkZXI6IFwiU2VhcmNoXCJcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGZpbHRlclN3aXRjaCA9IHNlYXJjaElucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWNsZWFyXCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIFwiYXJpYS1sYWJlbFwiOiBcIk1vcmUgZmlsdGVyXCIsXG4gICAgICAgIHRpdGxlOiBcIk1vcmUgZmlsdGVyXCJcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgc2V0SWNvbihmaWx0ZXJTd2l0Y2gsIFwic2xpZGVycy1ob3Jpem9udGFsXCIpO1xuXG4gICAgY29uc3QgbW9yZUZpbHRlckNvbnRhaW5lciA9IHNlYXJjaElucHV0c0dyb3VwLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9yZS1maWx0ZXJcIiB9KTtcblxuICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgZmlsdGVyU3dpdGNoLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBpZiAobW9yZUZpbHRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIikge1xuICAgICAgICBtb3JlRmlsdGVyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vcmVGaWx0ZXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gWWVhciBmaWx0ZXJcbiAgICBjb25zdCB5ZWFySW5wdXQgPSBtb3JlRmlsdGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtaW5wdXRcIixcbiAgICAgIGF0dHI6IHsgcGxhY2Vob2xkZXI6IFwiWWVhclwiIH1cbiAgICB9KTtcblxuICAgIC8vIFR5cGUgZmlsdGVyXG4gICAgY29uc3QgdHlwZVNlbGVjdCA9IG1vcmVGaWx0ZXJDb250YWluZXIuY3JlYXRlRWwoXCJzZWxlY3RcIiwgeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1zZWxlY3RcIiB9KTtcbiAgICB0eXBlU2VsZWN0LmNyZWF0ZUVsKFwib3B0aW9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQWxsXCIsXG4gICAgICBhdHRyOiB7XG4gICAgICAgIHZhbHVlOiBcIlwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJUeXBlXCJcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIE9NREJfVFlQRVMuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgdHlwZVNlbGVjdC5jcmVhdGVFbChcIm9wdGlvblwiLCB7XG4gICAgICAgIHRleHQ6IHRbMF0udG9VcHBlckNhc2UoKSArIHQuc2xpY2UoMSksXG4gICAgICAgIGF0dHI6IHsgdmFsdWU6IHQgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDb250YWluZXIgZm9yIHNlYXJjaCByZXN1bHRzLCBjcmVhdGVkIG9uIGRlbWFuZFxuICAgIGxldCByZXN1bHRzTGlzdDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0IGNvbnRlbnQgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1jb250ZW50XCIgfSk7XG4gICAgdGhpcy5tb3ZpZXNDb250YWluZXIgPSBjb250ZW50O1xuXG4gICAgdGhpcy5yZW5kZXJNb3ZpZXMoY29udGVudCk7XG5cbiAgICBsZXQgc2VhcmNoVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgcnVuU2VhcmNoID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICBpZiAoIXF1ZXJ5KSByZXR1cm47XG4gICAgICBjb25zdCB0eXBlID0gdHlwZVNlbGVjdC52YWx1ZSB8fCB1bmRlZmluZWQ7XG4gICAgICBjb25zdCB5ZWFyID0geWVhcklucHV0LnZhbHVlLnRyaW0oKSB8fCB1bmRlZmluZWQ7XG5cbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBzZWFyY2hPbWRiKHF1ZXJ5LCB0aGlzLnBsdWdpbi5vbWRiQXBpS2V5LCB0eXBlLCB5ZWFyKTtcblxuICAgICAgaWYgKCFyZXN1bHRzIHx8IHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGlmICghcmVzdWx0c0xpc3QpIHJlc3VsdHNMaXN0ID0gc2VhcmNoQm94LmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLXJlc3VsdHNcIiB9KTtcbiAgICAgICAgcmVzdWx0c0xpc3QuZW1wdHkoKTtcbiAgICAgICAgcmVzdWx0c0xpc3QuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIk5vIHJlc3VsdHMgZm91bmQuXCIsIGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWVtcHR5XCIgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXN1bHRzTGlzdCkgcmVzdWx0c0xpc3QgPSBzZWFyY2hCb3guY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zZWFyY2gtcmVzdWx0c1wiIH0pO1xuICAgICAgYXdhaXQgdGhpcy5yZW5kZXJTZWFyY2hSZXN1bHRzKHJlc3VsdHNMaXN0LCByZXN1bHRzKTtcbiAgICB9O1xuXG4gICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSB7XG4gICAgICAgIGlmIChyZXN1bHRzTGlzdCkge1xuICAgICAgICAgIHJlc3VsdHNMaXN0LmVtcHR5KCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QucmVtb3ZlKCk7XG4gICAgICAgICAgcmVzdWx0c0xpc3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB7XG4gICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTtcbiAgICAgICAgICBzZWFyY2hUaW1lb3V0ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChzZWFyY2hUaW1lb3V0KSB3aW5kb3cuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpO1xuICAgICAgc2VhcmNoVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KHJ1blNlYXJjaCwgMzUwKTtcbiAgICB9KTtcblxuICAgIHllYXJJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKCFzZWFyY2hJbnB1dC52YWx1ZS50cmltKCkpIHJldHVybjtcbiAgICAgIGF3YWl0IHJ1blNlYXJjaCgpO1xuICAgIH0pO1xuXG4gICAgdHlwZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghc2VhcmNoSW5wdXQudmFsdWUudHJpbSgpKSByZXR1cm47XG4gICAgICBhd2FpdCBydW5TZWFyY2goKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyTW92aWVzKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIGlmICghdGhpcy5kYXRhKSB7XG4gICAgICBjb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBsaWJyYXJ5IGxvYWRlZC5cIiB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB3YXRjaGVkID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiBtb3ZpZS53YXRjaGVkKTtcbiAgICBjb25zdCB0b1dhdGNoID0gdGhpcy5kYXRhLm1vdmllcy5maWx0ZXIoKG1vdmllKSA9PiAhbW92aWUud2F0Y2hlZCk7XG5cbiAgICBjb25zdCB0YWJzQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtdGFicy1jb250YWluZXJcIiB9KTtcbiAgICBjb25zdCB0YWJIZWFkZXIgPSB0YWJzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtdGFiLWhlYWRlclwiIH0pO1xuXG4gICAgY29uc3QgdGFiQnV0dG9ucyA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXRhYi1idXR0b25zXCIgfSk7XG4gICAgY29uc3Qgdmlld1RvZ2dsZSA9IHRhYkhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXZpZXctdG9nZ2xlXCIgfSk7XG5cbiAgICBjb25zdCB0b1dhdGNoQnV0dG9uID0gdGFiQnV0dG9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LXRhYi1idXR0b25cIixcbiAgICAgIHRleHQ6IGBUbyBXYXRjaCAoJHt0b1dhdGNoLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3Qgd2F0Y2hlZEJ1dHRvbiA9IHRhYkJ1dHRvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC10YWItYnV0dG9uXCIsXG4gICAgICB0ZXh0OiBgV2F0Y2hlZCAoJHt3YXRjaGVkLmxlbmd0aH0pYFxuICAgIH0pO1xuXG4gICAgY29uc3QgZ3JpZEJ1dHRvbiA9IHZpZXdUb2dnbGUuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcImNpbmV2YXVsdC12aWV3LWJ1dHRvblwiLFxuICAgICAgYXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJHcmlkIHZpZXdcIiwgdGl0bGU6IFwiR3JpZCB2aWV3XCIgfVxuICAgIH0pO1xuICAgIGNvbnN0IGxpc3RCdXR0b24gPSB2aWV3VG9nZ2xlLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtdmlldy1idXR0b25cIixcbiAgICAgIGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTGlzdCB2aWV3XCIsIHRpdGxlOiBcIkxpc3Qgdmlld1wiIH1cbiAgICB9KTtcblxuICAgIHNldEljb24oZ3JpZEJ1dHRvbiwgXCJsYXlvdXQtZ3JpZFwiKTtcbiAgICBzZXRJY29uKGxpc3RCdXR0b24sIFwibGlzdFwiKTtcblxuICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHtcbiAgICAgIHRvV2F0Y2hCdXR0b24uY2xhc3NMaXN0LmFkZChcImNpbmV2YXVsdC10YWItYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2F0Y2hlZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXRhYi1idXR0b24tYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnZpZXdNb2RlID09PSBcImdyaWRcIikge1xuICAgICAgZ3JpZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2luZXZhdWx0LXZpZXctYnV0dG9uLWFjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YWJDb250ZW50ID0gdGFic0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXRhYi1jb250ZW50XCIgfSk7XG4gICAgY29uc3QgYWN0aXZlTW92aWVzID0gdGhpcy5hY3RpdmVUYWIgPT09IFwidG9XYXRjaFwiID8gdG9XYXRjaCA6IHdhdGNoZWQ7XG4gICAgY29uc3QgYWN0aXZlVGl0bGUgPSB0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIgPyBcIlRvIFdhdGNoXCIgOiBcIldhdGNoZWRcIjtcbiAgICB0aGlzLnJlbmRlck1vdmllU2VjdGlvbih0YWJDb250ZW50LCBhY3RpdmVUaXRsZSwgYWN0aXZlTW92aWVzKTtcblxuICAgIHRvV2F0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmFjdGl2ZVRhYiA9PT0gXCJ0b1dhdGNoXCIpIHJldHVybjtcbiAgICAgIHRoaXMuYWN0aXZlVGFiID0gXCJ0b1dhdGNoXCI7XG4gICAgICB0aGlzLnJlbmRlck1vdmllcyhjb250YWluZXIpO1xuICAgIH0pO1xuXG4gICAgd2F0Y2hlZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuYWN0aXZlVGFiID09PSBcIndhdGNoZWRcIikgcmV0dXJuO1xuICAgICAgdGhpcy5hY3RpdmVUYWIgPSBcIndhdGNoZWRcIjtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBncmlkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImdyaWRcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwiZ3JpZFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG5cbiAgICBsaXN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJsaXN0XCIpIHJldHVybjtcbiAgICAgIHRoaXMudmlld01vZGUgPSBcImxpc3RcIjtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldFZpZXdNb2RlKFwibGlzdFwiKTtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVzKGNvbnRhaW5lcik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1vdmllU2VjdGlvbihjb250YWluZXI6IEhUTUxFbGVtZW50LCB0aXRsZTogc3RyaW5nLCBtb3ZpZXM6IENpbmVWYXVsdE1vdmllW10pIHtcbiAgICBjb25zdCBzZWN0aW9uID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VjdGlvblwiIH0pO1xuICAgIC8vIHNlY3Rpb24uY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IHRpdGxlIH0pO1xuXG4gICAgaWYgKG1vdmllcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHNlY3Rpb24uY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBtb3ZpZXMgaW4gdGhpcyBsaXN0LlwiIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGxpc3QgPSBzZWN0aW9uLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IHRoaXMudmlld01vZGUgPT09IFwiZ3JpZFwiID8gXCJjaW5ldmF1bHQtbW92aWUtZ3JpZFwiIDogXCJjaW5ldmF1bHQtbW92aWUtbGlzdFwiXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy52aWV3TW9kZSA9PT0gXCJncmlkXCIpIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVHcmlkKGxpc3QsIG1vdmllcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVuZGVyTW92aWVMaXN0KGxpc3QsIG1vdmllcyk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZUdyaWQoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgbW92aWVzLmZvckVhY2goKG1vdmllKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW92aWUtY2FyZFwiIH0pO1xuICAgICAgY2FyZC5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJjaW5ldmF1bHQtbW92aWUtcG9zdGVyXCIgfSkuc2V0QXR0cmlidXRlKFwic3JjXCIsIG1vdmllLnBvc3Rlcik7XG4gICAgICBjYXJkLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogbW92aWUudGl0bGUsIGNsczogXCJjaW5ldmF1bHQtbW92aWUtdGl0bGVcIiB9KTtcblxuICAgICAgLy8gQnVpbGQgdGhlIGRldGFpbHMgc3RyaW5nIGNvbmRpdGlvbmFsbHksIG9ubHkgaW5jbHVkaW5nIG5vbi1udWxsL3VuZGVmaW5lZCB2YWx1ZXNcbiAgICAgIGNvbnN0IGRldGFpbHNQYXJ0czogc3RyaW5nW10gPSBbXTtcbiAgICAgIGNvbnN0IHllYXIgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS55ZWFyLCBudWxsKTtcbiAgICAgIGNvbnN0IHR5cGUgPSBudWxsU2FmZSgoKSA9PiBtb3ZpZS50eXBlWzBdLnRvVXBwZXJDYXNlKCkgKyBtb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcblxuICAgICAgaWYgKHllYXIpIGRldGFpbHNQYXJ0cy5wdXNoKHllYXIpO1xuICAgICAgaWYgKHR5cGUpIGRldGFpbHNQYXJ0cy5wdXNoKHR5cGUpO1xuXG4gICAgICBjb25zdCBkZXRhaWxzVGV4dCA9IGRldGFpbHNQYXJ0cy5qb2luKFwiIC0gXCIpO1xuICAgICAgaWYgKGRldGFpbHNUZXh0KSB7XG4gICAgICAgIGNhcmQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBkZXRhaWxzVGV4dCwgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS15ZWFyXCIgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgIGNyZWF0ZVN0YXJSYXRpbmcoY2FyZCwgbW92aWUuc3RhclJhdGluZywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobW92aWUucmF0aW5ncyAmJiBtb3ZpZS5yYXRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGNhcmQsIG1vdmllLnJhdGluZ3MpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMub3Blbk1vdmllRGV0YWlscyhtb3ZpZSkpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNb3ZpZUxpc3QoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbW92aWVzOiBDaW5lVmF1bHRNb3ZpZVtdKSB7XG4gICAgbW92aWVzLmZvckVhY2goKG1vdmllKSA9PiB7XG4gICAgICBjb25zdCByb3cgPSBjb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS1yb3dcIlxuICAgICAgfSk7XG4gICAgICBjb25zdCBwb3N0ZXIgPSByb3cuY3JlYXRlRWwoXCJpbWdcIiwge1xuICAgICAgICBjbHM6IFwiY2luZXZhdWx0LW1vdmllLXRodW1ibmFpbFwiXG4gICAgICB9KTtcbiAgICAgIHBvc3Rlci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbW92aWUucG9zdGVyIHx8IFwiXCIpO1xuXG4gICAgICBjb25zdCBpbmZvID0gcm93LmNyZWF0ZURpdih7XG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW92aWUtaW5mb1wiXG4gICAgICB9KTtcblxuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgIHRleHQ6IG1vdmllLnRpdGxlLFxuICAgICAgICBjbHM6IFwiY2luZXZhdWx0LW1vdmllLXRpdGxlXCJcbiAgICAgIH0pO1xuXG4gICAgICAvLyBCdWlsZCB0aGUgZGV0YWlscyBzdHJpbmcgY29uZGl0aW9uYWxseSwgb25seSBpbmNsdWRpbmcgbm9uLW51bGwvdW5kZWZpbmVkIHZhbHVlc1xuICAgICAgY29uc3QgZGV0YWlsc1BhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgY29uc3QgeWVhciA9IG51bGxTYWZlKCgpID0+IG1vdmllLnllYXIsIG51bGwpO1xuICAgICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IG1vdmllLnR5cGVbMF0udG9VcHBlckNhc2UoKSArIG1vdmllLnR5cGUuc2xpY2UoMSksIG51bGwpO1xuXG4gICAgICBpZiAoeWVhcikge1xuICAgICAgICBkZXRhaWxzUGFydHMucHVzaCh5ZWFyKVxuICAgICAgfTtcblxuICAgICAgaWYgKHR5cGUpIHtcbiAgICAgICAgZGV0YWlsc1BhcnRzLnB1c2godHlwZSlcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRldGFpbHNUZXh0ID0gZGV0YWlsc1BhcnRzLmpvaW4oXCIgLSBcIik7XG4gICAgICBpZiAoZGV0YWlsc1RleHQpIHtcbiAgICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgdGV4dDogZGV0YWlsc1RleHQsXG4gICAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb3ZpZS15ZWFyXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb3ZpZS53YXRjaGVkKSB7XG4gICAgICAgIGNyZWF0ZVN0YXJSYXRpbmcoaW5mbywgbW92aWUuc3RhclJhdGluZywgdHJ1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobW92aWUucmF0aW5ncyAmJiBtb3ZpZS5yYXRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgIHJlbmRlckV4dGVybmFsUmF0aW5nQmFyKGluZm8sIG1vdmllLnJhdGluZ3MpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5vcGVuTW92aWVEZXRhaWxzKG1vdmllKSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIG9wZW5Nb3ZpZURldGFpbHMobW92aWU6IENpbmVWYXVsdE1vdmllKSB7XG4gICAgbmV3IENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwodGhpcy5wbHVnaW4uYXBwLCBtb3ZpZSwgYXN5bmMgKHJhdGluZykgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICAgIG1vdmllLnN0YXJSYXRpbmcgPSByYXRpbmc7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgdGhpcy5kYXRhLm1vdmllcyA9IHRoaXMuZGF0YS5tb3ZpZXMuZmlsdGVyKChpdGVtKSA9PiBpdGVtLmlkICE9PSBtb3ZpZS5pZCk7XG4gICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKCk7XG4gICAgICB0aGlzLnJlZnJlc2hNb3ZpZXMoKTtcbiAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuO1xuICAgICAgbW92aWUud2F0Y2hlZCA9ICFtb3ZpZS53YXRjaGVkO1xuICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgdGhpcy5yZWZyZXNoTW92aWVzKCk7XG4gICAgfSkub3BlbigpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWZyZXNoTW92aWVzKCkge1xuICAgIGlmICghdGhpcy5tb3ZpZXNDb250YWluZXIpIHJldHVybjtcbiAgICB0aGlzLnJlbmRlck1vdmllcyh0aGlzLm1vdmllc0NvbnRhaW5lcik7XG4gIH1cblxuICBwcml2YXRlIGdldEpzb25GaWxlcygpOiBURmlsZVtdIHtcbiAgICByZXR1cm4gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKSA9PiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplRGF0YSgpIHtcbiAgICAvLyBQcmVmZXIgYSBsb2NhbGx5IGxpbmtlZCBmaWxlIGluc2lkZSB0aGUgdmF1bHQgaWYgY29uZmlndXJlZFxuICAgIGNvbnN0IGxvY2FsUGF0aCA9IHRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGg7XG4gICAgaWYgKGxvY2FsUGF0aCkge1xuICAgICAgY29uc3QgbG9jYWxGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbFBhdGgpO1xuICAgICAgaWYgKGxvY2FsRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZEZpbGUobG9jYWxGaWxlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vIGxpbmtlZCBmaWxlcyBmb3VuZCBcdTIwMTQgZG9uJ3QgY3JlYXRlIGZvbGRlcnMvZmlsZXMgYXV0b21hdGljYWxseS4gU2hvdyBvbmJvYXJkaW5nLlxuICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZEZpbGUoZmlsZTogVEZpbGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gYXdhaXQgbG9hZExvY2FsRmlsZSh0aGlzLnBsdWdpbi5hcHAsIGZpbGUpO1xuICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgIHRoaXMuZGF0YSA9IHBhcnNlZDtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldExvY2FsSnNvblBhdGgoZmlsZS5wYXRoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5kYXRhID0gbnVsbDtcbiAgICAgIHRoaXMuZmlsZSA9IG51bGw7XG4gICAgICBuZXcgTm90aWNlKFwiVW5hYmxlIHRvIHJlYWQgdGhlIEpTT04gZmlsZS5cIik7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgYXN5bmMgc2F2ZURhdGEoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcbiAgICB0aGlzLmRhdGEudXBkYXRlZEF0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGlmICh0aGlzLmZpbGUpIHtcbiAgICAgIGF3YWl0IHNhdmVMb2NhbERhdGEodGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIHRoaXMuZGF0YSk7XG4gICAgfVxuICB9XG5cblxuICBwcml2YXRlIGFzeW5jIHJlbmRlclNlYXJjaFJlc3VsdHMoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgcmVzdWx0czogYW55W10pIHtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcblxuICAgIHJlc3VsdHMuZm9yRWFjaCgocmVzdWx0KSA9PiB7XG4gICAgICBjb25zdCBpdGVtID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtc2VhcmNoLWl0ZW1cIiB9KTtcbiAgICAgIGlmIChyZXN1bHQucG9zdGVyKSB7XG4gICAgICAgIGl0ZW0uY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1wb3N0ZXJcIiB9KS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgcmVzdWx0LnBvc3Rlcik7XG4gICAgICB9XG4gICAgICBjb25zdCBpbmZvID0gaXRlbS5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC1pbmZvXCIgfSk7XG4gICAgICBpbmZvLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogcmVzdWx0LnRpdGxlLCBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC10aXRsZVwiIH0pO1xuICAgICAgaW5mby5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IHJlc3VsdC55ZWFyLCBjbHM6IFwiY2luZXZhdWx0LXNlYXJjaC15ZWFyXCIgfSk7XG5cbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgbmV3IENpbmVWYXVsdE1vdmllQWN0aW9uTW9kYWwodGhpcy5wbHVnaW4uYXBwLCByZXN1bHQsIGFzeW5jICh3YXRjaGVkKSA9PiB7XG4gICAgICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybjtcblxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gdGhpcy5kYXRhLm1vdmllcy5maW5kKChtb3ZpZSkgPT4gbW92aWUuaW1kYklkID09PSByZXN1bHQuaW1kYklkKTtcbiAgICAgICAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nLndhdGNoZWQgPSB3YXRjaGVkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBMb2FkaW5nIGRldGFpbHMgZm9yICR7cmVzdWx0LnRpdGxlfS4uLmApO1xuICAgICAgICAgICAgY29uc3QgZGV0YWlscyA9IGF3YWl0IGdldE9tZGJEZXRhaWxzKHJlc3VsdC5pbWRiSWQsIHRoaXMucGx1Z2luLm9tZGJBcGlLZXkpO1xuXG4gICAgICAgICAgICBpZiAoIWRldGFpbHMpIHtcbiAgICAgICAgICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBsb2FkIG1vdmllIGRldGFpbHMuXCIpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG5ld01vdmllID0gY3JlYXRlRW1wdHlNb3ZpZSgpO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYklkID0gZGV0YWlscy5pbWRiSUQgfHwgcmVzdWx0LmltZGJJZDtcbiAgICAgICAgICAgIG5ld01vdmllLnRpdGxlID0gZGV0YWlscy5UaXRsZSB8fCByZXN1bHQudGl0bGU7XG4gICAgICAgICAgICBuZXdNb3ZpZS55ZWFyID0gZGV0YWlscy5ZZWFyIHx8IHJlc3VsdC55ZWFyO1xuICAgICAgICAgICAgbmV3TW92aWUucmF0ZWQgPSBkZXRhaWxzLlJhdGVkIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5yZWxlYXNlZCA9IGRldGFpbHMuUmVsZWFzZWQgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnJ1bnRpbWUgPSBkZXRhaWxzLlJ1bnRpbWUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmdlbnJlID0gZGV0YWlscy5HZW5yZSB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuZGlyZWN0b3IgPSBkZXRhaWxzLkRpcmVjdG9yIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS53cml0ZXIgPSBkZXRhaWxzLldyaXRlciB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuYWN0b3JzID0gZGV0YWlscy5BY3RvcnMgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnBsb3QgPSBkZXRhaWxzLlBsb3QgfHwgcmVzdWx0LnBsb3Q7XG4gICAgICAgICAgICBuZXdNb3ZpZS5sYW5ndWFnZSA9IGRldGFpbHMuTGFuZ3VhZ2UgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmNvdW50cnkgPSBkZXRhaWxzLkNvdW50cnkgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLmF3YXJkcyA9IGRldGFpbHMuQXdhcmRzIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS5wb3N0ZXIgPSBkZXRhaWxzLlBvc3RlciAmJiBkZXRhaWxzLlBvc3RlciAhPT0gXCJOL0FcIiA/IGRldGFpbHMuUG9zdGVyIDogcmVzdWx0LnBvc3RlcjtcbiAgICAgICAgICAgIG5ld01vdmllLnBvc3RlckxvY2FsID0gXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnJhdGluZ3MgPSBkZXRhaWxzLlJhdGluZ3MgfHwgW107XG4gICAgICAgICAgICBuZXdNb3ZpZS5tZXRhc2NvcmUgPSBkZXRhaWxzLk1ldGFzY29yZSB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYlJhdGluZyA9IGRldGFpbHMuaW1kYlJhdGluZyB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuaW1kYlZvdGVzID0gZGV0YWlscy5pbWRiVm90ZXMgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnR5cGUgPSBkZXRhaWxzLlR5cGUgfHwgcmVzdWx0LnR5cGU7XG4gICAgICAgICAgICBuZXdNb3ZpZS5kdmQgPSBkZXRhaWxzLkRWRCB8fCBcIlwiO1xuICAgICAgICAgICAgbmV3TW92aWUuYm94T2ZmaWNlID0gZGV0YWlscy5Cb3hPZmZpY2UgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnByb2R1Y3Rpb24gPSBkZXRhaWxzLlByb2R1Y3Rpb24gfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLndlYnNpdGUgPSBkZXRhaWxzLldlYnNpdGUgfHwgXCJcIjtcbiAgICAgICAgICAgIG5ld01vdmllLnRvdGFsU2Vhc29ucyA9IGRldGFpbHMudG90YWxTZWFzb25zIHx8IFwiXCI7XG4gICAgICAgICAgICBuZXdNb3ZpZS53YXRjaGVkID0gd2F0Y2hlZDtcblxuICAgICAgICAgICAgdGhpcy5kYXRhLm1vdmllcy5wdXNoKG5ld01vdmllKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSgpO1xuICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0pLm9wZW4oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59IiwgImV4cG9ydCBmdW5jdGlvbiByZW5kZXJPbmJvYXJkaW5nKFxuICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICBvbkNyZWF0ZTogKCkgPT4gdm9pZCxcbiAgb25MaW5rPzogKCkgPT4gdm9pZFxuKSB7XG4gIGNvbnN0IG9uYm9hcmRpbmcgPSBjb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICBjbHM6IFwiY2luZXZhdWx0LW9uYm9hcmRpbmdcIlxuICB9KTtcblxuICBjb25zdCBhY3Rpb25zID0gb25ib2FyZGluZy5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LW9uYm9hcmRpbmctYWN0aW9uc1wiIH0pO1xuICBjb25zdCBjcmVhdGVCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJDcmVhdGUgbmV3IGxpYnJhcnlcIiB9KTtcbiAgY3JlYXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkNyZWF0ZSk7XG5cbiAgaWYgKG9uTGluaykge1xuICAgIGFjdGlvbnMuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJvclwiIH0pO1xuICAgIGNvbnN0IGxpbmtCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJMaW5rIGV4aXN0aW5nIGxpYnJhcnlcIiB9KTtcbiAgICBsaW5rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvbkxpbmspO1xuICB9XG59IiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdFNlYXJjaEl0ZW0gfSBmcm9tIFwiLi4vLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbmV4cG9ydCBjbGFzcyBDaW5lVmF1bHRNb3ZpZUFjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBwcml2YXRlIG1vdmllOiBDaW5lVmF1bHRTZWFyY2hJdGVtO1xuICBwcml2YXRlIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBNb2RhbFtcImFwcFwiXSwgbW92aWU6IENpbmVWYXVsdFNlYXJjaEl0ZW0sIG9uU2F2ZTogKHdhdGNoZWQ6IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMubW92aWUgPSBtb3ZpZTtcbiAgICB0aGlzLm9uU2F2ZSA9IG9uU2F2ZTtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogdGhpcy5tb3ZpZS50aXRsZSB9KTtcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYCR7dGhpcy5tb3ZpZS55ZWFyfSBcdTIwMjIgJHt0aGlzLm1vdmllLnR5cGV9YCB9KTtcbiAgICBpZiAodGhpcy5tb3ZpZS5wb3N0ZXIpIHtcbiAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImltZ1wiLCB7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXBvc3RlclwiIH0pLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLm1vdmllLnBvc3Rlcik7XG4gICAgfVxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiB0aGlzLm1vdmllLnBsb3QgfSk7XG5cbiAgICBjb25zdCBhY3Rpb25zID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWFjdGlvbnNcIiB9KTtcbiAgICBjb25zdCB3YXRjaGVkQnV0dG9uID0gYWN0aW9ucy5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiTWFyayBhcyB3YXRjaGVkXCIgfSk7XG4gICAgY29uc3QgdG9XYXRjaEJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlRvIHdhdGNoXCIgfSk7XG5cbiAgICB3YXRjaGVkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLm9uU2F2ZSh0cnVlKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHRvV2F0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMub25TYXZlKGZhbHNlKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwgImltcG9ydCB7IE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uLy4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuaW1wb3J0IHsgY3JlYXRlU3RhclJhdGluZyB9IGZyb20gXCIuLi9zdGFyUmF0aW5nXCI7XG5pbXBvcnQgeyBudWxsU2FmZSwgcmVuZGVyRXh0ZXJuYWxSYXRpbmdCYXIgfSBmcm9tIFwic3JjL3V0aWxzL2dsb2JhbE1ldGhvZHNcIjtcblxuZXhwb3J0IGNsYXNzIENpbmVWYXVsdE1vdmllRGV0YWlsTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIHByaXZhdGUgbW92aWU6IENpbmVWYXVsdE1vdmllO1xuICBwcml2YXRlIG9uUmF0ZTogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uUmVtb3ZlOiAoKSA9PiB2b2lkO1xuICBwcml2YXRlIG9uVG9nZ2xlV2F0Y2hlZDogKCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBhcHA6IE1vZGFsW1wiYXBwXCJdLFxuICAgIG1vdmllOiBDaW5lVmF1bHRNb3ZpZSxcbiAgICBvblJhdGU6IChyYXRpbmc6IG51bWJlcikgPT4gdm9pZCxcbiAgICBvblJlbW92ZTogKCkgPT4gdm9pZCxcbiAgICBvblRvZ2dsZVdhdGNoZWQ6ICgpID0+IHZvaWRcbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm1vdmllID0gbW92aWU7XG4gICAgdGhpcy5vblJhdGUgPSBvblJhdGU7XG4gICAgdGhpcy5vblJlbW92ZSA9IG9uUmVtb3ZlO1xuICAgIHRoaXMub25Ub2dnbGVXYXRjaGVkID0gb25Ub2dnbGVXYXRjaGVkO1xuICB9XG5cbiAgb25PcGVuKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXG4gICAgY29uc3QgbW9kYWxDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWNvbnRhaW5lclwiXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2RhbEhlYWRlciA9IG1vZGFsQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1oZWFkZXJcIlxuICAgIH0pO1xuXG4gICAgY29uc3QgbW9kYWxUaXRsZUNvbnRhaW5lciA9IG1vZGFsSGVhZGVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC10aXRsZS1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgbW9kYWxUaXRsZUNvbnRhaW5lci5jcmVhdGVFbChcImgxXCIsIHtcbiAgICAgIHRleHQ6IHRoaXMubW92aWUudGl0bGUsXG4gICAgICBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC10aXRsZVwiXG4gICAgfSk7XG5cbiAgICAvLyBZZWFyIGFuZCBUeXBlXG4gICAgY29uc3QgdHlwZSA9IG51bGxTYWZlKCgpID0+IHRoaXMubW92aWUudHlwZVswXS50b1VwcGVyQ2FzZSgpICsgdGhpcy5tb3ZpZS50eXBlLnNsaWNlKDEpLCBudWxsKTtcbiAgICBjb25zdCB5ZWFyID0gbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS55ZWFyLCBudWxsKTtcblxuICAgIG1vZGFsVGl0bGVDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgIHRleHQ6IGAke3llYXJ9IC0gJHt0eXBlfWAsXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkRpcmVjdGVkIGJ5IFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5kaXJlY3RvciwgXCJOL0FcIiksXG4gICAgfSk7XG5cbiAgICBtb2RhbFRpdGxlQ29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICB0ZXh0OiBcIkR1cmF0aW9uIFwiICsgbnVsbFNhZmUoKCkgPT4gdGhpcy5tb3ZpZS5ydW50aW1lLCBcIk4vQVwiKSxcbiAgICB9KTtcblxuICAgIC8vIFBvc3RlclxuICAgIGlmICh0aGlzLm1vdmllLnBvc3Rlcikge1xuICAgICAgbW9kYWxIZWFkZXIuY3JlYXRlRWwoXCJpbWdcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1wb3N0ZXJcIiB9KS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdGhpcy5tb3ZpZS5wb3N0ZXIpO1xuICAgIH1cblxuICAgIC8vIFBsb3RcbiAgICBpZiAodGhpcy5tb3ZpZS5wbG90KSB7XG4gICAgICBjb25zdCBwbG90Q29udGFpbmVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1wbG90LWNvbnRhaW5lclwiIH0pO1xuXG4gICAgICBjb25zdCBwbG90RWwgPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IHRoaXMubW92aWUucGxvdCxcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcGxvdFwiXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc2hvd01vcmVCdXR0b24gPSBwbG90Q29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgdGV4dDogXCJTaG93IG1vcmVcIixcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlIGNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiXG4gICAgICB9KVxuXG4gICAgICBzaG93TW9yZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBpc0V4cGFuZGVkID0gcGxvdEVsLmNsYXNzTGlzdC50b2dnbGUoXCJleHBhbmRlZC1wbG90XCIpO1xuICAgICAgICBzaG93TW9yZUJ1dHRvbi5zZXRUZXh0KGlzRXhwYW5kZWQgPyBcIlNob3cgbGVzc1wiIDogXCJTaG93IG1vcmVcIik7XG4gICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3IgbGF5b3V0IHNvIHdlIGNhbiBtZWFzdXJlIG92ZXJmbG93XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAvLyBJZiBjb250ZW50IGhlaWdodCBleGNlZWRzIGNvbnRhaW5lciBoZWlnaHQsIGl0J3MgdHJ1bmNhdGVkXG4gICAgICAgIGlmIChwbG90RWwuc2Nyb2xsSGVpZ2h0ID4gcGxvdEVsLmNsaWVudEhlaWdodCArIDEpIHtcbiAgICAgICAgICBzaG93TW9yZUJ1dHRvbi5yZW1vdmVDbGFzcyhcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtc2hvdy1tb3JlLWhpZGRlblwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgZGV0YWlscyBzZWN0aW9uIG9ubHkgaWYgYXQgbGVhc3Qgb25lIGRldGFpbCBpcyBhdmFpbGFibGVcbiAgICBmdW5jdGlvbiByZWRlckRldGFpbFNlY3Rpb24odHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICBjb25zdCBkZXRhaWxFbGVtZW50ID0gbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1kZXRhaWwtY29udGFpbmVyXCIgfSk7XG4gICAgICBkZXRhaWxFbGVtZW50LmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgIHRleHQ6IGAke3R5cGV9OmAsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWRldGFpbC1sYWJlbFwiXG4gICAgICB9KTtcbiAgICAgIGRldGFpbEVsZW1lbnQuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogdmFsdWUsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLWRldGFpbC12YWx1ZVwiXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBtb2RhbENvbnRhaW5lci5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgLy8gR2VucmVcbiAgICBpZiAodGhpcy5tb3ZpZS5nZW5yZSkge1xuICAgICAgcmVkZXJEZXRhaWxTZWN0aW9uKFwiR2VucmVcIiwgdGhpcy5tb3ZpZS5nZW5yZSk7XG4gICAgfVxuXG4gICAgLy8gQWN0b3JzXG4gICAgaWYgKHRoaXMubW92aWUuYWN0b3JzKSB7XG4gICAgICByZWRlckRldGFpbFNlY3Rpb24oXCJBY3RvcnNcIiwgdGhpcy5tb3ZpZS5hY3RvcnMpO1xuICAgIH1cblxuICAgIG1vZGFsQ29udGFpbmVyLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICBjb25zdCByYXRpbmdXcmFwcGVyID0gbW9kYWxDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLXdyYXBwZXJcIiB9KTtcblxuICAgIC8vIFBlcnNvbmFsIFJhdGluZ1xuICAgIGNvbnN0IHJhdGluZ0NvbnRhaW5lciA9IHJhdGluZ1dyYXBwZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIlxuICAgIH0pO1xuXG4gICAgcmF0aW5nQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJSYXRpbmdcIiwgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLWxhYmVsXCIgfSk7XG4gICAgY3JlYXRlU3RhclJhdGluZyhyYXRpbmdDb250YWluZXIsIHRoaXMubW92aWUuc3RhclJhdGluZywgZmFsc2UsIChyYXRpbmcpID0+IHtcbiAgICAgIHRoaXMub25SYXRlKHJhdGluZyk7XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5tb3ZpZS5yYXRpbmdzKSB7XG4gICAgICBjb25zdCBleHRlcm5hbFJhdGluZ3NDb250YWluZXIgPSByYXRpbmdXcmFwcGVyLmNyZWF0ZURpdih7IGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1jb250YWluZXJcIiB9KTtcblxuICAgICAgZXh0ZXJuYWxSYXRpbmdzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcbiAgICAgICAgdGV4dDogXCJFeHRlcm5hbCByYXRpbmdcIixcbiAgICAgICAgY2xzOiBcImNpbmV2YXVsdC1tb2RhbC1kZXRhaWwtcmF0aW5nLWxhYmVsXCJcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXJFeHRlcm5hbFJhdGluZ0JhcihleHRlcm5hbFJhdGluZ3NDb250YWluZXIsIHRoaXMubW92aWUucmF0aW5ncyk7XG5cbiAgICAgIC8vIEV4dGVybmFsIHJhdGluZyBkaXNjbGFpbWVyIHN0YXlzIGluIHRoZSBtb2RhbFxuICAgICAgbW9kYWxDb250YWluZXIuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogXCJUaGUgZXh0ZXJuYWwgcmF0aW5nIGlzIGFuIGF2ZXJhZ2UgYmFzZWQgb24gdm90ZXMgZnJvbSBJbnRlcm5ldCBNb3ZpZSBEYXRhYmFzZSwgUm90dGVuIFRvbWF0b2VzIGFuZCBNZXRhY3JpdGljXCIsXG4gICAgICAgIGNsczogXCJjaW5ldmF1bHQtbW9kYWwtZGV0YWlsLXJhdGluZy1kaXNjbGFpbWVyXCJcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGlvbnMgPSBtb2RhbENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY2luZXZhdWx0LW1vZGFsLWRldGFpbC1hY3Rpb25zXCIgfSk7XG4gICAgY29uc3QgdG9nZ2xlV2F0Y2hlZExhYmVsID0gdGhpcy5tb3ZpZS53YXRjaGVkID8gXCJNYXJrIGFzIHRvIHdhdGNoXCIgOiBcIk1hcmsgYXMgd2F0Y2hlZFwiO1xuICAgIGNvbnN0IHRvZ2dsZVdhdGNoZWRCdXR0b24gPSBhY3Rpb25zLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogdG9nZ2xlV2F0Y2hlZExhYmVsIH0pO1xuICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IGFjdGlvbnMuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIlJlbW92ZVwiLCBjbHM6IFwiY2luZXZhdWx0LWRhbmdlclwiIH0pO1xuXG4gICAgdG9nZ2xlV2F0Y2hlZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblRvZ2dsZVdhdGNoZWQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcblxuICAgIHJlbW92ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5vblJlbW92ZSgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59IiwgImV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTdGFyUmF0aW5nKFxuICBjb250YWluZXI6IEhUTUxFbGVtZW50LFxuICByYXRpbmc6IG51bWJlcixcbiAgcmVhZE9ubHk6IGJvb2xlYW4sXG4gIG9uQ2hhbmdlPzogKHJhdGluZzogbnVtYmVyKSA9PiB2b2lkXG4pIHtcbiAgY29uc3Qgc3RhcnMgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNpbmV2YXVsdC1zdGFyc1wiIH0pO1xuICBjb25zdCBzdGFyRWxlbWVudHM6IEhUTUxTcGFuRWxlbWVudFtdID0gW107XG4gIGxldCBjdXJyZW50UmF0aW5nID0gcmF0aW5nO1xuXG4gIGZvciAobGV0IGkgPSAxOyBpIDw9IDU7IGkgKz0gMSkge1xuICAgIGNvbnN0IHN0YXIgPSBzdGFycy5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlx1MjYwNVwiLCBjbHM6IFwiY2luZXZhdWx0LXN0YXJcIiB9KTtcbiAgICBpZiAoaSA8PSByYXRpbmcpIHN0YXIuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICBzdGFyRWxlbWVudHMucHVzaChzdGFyKTtcbiAgICBpZiAoIXJlYWRPbmx5KSB7XG4gICAgICBzdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIElmIGNsaWNraW5nIHRoZSBzYW1lIHN0YXIgdGhhdCdzIGFscmVhZHkgc2VsZWN0ZWQsIHJlc2V0IHRvIDBcbiAgICAgICAgaWYgKGN1cnJlbnRSYXRpbmcgPT09IGkpIHtcbiAgICAgICAgICBjdXJyZW50UmF0aW5nID0gMDtcbiAgICAgICAgICBzdGFyRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN1cnJlbnRSYXRpbmcgPSBpO1xuICAgICAgICAgIHN0YXJFbGVtZW50cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZlXCIsIGluZGV4IDwgaSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgb25DaGFuZ2U/LihjdXJyZW50UmF0aW5nKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFyLmNsYXNzTGlzdC5hZGQoXCJyZWFkb25seVwiKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHN0YXJzO1xufVxuIiwgImltcG9ydCB0eXBlIHsgTW92aWVSYXRpbmcgfSBmcm9tIFwiLi4vdHlwZXMvY2luZXZhdWx0XCI7XG5cbi8qKlxuICogU2FmZWx5IGV4ZWN1dGUgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyBvciByZXR1cm4gbnVsbC91bmRlZmluZWQuXG4gKiBAdGVtcGxhdGUgVFxuICogQHBhcmFtIHsoKSA9PiBUfSBmdW5jIC0gRnVuY3Rpb24gdG8gZXhlY3V0ZSBzYWZlbHkuXG4gKiBAcGFyYW0ge1QgfCBudWxsfSBbZmFsbGJhY2tWYWx1ZT1udWxsXSAtIFZhbHVlIHRvIHJldHVybiBpZiBgZnVuY2AgdGhyb3dzIG9yIHJldHVybnMgbnVsbC91bmRlZmluZWQuXG4gKiBAcmV0dXJucyB7VCB8IG51bGx9IFRoZSByZXN1bHQgb2YgYGZ1bmNgIG9yIHRoZSBwcm92aWRlZCBgZmFsbGJhY2tWYWx1ZWAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBudWxsU2FmZTxUPihmdW5jOiAoKSA9PiBULCBmYWxsYmFja1ZhbHVlOiBUIHwgbnVsbCA9IG51bGwpOiBUIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsdWUgPSBmdW5jKCk7XG4gICAgcmV0dXJuIHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgPyBmYWxsYmFja1ZhbHVlIDogdmFsdWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvcjogJywgZSk7XG4gICAgcmV0dXJuIGZhbGxiYWNrVmFsdWU7XG4gIH1cbn1cblxuLyoqXG4gKiBOb3JtYWxpemUgdmFyaW91cyByYXRpbmcgZm9ybWF0cyBpbnRvIGEgbnVtZXJpYyBzdHJpbmcuXG4gKiBTdXBwb3J0cyBmb3JtYXRzIGxpa2UgXCI3LzEwXCIsIFwiODUvMTAwXCIsIFwiODUlXCIsIGFuZCBkZWNpbWFscyB1c2luZyBjb21tYXMuXG4gKiAtIFwieC8xMFwiIGlzIGNvbnZlcnRlZCB0byBhIHZhbHVlIG91dCBvZiAxMDAgKG11bHRpcGxpZWQgYnkgMTApLlxuICogLSBcIngvMTAwXCIgcmV0dXJucyB0aGUgbnVtZXJpYyBwYXJ0IGJlZm9yZSB0aGUgc2xhc2guXG4gKiAtIFwieCVcIiByZW1vdmVzIHRoZSBwZXJjZW50IHNpZ24uXG4gKiBAcGFyYW0ge3N0cmluZ30gcmF0aW5nIC0gUmF0aW5nIHN0cmluZyBmcm9tIGV4dGVybmFsIHNvdXJjZXMuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBOb3JtYWxpemVkIG51bWVyaWMgc3RyaW5nIChlLmcuIFwiNzVcIiwgXCI3LjVcIikuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXRSYXRpbmcocmF0aW5nOiBzdHJpbmcpOiBzdHJpbmcge1xuICBsZXQgdmFsdWUgPSByYXRpbmc7XG4gIGNvbnN0IGlzUGVyVGVuID0gcmF0aW5nLmluY2x1ZGVzKFwiLzEwXCIpO1xuICBjb25zdCBpc1BlckNlbnQgPSByYXRpbmcuaW5jbHVkZXMoXCIvMTAwXCIpO1xuXG4gIGlmIChpc1BlclRlbiAmJiAhaXNQZXJDZW50KSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHZhbHVlLnJlcGxhY2UoJywnLCAnLicpO1xuICAgIGNvbnN0IG51bSA9IHBhcnNlRmxvYXQobm9ybWFsaXplZCk7XG4gICAgaWYgKCFpc05hTihudW0pICYmIGlzRmluaXRlKG51bSkpIHtcbiAgICAgIGNvbnN0IG11bHRpcGxpZWQgPSBudW0gKiAxMDtcbiAgICAgIHZhbHVlID0gbXVsdGlwbGllZCAlIDEgPT09IDAgPyBTdHJpbmcoTWF0aC50cnVuYyhtdWx0aXBsaWVkKSkgOiBTdHJpbmcobXVsdGlwbGllZCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKHJhdGluZy5pbmNsdWRlcyhcIi9cIikgJiYgaXNQZXJDZW50KSB7XG4gICAgdmFsdWUgPSByYXRpbmcuc3BsaXQoXCIvXCIpWzBdLnRyaW0oKTtcbiAgfSBlbHNlIGlmIChyYXRpbmcuaW5jbHVkZXMoXCIlXCIpKSB7XG4gICAgdmFsdWUgPSByYXRpbmcucmVwbGFjZShcIiVcIiwgXCJcIikudHJpbSgpO1xuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG4vKipcbiAqIENvbXB1dGUgdGhlIGF2ZXJhZ2Ugb2YgYW4gYXJyYXkgb2YgcmF0aW5nIHN0cmluZ3MuXG4gKiBVc2VzIGBmb3JtYXRSYXRpbmdgIHRvIG5vcm1hbGl6ZSB2YWx1ZXMsIGlnbm9yZXMgbm9uLW51bWVyaWMgZW50cmllcy5cbiAqIEBwYXJhbSB7c3RyaW5nW119IHJhdGluZ3MgLSBBcnJheSBvZiByYXRpbmcgc3RyaW5ncyB0byBhdmVyYWdlLlxuICogQHJldHVybnMge3N0cmluZ30gQXZlcmFnZSBhcyBhbiBpbnRlZ2VyIHN0cmluZyBvciBvbmUtZGVjaW1hbCBzdHJpbmc7IHJldHVybnMgXCJOL0FcIiBpZiBubyB2YWxpZCByYXRpbmdzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXZlcmFnZVJhdGluZyhyYXRpbmdzOiBzdHJpbmdbXSk6IHN0cmluZyB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRSYXRpbmdzID0gcmF0aW5ncy5tYXAoZm9ybWF0UmF0aW5nKS5tYXAociA9PiBwYXJzZUZsb2F0KHIpKS5maWx0ZXIociA9PiAhaXNOYU4ocikgJiYgaXNGaW5pdGUocikpO1xuICBpZiAobm9ybWFsaXplZFJhdGluZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gXCJOL0FcIjtcbiAgY29uc3Qgc3VtID0gbm9ybWFsaXplZFJhdGluZ3MucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjICsgdmFsLCAwKTtcbiAgY29uc3QgYXZlcmFnZSA9IHN1bSAvIG5vcm1hbGl6ZWRSYXRpbmdzLmxlbmd0aDtcbiAgcmV0dXJuIGF2ZXJhZ2UgJSAxID09PSAwID8gU3RyaW5nKE1hdGgudHJ1bmMoYXZlcmFnZSkpIDogU3RyaW5nKGF2ZXJhZ2UudG9GaXhlZCgxKSk7XG59XG5cbi8qKlxuICogUmVuZGVyIGEgc2ltcGxlIHJhdGluZyBiYXIgVUkgaW50byBhIHBhcmVudCBlbGVtZW50IHVzaW5nIGV4dGVybmFsIHJhdGluZ3MuXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBwYXJlbnQgLSBQYXJlbnQgZWxlbWVudCB0byB3aGljaCB0aGUgcmF0aW5nIGJhciB3aWxsIGJlIGFwcGVuZGVkLlxuICogQHBhcmFtIHtNb3ZpZVJhdGluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbH0gcmF0aW5ncyAtIEFycmF5IG9mIHJhdGluZyBvYmplY3RzIHdpdGggYSBgVmFsdWVgIHByb3BlcnR5LlxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIE9wdGlvbmFsIGNsYXNzZXMgdG8gY3VzdG9taXplIGVsZW1lbnRzLlxuICogQHBhcmFtIHt7YmFyQ29udGFpbmVyPzogc3RyaW5nLCBiYXI/OiBzdHJpbmcsIGZpbGw/OiBzdHJpbmcsIGF2ZXJhZ2U/OiBzdHJpbmd9fSBbb3B0aW9ucy5jbGFzc2VzXVxuICogQHJldHVybnMge3tjb250YWluZXI6IEhUTUxFbGVtZW50LCBhdmVyYWdlOiBzdHJpbmcsIHBlcmNlbnRhZ2U6IG51bWJlcn0gfCBudWxsfSBBbiBvYmplY3Qgd2l0aCB0aGUgY29udGFpbmVyIGVsZW1lbnQsIGF2ZXJhZ2Ugc3RyaW5nIGFuZCBwZXJjZW50YWdlIG51bWJlciwgb3IgYG51bGxgIHdoZW4gbm8gcmF0aW5ncyBhcmUgcHJvdmlkZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJFeHRlcm5hbFJhdGluZ0JhcihwYXJlbnQ6IEhUTUxFbGVtZW50LCByYXRpbmdzOiBNb3ZpZVJhdGluZ1tdIHwgdW5kZWZpbmVkIHwgbnVsbCwgb3B0aW9ucz86IHtcbiAgY2xhc3Nlcz86IHtcbiAgICBiYXJDb250YWluZXI/OiBzdHJpbmc7XG4gICAgYmFyPzogc3RyaW5nO1xuICAgIGZpbGw/OiBzdHJpbmc7XG4gICAgYXZlcmFnZT86IHN0cmluZztcbiAgfTtcbn0pIHtcbiAgaWYgKCFyYXRpbmdzIHx8IHJhdGluZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDtcblxuICBjb25zdCByYXRpbmdCYXJDb250YWluZXIgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcInBsdWdpbi1yYXRpbmdzLWJhci1jb250YWluZXJcIiB9KTtcbiAgY29uc3QgcmF0aW5nQmFyID0gcmF0aW5nQmFyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJwbHVnaW4tcmF0aW5ncy1iYXJcIiB9KTtcbiAgY29uc3QgcmF0aW5nRmlsbCA9IHJhdGluZ0Jhci5jcmVhdGVEaXYoeyBjbHM6IFwicGx1Z2luLXJhdGluZ3MtZmlsbFwiIH0pO1xuXG4gIGNvbnN0IHZhbHVlcyA9IHJhdGluZ3MubWFwKChyKSA9PiBmb3JtYXRSYXRpbmcoci5WYWx1ZSkpO1xuICBjb25zdCBhdmVyYWdlID0gYXZlcmFnZVJhdGluZyh2YWx1ZXMpO1xuICBjb25zdCBwZXJjZW50YWdlID0gcGFyc2VGbG9hdChhdmVyYWdlKTtcblxuICByYXRpbmdGaWxsLnN0eWxlLndpZHRoID0gYCR7aXNOYU4ocGVyY2VudGFnZSkgPyAwIDogcGVyY2VudGFnZX0lYDtcblxuICByYXRpbmdCYXJDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICB0ZXh0OiBgJHthdmVyYWdlfSVgLFxuICAgIGNsczogXCJwbHVnaW4tcmF0aW5ncy1hdmVyYWdlXCJcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXI6IHJhdGluZ0JhckNvbnRhaW5lcixcbiAgICBhdmVyYWdlLFxuICAgIHBlcmNlbnRhZ2U6IGlzTmFOKHBlcmNlbnRhZ2UpID8gMCA6IHBlcmNlbnRhZ2VcbiAgfTtcbn1cbiIsICJpbXBvcnQgeyBBcHAsIFN1Z2dlc3RNb2RhbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGNsYXNzIEpzb25GaWxlU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFRGaWxlPiB7XG4gIHByaXZhdGUganNvbkZpbGVzOiBURmlsZVtdO1xuICBwcml2YXRlIG9uU2VsZWN0OiAoZmlsZTogVEZpbGUpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoZmlsZTogVEZpbGUpID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMub25TZWxlY3QgPSBvblNlbGVjdDtcbiAgICB0aGlzLmpzb25GaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmKSA9PiBmLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJTZWxlY3QgYSBKU09OIGZpbGUgZnJvbSB5b3VyIHZhdWx0Li4uXCIpO1xuICB9XG5cbiAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IFRGaWxlW10ge1xuICAgIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiB0aGlzLmpzb25GaWxlcy5maWx0ZXIoKGZpbGUpID0+XG4gICAgICBmaWxlLnBhdGgudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsb3dlclF1ZXJ5KVxuICAgICk7XG4gIH1cblxuICByZW5kZXJTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGZpbGUucGF0aCB9KTtcbiAgfVxuXG4gIG9uQ2hvb3NlU3VnZ2VzdGlvbihmaWxlOiBURmlsZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgIHRoaXMub25TZWxlY3QoZmlsZSk7XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IENpbmVWYXVsdERhdGEsIENpbmVWYXVsdE1vdmllIH0gZnJvbSBcIi4uL3R5cGVzL2NpbmV2YXVsdFwiO1xuXG5jb25zdCBGT0xERVIgPSBcIkJveE9mZmljZVwiO1xuY29uc3QgREVGQVVMVF9OQU1FID0gXCJsaWJyYXJ5U3RvcmFnZS5qc29uXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0UGF0aChmb2xkZXI/OiBzdHJpbmcpIHtcbiAgY29uc3QgZm9sZGVyUGF0aCA9IGZvbGRlciA/PyBGT0xERVI7XG4gIHJldHVybiBgJHtmb2xkZXJQYXRofS8ke0RFRkFVTFRfTkFNRX1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rm9sZGVyKGZvbGRlcj86IHN0cmluZykge1xuICByZXR1cm4gZm9sZGVyID8/IEZPTERFUjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVtcHR5TW92aWUoKTogQ2luZVZhdWx0TW92aWUge1xuICByZXR1cm4ge1xuICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLFxuICAgIGltZGJJZDogXCJcIixcbiAgICB0aXRsZTogXCJcIixcbiAgICB5ZWFyOiBcIlwiLFxuICAgIHJhdGVkOiBcIlwiLFxuICAgIHJlbGVhc2VkOiBcIlwiLFxuICAgIHJ1bnRpbWU6IFwiXCIsXG4gICAgZ2VucmU6IFwiXCIsXG4gICAgZGlyZWN0b3I6IFwiXCIsXG4gICAgd3JpdGVyOiBcIlwiLFxuICAgIGFjdG9yczogXCJcIixcbiAgICBwbG90OiBcIlwiLFxuICAgIGxhbmd1YWdlOiBcIlwiLFxuICAgIGNvdW50cnk6IFwiXCIsXG4gICAgYXdhcmRzOiBcIlwiLFxuICAgIHBvc3RlcjogXCJcIixcbiAgICBwb3N0ZXJMb2NhbDogXCJcIixcbiAgICByYXRpbmdzOiBbXSxcbiAgICBtZXRhc2NvcmU6IFwiXCIsXG4gICAgaW1kYlJhdGluZzogXCJcIixcbiAgICBpbWRiVm90ZXM6IFwiXCIsXG4gICAgdHlwZTogXCJcIixcbiAgICBkdmQ6IFwiXCIsXG4gICAgYm94T2ZmaWNlOiBcIlwiLFxuICAgIHByb2R1Y3Rpb246IFwiXCIsXG4gICAgd2Vic2l0ZTogXCJcIixcbiAgICB0b3RhbFNlYXNvbnM6IFwiXCIsXG4gICAgdG9tYXRvVVJMOiBcIlwiLFxuICAgIHRvbWF0b01ldGVyOiBcIlwiLFxuICAgIHRvbWF0b0ltYWdlOiBcIlwiLFxuICAgIHRvbWF0b1JhdGluZzogXCJcIixcbiAgICB0b21hdG9SZXZpZXdzOiBcIlwiLFxuICAgIHRvbWF0b0ZyZXNoOiBcIlwiLFxuICAgIHRvbWF0b1JvdHRlbjogXCJcIixcbiAgICB0b21hdG9Db25zZW5zdXM6IFwiXCIsXG4gICAgdG9tYXRvVXNlck1ldGVyOiBcIlwiLFxuICAgIHRvbWF0b1VzZXJSYXRpbmc6IFwiXCIsXG4gICAgdG9tYXRvVXNlclJldmlld3M6IFwiXCIsXG4gICAgc3RhclJhdGluZzogMCxcbiAgICB3YXRjaGVkOiBmYWxzZSxcbiAgICBub3RlczogXCJcIlxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdERhdGEoKTogQ2luZVZhdWx0RGF0YSB7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgcmV0dXJuIHtcbiAgICBzY2hlbWFWZXJzaW9uOiAxLFxuICAgIGNyZWF0ZWRBdDogbm93LFxuICAgIHVwZGF0ZWRBdDogbm93LFxuICAgIGxpYnJhcnlOYW1lOiBcIkNpbmVWYXVsdFwiLFxuICAgIG93bmVyOiBcIlwiLFxuICAgIHNvdXJjZTogXCJDaW5lVmF1bHRcIixcbiAgICBtb3ZpZXM6IFtdXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVEYXRhKGRhdGE6IENpbmVWYXVsdERhdGEpOiBDaW5lVmF1bHREYXRhIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kYXRhLFxuICAgIG1vdmllczogZGF0YS5tb3ZpZXMubWFwKChtb3ZpZSkgPT4gKHtcbiAgICAgIC4uLmNyZWF0ZUVtcHR5TW92aWUoKSxcbiAgICAgIC4uLm1vdmllLFxuICAgICAgeWVhcjogbW92aWUueWVhciA/IFN0cmluZyhtb3ZpZS55ZWFyKSA6IFwiXCIsXG4gICAgICBzdGFyUmF0aW5nOiB0eXBlb2YgbW92aWUuc3RhclJhdGluZyA9PT0gXCJudW1iZXJcIiA/IG1vdmllLnN0YXJSYXRpbmcgOiAwXG4gICAgfSkpXG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbnN1cmVGb2xkZXIoYXBwOiBBcHAsIGZvbGRlcj86IHN0cmluZykge1xuICBjb25zdCBmb2xkZXJQYXRoID0gZ2V0Rm9sZGVyKGZvbGRlcik7XG4gIGlmICghYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKSkge1xuICAgIGF3YWl0IGFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUpzb25GaWxlKGFwcDogQXBwLCBmb2xkZXI/OiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlPiB7XG4gIGNvbnN0IGZvbGRlclBhdGggPSBnZXRGb2xkZXIoZm9sZGVyKTtcbiAgYXdhaXQgZW5zdXJlRm9sZGVyKGFwcCwgZm9sZGVyKTtcbiAgY29uc3QgZXhpc3RpbmcgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGdldERlZmF1bHRQYXRoKGZvbGRlcikpO1xuICBjb25zdCBmaWxlbmFtZSA9IGV4aXN0aW5nID8gYGJveG9mZmljZS0ke0RhdGUubm93KCl9Lmpzb25gIDogREVGQVVMVF9OQU1FO1xuICBjb25zdCBwYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtmaWxlbmFtZX1gO1xuXG4gIHJldHVybiBhcHAudmF1bHQuY3JlYXRlKHBhdGgsIEpTT04uc3RyaW5naWZ5KGNyZWF0ZURlZmF1bHREYXRhKCksIG51bGwsIDIpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRMb2NhbEZpbGUoYXBwOiBBcHAsIGZpbGU6IFRGaWxlKTogUHJvbWlzZTxDaW5lVmF1bHREYXRhPiB7XG4gIGNvbnN0IHJhdyA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJhdykgYXMgQ2luZVZhdWx0RGF0YTtcbiAgaWYgKCFwYXJzZWQgfHwgIUFycmF5LmlzQXJyYXkocGFyc2VkLm1vdmllcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGb3JtYXRvIEpTT04gbm9uIHZhbGlkb1wiKTtcbiAgfVxuICByZXR1cm4gbm9ybWFsaXplRGF0YShwYXJzZWQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUxvY2FsRGF0YShhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGRhdGE6IENpbmVWYXVsdERhdGEpIHtcbiAgYXdhaXQgYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSk7XG59XG4iLCAiaW1wb3J0IHsgcmVxdWVzdFVybCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHR5cGUgeyBDaW5lVmF1bHRTZWFyY2hJdGVtLCBPbWRiRGV0YWlsZWRSZXNwb25zZSB9IGZyb20gXCIuLi90eXBlcy9jaW5ldmF1bHRcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlYXJjaE9tZGIocXVlcnk6IHN0cmluZywgYXBpS2V5OiBzdHJpbmcsIHR5cGU/OiBzdHJpbmcsIHllYXI/OiBzdHJpbmcpOiBQcm9taXNlPENpbmVWYXVsdFNlYXJjaEl0ZW1bXT4ge1xuICBpZiAoIWFwaUtleSkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgbGV0IHVybCA9IGBodHRwczovL3d3dy5vbWRiYXBpLmNvbS8/YXBpa2V5PSR7YXBpS2V5fSZzPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5KX1gO1xuICAgIGlmICh0eXBlKSB7XG4gICAgICB1cmwgKz0gYCZ0eXBlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KHR5cGUpfWA7XG4gICAgfVxuICAgIGlmICh5ZWFyKSB7XG4gICAgICB1cmwgKz0gYCZ5PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHllYXIpfWA7XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh1cmwpO1xuICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5qc29uIGFzIHtcbiAgICAgIFNlYXJjaD86IEFycmF5PHsgVGl0bGU6IHN0cmluZzsgWWVhcjogc3RyaW5nOyBpbWRiSUQ6IHN0cmluZzsgVHlwZTogc3RyaW5nOyBQb3N0ZXI6IHN0cmluZyB9PjtcbiAgICB9O1xuXG4gICAgaWYgKGRhdGE/LlNlYXJjaCkge1xuICAgICAgcmV0dXJuIGRhdGEuU2VhcmNoLm1hcCgoaXRlbSkgPT4gKHtcbiAgICAgICAgaW1kYklkOiBpdGVtLmltZGJJRCxcbiAgICAgICAgdGl0bGU6IGl0ZW0uVGl0bGUsXG4gICAgICAgIHllYXI6IGl0ZW0uWWVhcixcbiAgICAgICAgdHlwZTogaXRlbS5UeXBlLFxuICAgICAgICBwb3N0ZXI6IGl0ZW0uUG9zdGVyICYmIGl0ZW0uUG9zdGVyICE9PSBcIk4vQVwiID8gaXRlbS5Qb3N0ZXIgOiBcIlwiLFxuICAgICAgICBwbG90OiBcIlwiXG4gICAgICB9KSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFtdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzZWFyY2hpbmcgT01EYjpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0T21kYkRldGFpbHMoaW1kYklkOiBzdHJpbmcsIGFwaUtleTogc3RyaW5nLCBkZXB0aDogbnVtYmVyID0gMCk6IFByb21pc2U8T21kYkRldGFpbGVkUmVzcG9uc2UgfCBudWxsPiB7XG4gIC8vIFJldHJ5IGxpbWl0XG4gIGlmIChkZXB0aCA+PSAzKSB7XG4gICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGZldGNoIG1vdmllIGRldGFpbHMgYWZ0ZXIgJHtkZXB0aH0gYXR0ZW1wdHNgKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGlmICghYXBpS2V5KSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IGBodHRwczovL3d3dy5vbWRiYXBpLmNvbS8/YXBpa2V5PSR7YXBpS2V5fSZpPSR7aW1kYklkfSZwbG90PWZ1bGwmdG9tYXRvZXM9dHJ1ZWA7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHVybCk7XG5cbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbiBhcyBPbWRiRGV0YWlsZWRSZXNwb25zZSAmIHsgUmVzcG9uc2U6IHN0cmluZyB9O1xuXG4gICAgaWYgKGRhdGEuUmVzcG9uc2UgIT09IFwiVHJ1ZVwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiT01EYiBBUEkgcmV0dXJuZWQgZXJyb3IgcmVzcG9uc2VcIiwgZGF0YSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgbW92aWUgZGV0YWlscywgcmV0cnlpbmcuLi5cIiwgZXJyb3IpO1xuICAgIHJldHVybiBnZXRPbWRiRGV0YWlscyhpbWRiSWQsIGFwaUtleSwgZGVwdGggKyAxKTtcbiAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHBsdWdpblZpZXcgZnJvbSBcIi4uL3ZpZXdzL3BsdWdpblZpZXdcIjtcbmltcG9ydCB7IFZJRVdfVFlQRSB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcbmltcG9ydCBDaW5lVmF1bHRQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcbmltcG9ydCB7IGNyZWF0ZURlZmF1bHREYXRhLCBjcmVhdGVKc29uRmlsZSwgZ2V0RGVmYXVsdFBhdGgsIGdldEZvbGRlciwgc2F2ZUxvY2FsRGF0YSB9IGZyb20gXCIuLi9zZXJ2aWNlcy9saWJyYXJ5U3RvcmFnZVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaW5lVmF1bHRTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gIHBsdWdpbjogQ2luZVZhdWx0UGx1Z2luO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IENpbmVWYXVsdFBsdWdpbikge1xuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAvLyBDb25maWd1cmF0aW9uXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJDb25maWd1cmF0aW9uXCIpLnNldEhlYWRpbmcoKTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiT01EYiBBUEkga2V5XCIpXG4gICAgICAuc2V0RGVzYyhcIkVudGVyIHlvdXIgT01EYiBBUEkga2V5LiBZb3UgY2FuIGdldCBvbmUgZm9yIGZyZWUgYXQgb21kYmFwaS5jb21cIilcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciB5b3VyIEFQSSBrZXlcIilcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLm9tZGJBcGlLZXkpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRPbWRiQXBpS2V5KHZhbHVlKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkxpYnJhcnkgZm9sZGVyXCIpXG4gICAgICAuc2V0RGVzYyhcIlRoZSBmb2xkZXIgd2hlcmUgdGhlIHBsdWdpbiB3aWxsIHN0b3JlIGxpYnJhcnkgZmlsZXNcIilcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJGb2xkZXIgbmFtZVwiKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcilcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGZvbGRlciA9IHZhbHVlLnRyaW0oKSB8fCBcIkJveE9mZmljZVwiO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldExpYnJhcnlGb2xkZXIoZm9sZGVyKTtcbiAgICAgICAgfSkpO1xuXG4gICAgLy8gRXh0ZXJuYWwgbGlicmFyeSBzdXBwb3J0IHJlbW92ZWQuXG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiTGlua2VkIGxvY2FsIGxpYnJhcnlcIilcbiAgICAgIC5zZXREZXNjKFxuICAgICAgICB0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoXG4gICAgICAgICAgPyBgTG9jYWwgZmlsZTogJHt0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRofWBcbiAgICAgICAgICA6IFwiTm8gbG9jYWwgbGlicmFyeSBsaW5rZWRcIlxuICAgICAgKVxuICAgICAgLmFkZERyb3Bkb3duKGRyb3AgPT4ge1xuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmKSA9PiBmLmV4dGVuc2lvbiA9PT0gXCJqc29uXCIpO1xuICAgICAgICBjb25zdCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0geyBcIlwiOiBcIi0tIE5vbmUgLS1cIiB9O1xuICAgICAgICBmaWxlcy5mb3JFYWNoKChmKSA9PiAob3B0aW9uc1tmLnBhdGhdID0gZi5wYXRoKSk7XG4gICAgICAgIGRyb3AuYWRkT3B0aW9ucyhvcHRpb25zKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5sb2NhbEpzb25QYXRoID8/IFwiXCIpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHBhdGggPSB2YWx1ZSB8fCBudWxsO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNldExvY2FsSnNvblBhdGgocGF0aCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoT3BlblZpZXdzKCk7XG4gICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dChcIlVubGluayBsb2NhbFwiKVxuICAgICAgICAuc2V0RGlzYWJsZWQoIXRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGgpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKG51bGwpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaE9wZW5WaWV3cygpO1xuICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiQ3JlYXRlIG5ldyBsaWJyYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcIkNyZWF0ZSBhIG5ldyBlbXB0eSBsb2NhbCBsaWJyYXJ5IGZyb20gc2NyYXRjaC4gVGhpcyB3aWxsIHVubGluayBhbnkgZXh0ZXJuYWwgbGlicmFyeS5cIilcbiAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkNyZWF0ZSBsaWJyYXJ5XCIpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmNyZWF0ZU5ld0xpYnJhcnkoKTtcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZShcIkV4cG9ydCBsaWJyYXJ5XCIpXG4gICAgICAuc2V0RGVzYyhcIlNhdmUgYSBjb3B5IG9mIHlvdXIgbGlicmFyeSBKU09OIHRvIGEgZmlsZS5cIilcbiAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkV4cG9ydCBKU09OXCIpXG4gICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmV4cG9ydExpYnJhcnlKc29uKCk7XG4gICAgICAgIH0pKTtcblxuICAgIC8vIEJ1Z2ZpeFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQnVnZml4XCIpLnNldEhlYWRpbmcoKTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiUmVwb3J0IGlzc3Vlc1wiKVxuICAgICAgLnNldERlc2MoXCJJZiB5b3UgZW5jb3VudGVyIGFueSBpc3N1ZXMgd2l0aCB0aGUgcGx1Z2luLCBwbGVhc2UgcmVwb3J0IHRoZW0uIFlvdXIgZmVlZGJhY2sgaXMgaW52YWx1YWJsZSBmb3IgaW1wcm92aW5nIEJveE9mZmljZSFcIilcbiAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkdpdEh1YlwiKVxuICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgd2luZG93Lm9wZW4oXCJodHRwczovL2dpdGh1Yi5jb20vdnNjYXBlcnJvdHRhL29ic2lkaWFuLWNpbmV2YXVsdC9pc3N1ZXNcIiwgXCJfYmxhbmtcIik7XG4gICAgICAgIH0pKTtcblxuICAgIC8vIFN1cHBvcnQgYW5kIGRvbmF0aW9uXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJTdXBwb3J0XCIpLnNldEhlYWRpbmcoKTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKFwiRG9uYXRlXCIpXG4gICAgICAuc2V0RGVzYyhcbiAgICAgICAgXCJJZiB5b3UgbGlrZSB0aGlzIHBsdWdpbiwgY29uc2lkZXIgZG9uYXRpbmcgdG8gc3VwcG9ydCBjb250aW51ZWQgZGV2ZWxvcG1lbnQuXCJcbiAgICAgIClcbiAgICAgIC5hZGRCdXR0b24oKGJ0KSA9PiB7XG4gICAgICAgIGJ0LmJ1dHRvbkVsLm91dGVySFRNTCA9XG4gICAgICAgICAgXCI8YSBocmVmPSdodHRwczovL2tvLWZpLmNvbS9UNlQwMVRYODA3JyB0YXJnZXQ9J19ibGFuayc+PGltZyBoZWlnaHQ9JzM2JyBzdHlsZT0nYm9yZGVyOjBweDtoZWlnaHQ6MzZweDsnIHNyYz0naHR0cHM6Ly9zdG9yYWdlLmtvLWZpLmNvbS9jZG4va29maTYucG5nP3Y9NicgYm9yZGVyPScwJyBhbHQ9J0J1eSBNZSBhIENvZmZlZSBhdCBrby1maS5jb20nIC8+PC9hPlwiO1xuICAgICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4cG9ydExpYnJhcnlKc29uKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5nZXRMaWJyYXJ5SnNvbkNvbnRlbnQoKTtcbiAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICBuZXcgTm90aWNlKFwiTm8gbGlicmFyeSBmaWxlIGZvdW5kIHRvIGV4cG9ydC5cIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIGV4cG9ydCBmaWxlIGluc2lkZSB2YXVsdCBmb3IgbW9iaWxlIGNvbXBhdGliaWxpdHlcbiAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5yZXBsYWNlKC9bOi5dL2csIFwiLVwiKS5zbGljZSgwLCAxOSk7XG4gICAgICBjb25zdCBleHBvcnRQYXRoID0gYGJveG9mZmljZS1leHBvcnQtJHt0aW1lc3RhbXB9Lmpzb25gO1xuXG4gICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cywgaWYgc28gYWRkIGEgY291bnRlclxuICAgICAgbGV0IGZpbmFsUGF0aCA9IGV4cG9ydFBhdGg7XG4gICAgICBsZXQgY291bnRlciA9IDE7XG4gICAgICB3aGlsZSAodGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbmFsUGF0aCkpIHtcbiAgICAgICAgZmluYWxQYXRoID0gYGJveG9mZmljZS1leHBvcnQtJHt0aW1lc3RhbXB9LSR7Y291bnRlcn0uanNvbmA7XG4gICAgICAgIGNvdW50ZXIrKztcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbmFsUGF0aCwgY29udGVudCk7XG4gICAgICBuZXcgTm90aWNlKGBMaWJyYXJ5IGV4cG9ydGVkIHRvICR7ZmluYWxQYXRofWApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiW0JveE9mZmljZV0gRXhwb3J0IGxpYnJhcnkgZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgbmV3IE5vdGljZShcIlVuYWJsZSB0byBleHBvcnQgdGhlIGxpYnJhcnkuXCIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY3JlYXRlTmV3TGlicmFyeSgpIHtcbiAgICBjb25zdCBjb25maXJtZWQgPSB3aW5kb3cuY29uZmlybShcbiAgICAgIFwiQ3JlYXRlIGEgbmV3IGVtcHR5IEJveE9mZmljZSBsaWJyYXJ5PyBUaGlzIHdpbGwgdW5saW5rIGFueSBleHRlcm5hbCBsaWJyYXJ5IGFuZCByZXNldCB5b3VyIGxvY2FsIGxpYnJhcnkgZGF0YS5cIlxuICAgICk7XG4gICAgaWYgKCFjb25maXJtZWQpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBkZWZhdWx0RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChnZXREZWZhdWx0UGF0aCh0aGlzLnBsdWdpbi5saWJyYXJ5Rm9sZGVyKSk7XG4gICAgICBsZXQgY3JlYXRlZEZpbGU6IFRGaWxlIHwgdW5kZWZpbmVkO1xuICAgICAgaWYgKGRlZmF1bHRGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgYXdhaXQgc2F2ZUxvY2FsRGF0YSh0aGlzLmFwcCwgZGVmYXVsdEZpbGUsIGNyZWF0ZURlZmF1bHREYXRhKCkpO1xuICAgICAgICBjcmVhdGVkRmlsZSA9IGRlZmF1bHRGaWxlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3JlYXRlZEZpbGUgPSBhd2FpdCBjcmVhdGVKc29uRmlsZSh0aGlzLmFwcCwgdGhpcy5wbHVnaW4ubGlicmFyeUZvbGRlcik7XG4gICAgICB9XG5cbiAgICAgIGlmIChjcmVhdGVkRmlsZSkge1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zZXRMb2NhbEpzb25QYXRoKGNyZWF0ZWRGaWxlLnBhdGgpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoT3BlblZpZXdzKCk7XG4gICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJOZXcgbGlicmFyeSBjcmVhdGVkLlwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIltCb3hPZmZpY2VdIENyZWF0ZSBuZXcgbGlicmFyeSBlcnJvclwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiVW5hYmxlIHRvIGNyZWF0ZSBhIG5ldyBsaWJyYXJ5LlwiKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldExpYnJhcnlKc29uQ29udGVudCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAvLyBQcmVmZXIgYSBsb2NhbCBsaW5rZWQgZmlsZSBpbnNpZGUgdGhlIHZhdWx0XG4gICAgaWYgKHRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGgpIHtcbiAgICAgIGNvbnN0IGxvY2FsUGF0aCA9IHRoaXMucGx1Z2luLmxvY2FsSnNvblBhdGg7XG4gICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGxvY2FsUGF0aCk7XG4gICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGRlZmF1bHRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGdldERlZmF1bHRQYXRoKHRoaXMucGx1Z2luLmxpYnJhcnlGb2xkZXIpKTtcbiAgICBpZiAoZGVmYXVsdEZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgcmV0dXJuIHRoaXMuYXBwLnZhdWx0LnJlYWQoZGVmYXVsdEZpbGUpO1xuICAgIH1cblxuICAgIGNvbnN0IGZvbGRlciA9IGdldEZvbGRlcih0aGlzLnBsdWdpbi5saWJyYXJ5Rm9sZGVyKTtcbiAgICBjb25zdCBmYWxsYmFjayA9IHRoaXMuYXBwLnZhdWx0XG4gICAgICAuZ2V0RmlsZXMoKVxuICAgICAgLmZpbmQoKGZpbGUpID0+IGZpbGUuZXh0ZW5zaW9uID09PSBcImpzb25cIiAmJiBmaWxlLnBhdGguc3RhcnRzV2l0aChgJHtmb2xkZXJ9L2ApKTtcblxuICAgIGlmIChmYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHRoaXMuYXBwLnZhdWx0LnJlYWQoZmFsbGJhY2spO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZWZyZXNoT3BlblZpZXdzKCkge1xuICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFKTtcbiAgICBmb3IgKGNvbnN0IGxlYWYgb2YgbGVhdmVzKSB7XG4gICAgICBpZiAobGVhZi52aWV3IGluc3RhbmNlb2YgcGx1Z2luVmlldykge1xuICAgICAgICBhd2FpdCBsZWFmLnZpZXcub25PcGVuKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXVCOzs7QUNBaEIsSUFBTSxZQUFZO0FBRWxCLElBQU0sYUFBYSxDQUFDLFNBQVMsVUFBVSxTQUFTOzs7QUNGdkQsSUFBQUMsbUJBQWdFOzs7QUNBekQsU0FBUyxpQkFDZCxXQUNBLFVBQ0EsUUFDQTtBQUNBLFFBQU0sYUFBYSxVQUFVLFVBQVU7QUFBQSxJQUNyQyxLQUFLO0FBQUEsRUFDUCxDQUFDO0FBRUQsUUFBTSxVQUFVLFdBQVcsVUFBVSxFQUFFLEtBQUssK0JBQStCLENBQUM7QUFDNUUsUUFBTSxlQUFlLFFBQVEsU0FBUyxVQUFVLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM5RSxlQUFhLGlCQUFpQixTQUFTLFFBQVE7QUFFL0MsTUFBSSxRQUFRO0FBQ1YsWUFBUSxTQUFTLEtBQUssRUFBRSxNQUFNLEtBQUssQ0FBQztBQUNwQyxVQUFNLGFBQWEsUUFBUSxTQUFTLFVBQVUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQy9FLGVBQVcsaUJBQWlCLFNBQVMsTUFBTTtBQUFBLEVBQzdDO0FBQ0Y7OztBQ2xCQSxzQkFBc0I7QUFHZixJQUFNLDRCQUFOLGNBQXdDLHNCQUFNO0FBQUEsRUFJbkQsWUFBWSxLQUFtQixPQUE0QixRQUFvQztBQUM3RixVQUFNLEdBQUc7QUFDVCxTQUFLLFFBQVE7QUFDYixTQUFLLFNBQVM7QUFBQSxF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
